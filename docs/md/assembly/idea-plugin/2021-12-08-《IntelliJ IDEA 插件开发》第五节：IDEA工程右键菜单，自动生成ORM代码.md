---
title: ç¬¬ 5 ç« ï¼šIDEAå·¥ç¨‹å³é”®èœå•ï¼Œè‡ªåŠ¨ç”ŸæˆORMä»£ç 
lock: need
---

# ã€ŠIntelliJ IDEA æ’ä»¶å¼€å‘ã€‹ç¬¬ 5 ç« ï¼šIDEAå·¥ç¨‹å³é”®èœå•ï¼Œè‡ªåŠ¨ç”ŸæˆORMä»£ç 

ä½œè€…ï¼šå°å‚…å“¥
<br/>åšå®¢ï¼š[https://bugstack.cn](https://bugstack.cn)
<br/>åŸæ–‡ï¼š[https://mp.weixin.qq.com/s/4DFCF83bySTYyBZgouX6-w](https://mp.weixin.qq.com/s/4DFCF83bySTYyBZgouX6-w)

>æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„

## ä¸€ã€å‰è¨€

`éƒ½èƒ½ç”¨ï¼Œéƒ½èƒ½å‡‘æ´»ç”¨ï¼`

ä¸€ä¸ªä¸œè¥¿å¥½å‡ å¥—ï¼Œä¸ºäº†æ™‹å‡éƒ½æ¥æã€‚æ‹¿äº†æˆç»©å°±è¦è·‘ï¼Œåé¢å…„å¼Ÿå†é‡é€ ï¼

å‡ å¹´å‰ï¼Œå¤§å®¶å¹¶ä¸æ˜¯è¿™æ ·ï¼Œé‚£æ—¶å€™è¿˜æœ‰å¾ˆå¤šä¸œè¥¿å¯ä»¥åˆ›æ–°ï¼Œä¹±ä¸–å‡ºè‹±é›„æ€»èƒ½åœ¨ä¸€ä¸ªæ–¹å‘æ·±è€•å¹¶åšå‡ºä¸€æ¬¾æ¬¾å¥½ç”¨çš„äº§å“åŠŸèƒ½ã€æ¡†æ¶æœåŠ¡ã€æŠ€æœ¯ç»„ä»¶ç­‰ã€‚ä½†åæ¥å¥½åƒè¿™æ ·çš„æƒ…å†µå¼€å§‹å‡å°‘äº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯é‡å¤ã€å¤åˆ»ã€ç…§æ¬ï¼Œæ¢ä¸ªæ–°çš„çš®è‚¤ã€æ¢ä¸ªæ–°çš„æ ·å¼ã€æ¢ä¸ªæ–°çš„åå­—ï¼Œå°±æ˜¯å–å·§çš„æ–°ä¸œè¥¿äº†ã€‚

æœ‰æ—¶å€™å…¬å¸æˆ–è€…ç»„ç»‡ä¹Ÿåƒå®¶ï¼Œä½†å®¶é‡Œçš„ä¸œè¥¿ä¸€èˆ¬æ˜¯ç ´äº†è¡¥è¡¥ã€åäº†ä¿®ä¿®ï¼Œå®åœ¨ä¸è¡Œå°±æ¢ä¸ªï¼Œä½†æ²¡æœ‰è°çš„å®¶é‡Œå«ç”Ÿé—´ä¸€ä¸ªé©¬æ¡¶ã€å¨æˆ¿ä¸€ä¸ªé©¬æ¡¶ã€å®¢å…ä¸€ä¸ªé©¬æ¡¶ã€å§å®¤ä¸€ä¸ªé©¬æ¡¶çš„ï¼Œè™½ç„¶ä½ çš„æ–°é©¬æ¡¶å¯ä»¥è‡ªåŠ¨å–·æ°´ã€‚

æ‰€ä»¥ï¼Œåœ¨å»ºè®¾ä¸€ä¸ªå¥½çš„äº§å“åŠŸèƒ½æ—¶ï¼Œå°½å¯èƒ½è¦å­¦å­¦é‚£äº›å·²ç»éå¸¸çš„ä¼˜ç§€çš„äº§å“ï¼ŒIDEAã€GitHubã€Mysqlç­‰ç­‰ï¼Œåœ¨IDEAæä¾›äº†æ»¡è¶³ç”¨æˆ·æ‰©å±•åŠŸèƒ½çš„æ’ä»¶å¼€å‘ï¼Œè€Œä¸æ˜¯ä½ è¯´ä¸€ä¸ªä¸œè¥¿æˆ‘æ²¡æœ‰ï¼Œä½ å°±è‡ªå·±é€ ã€‚*å…±å»ºä¼šè®©è¿™ä¸ªä¸œè¥¿å˜å¾—æ›´åŠ ä¼˜ç§€ï¼*

## äºŒã€éœ€æ±‚ç›®çš„

åœ¨ä¸Šä¸€ç« èŠ‚ä¸­æˆ‘ä»¬é€šè¿‡æ‰©å±•åˆ›å»ºå·¥ç¨‹å‘å¯¼ï¼Œæ·»åŠ æˆ‘ä»¬éœ€è¦åˆ›å»ºDDDå·¥ç¨‹è„šæ‰‹æ¶çš„æ­¥éª¤ï¼Œæœ€ç»ˆæä¾›ä¸€ä¸ªDDDå¼€å‘æ¡†æ¶ã€‚é‚£ä¹ˆåœ¨è¿™ä¸ªDDDå·¥ç¨‹å¼€å‘æ¡†æ¶ä¸­ï¼Œè¿˜ç¼ºå°‘ä¸€éƒ¨åˆ†åŸºäºæ•°æ®åº“è¡¨ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆå¯¹åº”POã€DAOã€Mapperæ–‡ä»¶çš„åŠŸèƒ½ã€‚

![](https://bugstack.cn/images/article/assembly/assembly-211207-5-01.png)

- é‚£ä¹ˆæœ¬ç« èŠ‚æˆ‘ä»¬å°±æ¥åœ¨å·¥ç¨‹ä¸­æ‰©å±•è¿™éƒ¨åˆ†å†…å®¹ï¼Œå®é™…æ“ä½œçš„æ•ˆæœå°±æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨å·¥ç¨‹ä¸Šé€šè¿‡é¼ æ ‡å³é”®çš„æ–¹å¼ï¼Œå”¤å‡ºæ·»åŠ ORMä»£ç å—çš„çª—ä½“ï¼Œé€šè¿‡é€‰æ‹©åº“è¡¨çš„æ–¹å¼ï¼Œä½¿ç”¨ freemarker è‡ªåŠ¨ç”Ÿæˆä»£ç ã€‚
- åœ¨ç”Ÿæˆçš„ä»£ç å—ä¸­éœ€è¦å®Œæˆå¯¹æ‰€éœ€è¦åŒ…çš„å¼•å…¥ï¼ŒåŒæ—¶ä¼šä½¿ç”¨åˆ° lombok æ³¨è§£çš„æ–¹å¼æ›¿ä»£POå¯¹è±¡ä¸­çš„getã€setæ–¹æ³•ï¼Œä»¥å‡å°‘ä»£ç é‡é€»è¾‘çš„åˆ›å»ºã€‚

## ä¸‰ã€æ¡ˆä¾‹å¼€å‘

### 1. å·¥ç¨‹ç»“æ„

```java
guide-idea-plugin-orm
â”œâ”€â”€ .gradle
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â””â”€â”€ java
    â”‚   	â””â”€â”€ cn.bugstack.guide.idea.plugin 
    â”‚       	â”œâ”€â”€ action
    â”‚       	â”‚	â””â”€â”€ CodeGenerateAction.java      
    â”‚       	â”œâ”€â”€ domain
    â”‚       	â”‚	â”œâ”€â”€ model.vo 
    â”‚       	â”‚	â”‚	â”œâ”€â”€ CodeGenContextVO.java       
    â”‚       	â”‚	â”‚	â””â”€â”€ ORMConfigVO.java       
    â”‚       	â”‚	â””â”€â”€ service   
    â”‚       	â”‚	 	â”œâ”€â”€ impl     
    â”‚       	â”‚	 	â”‚	â””â”€â”€ ProjectGeneratorImpl.java  
    â”‚       	â”‚	 	â”œâ”€â”€ AbstractProjectGenerator.java     
    â”‚       	â”‚	 	â”œâ”€â”€ GeneratorConfig.java      
    â”‚       	â”‚	 	â””â”€â”€ IProjectGenerator.java      
    â”‚       	â”œâ”€â”€ infrastructure
    â”‚       	â”‚	â”œâ”€â”€ data    
    â”‚       	â”‚	â”‚	â”œâ”€â”€ DataSetting.java       
    â”‚       	â”‚	â”‚	â””â”€â”€ DataState.java      
    â”‚       	â”‚	â”œâ”€â”€ po    
    â”‚       	â”‚	â”‚	â”œâ”€â”€ Base.java    
    â”‚       	â”‚	â”‚	â”œâ”€â”€ Column.java 
    â”‚       	â”‚	â”‚	â”œâ”€â”€ Dao.java 
    â”‚       	â”‚	â”‚	â”œâ”€â”€ Field.java 
    â”‚       	â”‚	â”‚	â”œâ”€â”€ Model.java     
    â”‚       	â”‚	â”‚	â””â”€â”€ Table.java       
    â”‚       	â”‚	â””â”€â”€ utils 
    â”‚       	â”‚		â”œâ”€â”€ DBHelper.java     
    â”‚       	â”‚		â””â”€â”€ JavaType.java      
    â”‚       	â”œâ”€â”€ module  
    â”‚       	â”‚	â””â”€â”€ FileChooserComponent.java         
    â”‚       	â””â”€â”€ ui
    â”‚       	 	â”œâ”€â”€ ORMSettingsUI.java  
    â”‚       	 	â””â”€â”€ ORMSettingsUI.form
    â”œâ”€â”€ resources
    â”‚   â”œâ”€â”€ META-INF
    â”‚   â”‚   â””â”€â”€ plugin.xml 
    â”‚   â””â”€â”€ template
    â”‚       â”œâ”€â”€ dao.ftl
    â”‚       â”œâ”€â”€ mapper.ftl
    â”‚       â””â”€â”€ model.ftl
    â”œâ”€â”€ build.gradle  
    â””â”€â”€ gradle.properties
```

**æºç è·å–**ï¼š#å…¬ä¼—å·ï¼š`bugstackè™«æ´æ ˆ` å›å¤ï¼š`idea` å³å¯ä¸‹è½½å…¨éƒ¨ IDEA æ’ä»¶å¼€å‘æºç 

åœ¨æ­¤ IDEA æ’ä»¶å·¥ç¨‹ä¸­ï¼Œä¸»è¦åˆ†ä¸º5å—åŒºåŸŸï¼š

- actionï¼šç”¨äºæä¾›èœå•æ ï¼Œè¿™ä¸ªèœå•çš„ä½ç½®åœ¨ plugin.xml ä¸­é…ç½®ï¼Œæˆ‘ä»¬æŠŠå®ƒé…ç½®åˆ°å·¥ç¨‹é¼ æ ‡å³é”®å‡ºç°çš„åˆ—è¡¨ä¸Šã€‚*è¿™æ ·å¯ä»¥æ›´åŠ æ–¹ä¾¿çš„è®©æˆ‘ä»¬é€‰å–å·¥ç¨‹ï¼Œä»¥åŠåœ¨è¿™ä¸ªå·¥ç¨‹ä¸‹æ·»åŠ ç”Ÿæˆçš„ä»£ç ç‰‡æ®µ*
- domainï¼šé¢†åŸŸæœåŠ¡å±‚ï¼Œå…¶å®ä½ ç›´æ¥å†™ä¸€ä¸ªServiceåŒ…ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåªä¸è¿‡æœ€è¿‘ä½œè€…å°å‚…å“¥æ›´å–œæ¬¢ä½¿ç”¨DDDçš„æ€æƒ³å’Œç»“æ„æ¥åˆ›å»ºä»£ç å®ç°åŠŸèƒ½é€»è¾‘ã€‚
- infrastructureï¼šåŸºç¡€å±‚ï¼Œæä¾›æ•°æ®åœ¨å·¥ç¨‹ä¸‹çš„å­˜æ”¾ï¼Œæ¯ä¸€ä¸ªå·¥ç¨‹å³é”®éƒ½æœ‰è‡ªå·±çš„é…ç½®å­˜å‚¨é»˜è®¤ä¿¡æ¯ï¼Œæ–¹ä¾¿ä¸‹æ¬¡æ‰“å¼€çš„æ—¶å€™å¯ä»¥è¯»å–åˆ°è¿™éƒ¨åˆ†å†…å®¹ã€‚åŒæ—¶è¿™ä¸€å±‚è¿˜æä¾›äº†ç”¨äºå¤„ç†æ•°æ®åº“æ“ä½œçš„ç±»ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ä»æ•°æ®åº“ä¸­è¯»å–å‡ºè¡¨çš„ä¿¡æ¯ã€å­—æ®µã€æ³¨é‡Šï¼Œç”¨äºåˆ›å»ºPOã€DAOã€Mapperä½¿ç”¨ã€‚
- moduleï¼šæ¨¡å—å±‚ï¼Œè¿™é‡Œæä¾›äº†ä¸€ä¸ªç”¨äºé€‰æ‹©æ–‡ä»¶è·¯å¾„çš„ç»„ä»¶ï¼Œå¯ä»¥è®©æˆ‘ä»¬åœ¨å·¥ç¨‹ä¸Šé¼ æ ‡å³é”®åå‡ºæ¥çš„çª—ä½“ä¸­ï¼Œç‚¹å‡»æ¨¡å—é€‰æ‹©å¯¹åº”çš„è¦ç”Ÿæˆä»£ç çš„ä½ç½®è·¯å¾„ã€‚
- uiï¼šæä¾›é…ç½®é¢æ¿ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨ä»£ç å·¥ç¨‹ä¸Šé¼ æ ‡å³é”®å¼¹å‡ºæ¥çš„é¢æ¿ï¼Œè¿™ä¸ªé¢æ¿é…ç½®åç”¨äºç”ŸæˆORMä»£ç ã€‚

### 2. æ‹–æ‹½Swingé¢æ¿

**ORMSettingsUI**ï¼šå’±ä»¬å…ˆæŠŠç”¨äºåˆ›å»ºä»£ç é…ç½®çš„é¢æ¿åˆ›å»ºå‡ºæ¥ï¼Œæœ‰äº†ç”»é¢ï¼Œå°±å¥½è¿›å…¥äº†ã€‚

![](https://bugstack.cn/images/article/assembly/assembly-211207-5-02.png)

- é¢æ¿åŒ…æ‹¬ç”Ÿæˆ POã€DAOã€XML çš„ä»£ç è·¯å¾„ï¼Œä»¥åŠé…ç½®æ•°æ®åº“å’Œé€‰æ‹©è¡¨çš„å†…å®¹ã€‚
- æ“ä½œè¿‡ç¨‹å°±æ˜¯åœ¨ä½ é…ç½®å¥½äº†è¿™äº›åŸºæœ¬ä¿¡æ¯åï¼Œå°±å¯ä»¥é€‰æ‹©æŸ¥è¯¢è¡¨åï¼Œå¹¶é€‰æ‹©å¥½ä½ è¦ç»™å“ªå‡ ä¸ªè¡¨ç”Ÿæˆå¯¹åº”çš„ORMä»£ç äº†ã€‚

### 3. é…ç½®é¼ æ ‡å³é”®å¼¹çª—

é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª Action å®ç°ç±»ï¼Œé€šè¿‡ `New -> Plugin DevKit -> Action`

![](https://bugstack.cn/images/article/assembly/assembly-211207-5-03.png)

**cn.bugstack.guide.idea.plugin.action.CodeGenerateAction**

```java
/**
 * @author: å°å‚…å“¥ï¼Œå¾®ä¿¡ï¼šfustack
 * @github: https://github.com/fuzhengwei
 * @Copyright: å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | åšå®¢ï¼šhttps://bugstack.cn - æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼
 */
public class CodeGenerateAction extends AnAction {

    private IProjectGenerator projectGenerator = new ProjectGeneratorImpl();

    @Override
    public void actionPerformed(AnActionEvent e) {
        Project project = e.getRequiredData(CommonDataKeys.PROJECT);
        ShowSettingsUtil.getInstance().editConfigurable(project, new ORMSettingsUI(project, projectGenerator));
    }

}
```

- è¿™æ˜¯ä¸€ä¸ªå³é”®èœå•çš„å…¥å£ï¼Œé€šè¿‡è¿™ä¸ªå…¥å£æ‰èƒ½å»æ‰“å¼€æˆ‘ä»¬è‡ªå·±çš„UIçª—ä½“ï¼Œè¿™ä¸ªUIçª—ä½“å°±æ˜¯æˆ‘ä»¬ä¸Šé¢æ‹–æ‹½å‡ºæ¥çš„é…ç½®é¢æ¿ï¼ŒORMSettingsUI
- æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜éœ€è¦æŠŠè¿™ä¸ª Action é…ç½®åˆ° plugin.xml æ–‡ä»¶ä¸­ï¼Œæ‰èƒ½è¢«å³é”®èœå•åˆ›å»ºå‡ºæ¥ã€‚*å¼€å‘ä»£ç çš„æ—¶å€™ä¹Ÿæ˜¯è¿™æ ·ä¸€ä¸ªæµç¨‹ï¼Œä½ æ€»è¦ä»ä¸€ä¸ªç‚¹å¼€å§‹ï¼Œæœ‰äº†æŠ“æ‰‹æ‰å¥½æŠ“ä¸‹å»*

**plugin.xml é…ç½®**

```xml
<actions>
    <!-- Add your actions here -->
    <action id="CodeGenerateAction" class="cn.bugstack.guide.idea.plugin.action.CodeGenerateAction"
            text="ORMCodeGenerate - å°å‚…å“¥" description="Code Generate ORM" icon="/icons/logo.png">
        <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
    </action>
</actions>
ea-plugin>
```

- æŠŠæˆ‘ä»¬çš„ Action å®ç°ç±»é…ç½®åˆ° xml ä¸­ï¼ŒåŒæ—¶ä½ è¿˜è¦é…ç½®å®ƒåº”è¯¥å‡ºç°çš„ä½ç½®ï¼Œæ¯”å¦‚ä½ éœ€è¦æŠŠè¿™ä¸ªèœå•æ·»åŠ åˆ°å·¥ç¨‹åˆ›å»ºä¸­ `ProjectViewPopupMenu` ä»¥åŠä½ç½®ä¿¡æ¯ `anchor="last"`
- å¦å¤–ä¸ºäº†è®©æ’ä»¶çœ‹ä¸Šå»æ›´åŠ é«˜å¤§ä¸Šè¿˜ç¾è§‚é€‚åˆå¹ç‰›ï¼Œé‚£ä¹ˆè¿˜éœ€è¦é…ç½® iconï¼Œè¿™ä¸ªä½ç½®é…ç½®ä¸€ä¸ª`16*16`çš„å›¾ç‰‡ï¼Œå›¾ç‰‡å¯ä»¥ä» [iconfont](https://www.iconfont.cn/) è¿›è¡Œä¸‹è½½ã€‚

### 4. ç»™çª—ä½“æ·»åŠ åŠŸèƒ½

è¿™ä¸€æ­¥å…¶å®å¹²çš„å°±æ˜¯æ³¨å…¥çµé­‚çš„äº‹æƒ…ï¼Œè®©çª—ä½“æ´»èµ·æ¥ã€‚ç»™è¾“å…¥æ¡†æ·»åŠ å†…å®¹ã€ç»™æŒ‰é’®æ·»åŠ äº‹ä»¶ã€ç»™ç¡®è®¤æŒ‰é’®å¢åŠ ä¸Šç”Ÿæˆåˆ›å»ºORMä»£ç å—çš„ä¸Šä¸‹æ–‡ã€‚*æ–‡ç« çš„æè¿°å°½å¯èƒ½ä¼šåå‘äºæ ¸å¿ƒä»£ç çš„è®²è§£ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒæºç *

æ¥ä¸‹æ¥è¿™éƒ¨åˆ†å†…å®¹ä¼šåœ¨ ORMSettingsUI ç±»ä¸­**åå¤æ‘©æ“¦**ï¼Œç›´åˆ°è¡¥å…¨æ‰€æœ‰åŠŸèƒ½ã€‚

#### 4.1 é€‰æ‹©æ¡†äº‹ä»¶

![](https://bugstack.cn/images/article/assembly/assembly-211207-5-04.png)

```java
// é€‰æ‹©POç”Ÿæˆç›®å½•
this.poButton.addActionListener(e -> {
    FileChooserComponent component = FileChooserComponent.getInstance(project);
    VirtualFile baseDir = project.getBaseDir();
    VirtualFile virtualFile = component.showFolderSelectionDialog("é€‰æ‹©POç”Ÿæˆç›®å½•", baseDir, baseDir);
    if (null != virtualFile) {
        ORMSettingsUI.this.poPath.setText(virtualFile.getPath());
    }
});
```

- è¿˜è®°å¾—æˆ‘ä»¬æåˆ°çš„`æ‹–æ‹½Swingé¢æ¿`å—ï¼Œé‚£ä¹ˆè¿™ä¸ªæ·»åŠ äº‹ä»¶çš„æ­¥éª¤å°±æ˜¯ç»™ä½ çš„ PO ç›®å½•æ·»åŠ ä¸€ä¸ªäº‹ä»¶ï¼Œå…è®¸æˆ‘ä»¬å¯ä»¥è‡ªå·±é€‰æ‹©å‡ºè¦æŠŠå¯¹åº”POçš„ä»£ç ç”Ÿæˆåˆ°å“ªä¸ªç›®å½•ç»“æ„ä¸‹ã€‚
- å…³äºdaoã€xmléƒ½æ˜¯ç±»ä¼¼æ“ä½œï¼Œè¿™é‡Œå°±ä¸åœ¨æ¼”ç¤ºäº†ã€‚

#### 4.2 æ•°æ®è¡¨äº‹ä»¶

![](https://bugstack.cn/images/article/assembly/assembly-211207-5-05.png)

```java
this.selectButton.addActionListener(e -> {
    try {
        DBHelper dbHelper = new DBHelper(this.host.getText(), Integer.parseInt(this.port.getText()), this.user.getText(), this.password.getText(), this.database.getText());
        List<String> tableList = dbHelper.getAllTableName(this.database.getText());
        String[] title = {"", "è¡¨å"};
        Object[][] data = new Object[tableList.size()][2];
        for (int i = 0; i < tableList.size(); i++) {
            data[i][1] = tableList.get(i);
        }
        table1.setModel(new DefaultTableModel(data, title));
        TableColumn tc = table1.getColumnModel().getColumn(0);
        tc.setCellEditor(new DefaultCellEditor(new JCheckBox()));
        tc.setCellEditor(table1.getDefaultEditor(Boolean.class));
        tc.setCellRenderer(table1.getDefaultRenderer(Boolean.class));
        tc.setMaxWidth(100);
    } catch (Exception exception) {
        Messages.showWarningDialog(project, "æ•°æ®åº“è¿æ¥é”™è¯¯,è¯·æ£€æŸ¥é…ç½®.", "Warning");
    }
});
```

- è¿™ä¸€æ­¥æ“ä½œæ ¸å¿ƒæµç¨‹å°±åœ¨äºæŠŠä½ éœ€è¦ç”ŸæˆORMçš„ä»£ç çš„è¡¨ç»™æ‹‰å‡ºæ¥ï¼Œåªè¦æŠŠè¡¨é€‰æ‹©ä¸Šï¼Œæ‰èƒ½æ ¹æ®è¡¨ç”ŸæˆPOã€DAOã€Mapperï¼Œå…¶å®ä½ ç”¨çš„å…¶ä»–ä¸€äº›è‡ªåŠ¨ç”Ÿæˆä»£ç æ¡†æ¶ä¹Ÿæ˜¯è¿™ä¹ˆå¹²çš„ã€‚
- å¦å¤–ä½ çš„å»ºè¡¨æœ€å¥½è§„èŒƒï¼Œæ¯”å¦‚æœ‰è¡¨æ³¨é‡Šã€æœ‰å­—æ®µæ³¨é‡Šã€å­—æ®µçš„è®¾è®¡éµå®ˆä¸‹åˆ’çº¿å’Œå°å†™å­—æ¯ï¼Œè¿™æ ·ä¼šæ›´åŠ å®¹æ˜“åˆ›å»ºå‡ºå¥½çœ‹çš„ä»£ç ã€‚

#### 4.3 ç»„è£…ç”Ÿæˆä»£ç ä¸Šä¸‹æ–‡

å½“æˆ‘ä»¬ç‚¹å‡»é…ç½®çª—ä½“çš„ **OK** æŒ‰é’®æ—¶å€™ï¼Œè¦å¹²å•¥ï¼Œå¯¹å–½ï¼Œæˆ‘ä»¬è¦åˆ›å»ºå‡ºä»£ç ç‰‡æ®µäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™éœ€è¦åœ¨é‡å†™çš„ `apply` ä¸­å®Œæˆæ­¤é¡¹æ“ä½œã€‚

```java
public void apply() {
    // é“¾æ¥DB
    DBHelper dbHelper = new DBHelper(config.getHost(), Integer.parseInt(config.getPort()), config.getUser(), config.getPassword(), config.getDatabase());
    
    // ç»„è£…ä»£ç ç”Ÿäº§ä¸Šä¸‹æ–‡
    CodeGenContextVO codeGenContext = new CodeGenContextVO();
    codeGenContext.setModelPackage(config.getPoPath() + "/po/");
    codeGenContext.setDaoPackage(config.getDaoPath() + "/dao/");
    codeGenContext.setMapperDir(config.getXmlPath() + "/mapper/");
    List<Table> tables = new ArrayList<>();
    Set<String> tableNames = config.getTableNames();
    for (String tableName : tableNames) {
        tables.add(dbHelper.getTable(tableName));
    }
    codeGenContext.setTables(tables);
    
    // ç”Ÿæˆä»£ç 
    projectGenerator.generation(project, codeGenContext);
}
```

- åœ¨ apply ä¸­çš„æ ¸å¿ƒä»£ç ä¸»è¦å°±æ˜¯ä½¿ç”¨ DBHelper æ•°æ®æ“ä½œå·¥å…·è·å–åˆ°å¯¹åº”çš„åº“ä¸‹é“¾æ¥ä¿¡æ¯ï¼ŒåŒæ—¶æŠŠé€‰æ‹©çš„å·çš„è¡¨åˆ›å»ºå‡ºç”¨äºç”Ÿæˆä»£ç ç±»çš„å‚æ•°ï¼Œæ¯”å¦‚ï¼›ç±»çš„åç§°ã€å­—æ®µåç§°ã€æ³¨é‡Šåç§°ç­‰ã€‚
- æœ€åå°±æ˜¯è°ƒç”¨ç”Ÿæˆä»£ç çš„æœåŠ¡äº†ï¼Œ`projectGenerator.generation(project, codeGenContext);` è¿™ä¸€éƒ¨åˆ†å°±æ˜¯åœ¨æˆ‘ä»¬é¢†åŸŸæœåŠ¡ domain ä¸­å®ç°çš„ã€‚

### 5. ä»£ç ç”Ÿæˆé¢†åŸŸæœåŠ¡

![](https://bugstack.cn/images/article/assembly/assembly-211207-5-06.png)

- ç”¨äºåˆ›å»ºPOã€DAOã€Mapperçš„ä»£ç å—çš„ä»£ç ä¸»è¦æ˜¯è¿™é‡Œå®ç°çš„ï¼Œæ ¸å¿ƒåœ¨äºæä¾›äº†ä¸€ä¸ªæŠ½è±¡ç±»ä»¥åŠå¯¹åº”çš„å®ç°ç±»ï¼Œå› ä¸ºå¤„ç†ä»£ç ç”Ÿæˆéœ€è¦ä½¿ç”¨åˆ° freemarker æ‰€ä»¥å°±åœ¨æŠ½è±¡ç±»é‡ŒåŒ…è£…äº†ä¸‹ï¼Œè¿™æ ·å¯ä»¥å…å»å®ç°ç±»ä¸­è¿˜éœ€è¦å…³å¿ƒè¿™éƒ¨åˆ†é€»è¾‘ã€‚

**ProjectGeneratorImpl ç”Ÿæˆä»£ç **

```java
@Override
protected void generateORM(Project project, CodeGenContextVO codeGenContext) {
    List<Table> tables = codeGenContext.getTables();
    for (Table table : tables) {
        List<Column> columns = table.getColumns();
        List<Field> fields = new ArrayList<>();
        for (Column column : columns) {
            Field field = new Field(column.getComment(), JavaType.convertType(column.getType()), column.getName());
            field.setId(column.isId());
            fields.add(field);
        }
        // ç”ŸæˆPO
        Model model = new Model(table.getComment(), codeGenContext.getModelPackage() + CaseFormat.UPPER_UNDERSCORE.to(CaseFormat.UPPER_CAMEL, table.getName()), table.getName(), fields);
        writeFile(project, codeGenContext.getModelPackage(), model.getSimpleName() + ".java", "domain/orm/model.ftl", model);
        
        // ç”ŸæˆDAO
        Dao dao = new Dao(table.getComment(), codeGenContext.getDaoPackage() + "I" + CaseFormat.UPPER_UNDERSCORE.to(CaseFormat.UPPER_CAMEL, table.getName()) + "Dao", model);
        writeFile(project, codeGenContext.getDaoPackage(), dao.getSimpleName() + ".java", "domain/orm/dao.ftl", dao);
        
        // ç”ŸæˆMapper
        writeFile(project, codeGenContext.getMapperDir(), dao.getModel().getSimpleName() + "Mapper.xml", "domain/orm/mapper.ftl", dao);
    }
}
```

- åˆ›å»ºä»£ç çš„è¿‡ç¨‹å°±æ¯”è¾ƒç®€å•äº†ï¼Œé€šè¿‡å¾ªç¯æå–å‡ºæ¥çš„è¡¨ä¿¡æ¯ï¼Œæ˜ å°„æˆå¯¹åº”çš„ç±»å’Œå±æ€§ä»¥åŠæ³¨é‡Šï¼Œå†ä½¿ç”¨ resources ä¸‹çš„ ftl æ–‡ä»¶åˆ›å»ºå‡ºå¯¹åº”çš„ç±»å’Œxmlé…ç½®æ–‡ä»¶å°±å¯ä»¥äº†ã€‚
- å¦‚æœä½ è¿˜éœ€è¦ç”Ÿæˆèµ·æ¥ä»£ç ç‰‡æ®µæˆ–è€…åˆ›å»ºè°ƒç”¨ä¸€äº›å¸¸ç”¨çš„ç»„ä»¶ï¼Œä¹Ÿæ˜¯å¯ä»¥é€šè¿‡è¿™æ ·çš„æ–¹å¼è¿›è¡Œå®ç°çš„ã€‚

## å››ã€æµ‹è¯•éªŒè¯

- ç‚¹å‡» `Plugin` å¯åŠ¨ IDEA æ’ä»¶ï¼Œä¹‹ååœ¨å·¥ç¨‹å³é”®å¦‚ä¸‹ï¼š

**1. é¼ æ ‡å³é”®ï¼Œé€‰æ‹©èœå•**

![](https://bugstack.cn/images/article/assembly/assembly-211207-5-07.png)

**2. é…ç½®é¡µé¢ï¼Œé…ç½®ä¿¡æ¯**

![](https://bugstack.cn/images/article/assembly/assembly-211207-5-08.png)

**3. è‡ªåŠ¨åˆ›å»ºï¼Œç”Ÿæˆä»£ç **

![](https://bugstack.cn/images/article/assembly/assembly-211207-5-09.png)

- å¥½äº†ï¼Œé€‰æ‹©ä»£ç å—å°±è¿™ä¹ˆå—–çš„åˆ›å»ºäº†å‡ºæ¥ï¼Œæ˜¯ä¸æ˜¯éå¸¸æ–¹ä¾¿ï¼Œè€Œä¸”å¯ä»¥æ»¡è¶³ä½ åœ¨ä»»ä½•æ—¶å€™çš„æŠŠæ–°çš„åº“è¡¨ä»£ç è¡¥å……è¿›æ¥ï¼Œå‡å°‘äº†æ‰‹æ•²CRUDæ“ä½œã€‚

## äº”ã€æ€»ç»“

- æœ¬ç« èŠ‚å°å‚…å“¥å¸¦ç€ä½ åˆåœ¨ IDEA DDD æ’ä»¶ç”Ÿæˆå·¥ç¨‹çš„ç»“æ„ä¸‹ï¼Œåˆå®Œå–„äº†ä¸€æ­¥ç”ŸæˆORMä»£ç ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨åˆ›å»ºå·¥ç¨‹å‘å¯¼ä¸­æ·»åŠ ç”ŸæˆORMä»£ç çš„æ­¥éª¤ã€‚è€Œåœ¨å·¥ç¨‹ä¸‹åˆ›å»ºORMçš„æ–¹å¼å¯ä»¥å½“åšæ˜¯å¯¹è„šæ‰‹æ¶å·¥ç¨‹çš„è¡¥å……ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯ä¸‹çš„éœ€æ±‚ã€‚
- æ­¤å¤–åœ¨ IDEA æ’ä»¶å¼€å‘çš„ç³»åˆ—å†…å®¹ä¸­æˆ‘ä»¬æ˜¯ä¸æ–­çš„å°è¯•ä½¿ç”¨æ–°çš„æ–¹å¼å®Œå–„ä¸åŒçš„åŠŸèƒ½ç‚¹ï¼Œå¦‚æœä½ éœ€è¦å¼€å‘ä¸€ä¸ªå®Œæ•´çš„æ’ä»¶é‚£ä¹ˆå¯ä»¥ç»“åˆè¿™äº›åŠŸèƒ½ä¸€èµ·æ¥å¼€å‘ä½ çš„éœ€æ±‚ã€‚
- æ’ä»¶å¼€å‘ä¸­è¿˜æ˜¯æœ‰å¾ˆå¤šçš„å†…å®¹éœ€è¦äº†è§£å’Œå­¦ä¹ çš„ï¼ŒåŒæ—¶ä¹Ÿè¦æ³¨æ„ä¸€äº›ä»£ç å®ç°ç»†èŠ‚ï¼Œä¾‹å¦‚æˆ‘ä»¬æœ¬ç« èŠ‚ä¸­çš„æ•°æ®ä¿å­˜æ˜¯åœ¨ä¸€ä¸ªä»€ä¹ˆç»´åº¦ï¼Œæ˜¯IDEAå¼€å‘å·¥å…·ç»´åº¦ï¼Œè¿˜æ˜¯åœ¨IDEAä¸­çš„å·¥ç¨‹ç»´åº¦ï¼Œè¿™äº›æ˜¯æœ‰åŒºåˆ«ã€‚*æ¯”å¦‚ä½ çš„ä¸åŒå·¥ç¨‹ï¼Œæ˜¯ä¸éœ€è¦ä¿å­˜åŒä¸€ä»½é…ç½®çš„*