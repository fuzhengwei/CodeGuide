---
title: ç¬¬12èŠ‚ï¼šåŠ è½½æ–‡ä»¶ç”Ÿæˆé“¾è¡¨å•è¯æ ‘ï¼Œè¾“å…¥å±æ€§æ—¶è‹±æ–‡æ ¡å‡†æé†’
lock: need
---

# ç¬¬12èŠ‚ï¼šåŠ è½½æ–‡ä»¶ç”Ÿæˆé“¾è¡¨å•è¯æ ‘ï¼Œè¾“å…¥å±æ€§æ—¶è‹±æ–‡æ ¡å‡†æé†’

ä½œè€…ï¼šå°å‚…å“¥
<br/>åšå®¢ï¼š[https://bugstack.cn](https://bugstack.cn)

>æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„

## ä¸€ã€å‰è¨€

`ä½ ä¸çŸ¥é“è¿™ä¸ªå·²ç»æœ‰äººåšäº†å—ï¼Ÿ`

å“ˆå“ˆå“ˆï¼Œæ˜¯ä¸æ˜¯ä½ åœ¨åšä¸€äº›å°è¯•ã€åˆ›æ–°ã€è½åœ°çš„æ—¶å€™ï¼Œéƒ½å¯èƒ½ä¼šè¢«æœ‰äº›äººé—®è¿™æ ·çš„è¯ï¼Œå¥½åƒè¿™ä¸€å¥è¯è¿˜æŒºæœ‰åŠ›é‡çš„ã€‚`ä½ ä¸çŸ¥é“è¯´æ˜ä½ è°ƒç ”ä¸å¤Ÿã€æœ‰äººåšäº†ä½ è¿˜æè¯æ˜æµªè´¹æ—¶é—´`ï¼Œé‚£ä½ é—®ä»–ä½ çŸ¥é“é‚£ä¸ªå·²ç»åšäº†çš„æ€ä¹ˆè®¾è®¡çš„ã€ç”¨äº†ä»€ä¹ˆæŠ€æœ¯ã€æˆ‘ä»¬å¯ä»¥å€Ÿé‰´å“ªäº›èƒ½åŠ›å‘¢ï¼Œä»–åˆæœ‰7788çš„ä¸€å †ç†ç”±ï¼Œæ€»ä¹‹ä¸€å¼ å˜´ï¼Œéƒ½æ˜¯è¿›å£é¥®æ–™ã€‚

ä½†å…¶å®æˆ‘ä»¬å¾ˆå¤šæ—¶å€™åœ¨å­¦ä¹ è¡¥å……è‡ªå·±çš„èƒ½åŠ›ï¼Œæ˜¯è¦é€šè¿‡å¤§é‡å®è·µéªŒè¯çš„ï¼Œåœ¨å®è·µçš„è¿‡ç¨‹ä¸­å®Œå–„Xäº§å“çš„aåŠŸèƒ½ï¼Œè¡¥å……Yäº§å“çš„båŠŸèƒ½ï¼Œè€Œè¿™äº›ä¸€ä¸ªä¸ªå°çš„ç‚¹å°±åƒæˆ‘ä»¬ç§¯ç´¯ä¸‹æ¥çš„ä¹é«˜ç©å…·ï¼Œæˆ‘ä»¬æœ‰å®è·µæ”¯æ’‘ç†è®ºï¼Œé‚£ä¹ˆåœ¨ä»¥åçœŸçš„è¦å¼€å‘äº§å“æ‰€éœ€èƒ½åŠ›çš„æ—¶å€™ï¼Œå°±æ˜¯æŠŠè¿™äº›ä¸€ä¸ªä¸ªçš„ä¹é«˜æŠ€æœ¯æŠ€èƒ½ï¼Œç»„åˆèµ·æ¥ï¼Œæ­å»ºå‡ºæˆ‘ä»¬çš„ç›®æ ‡ç»“æœã€‚`ä½†å¦‚æœä½ æ²¡æŠ˜è…¾è¿‡ï¼Œé‚£ä¹ˆæ‰‹é‡Œçš„ä¹é«˜è‚¯å®šä¸å¤šï¼`

## äºŒã€éœ€æ±‚ç›®çš„

é¦–å…ˆæˆ‘æƒ³é—®é—®ï¼Œä½ åœ¨ç¼–ç¨‹å¼€å‘ä¸­ï¼Œæœ‰æŠŠç±»åç§°ã€å±æ€§åã€æ–¹æ³•åï¼Œå†™é”™çš„æ—¶å€™å—ï¼Œæ¯”å¦‚ï¼›æŠŠ`data`å†™æˆ`date`ã€æŠŠ`main`å†™æˆ`mian`ã€æŠŠ`queryBatch`å†™æˆ`queryBitch`ï¼Œé—¹äº†å¤§ç¬‘è¯äº†ï¼Œä¸Šçº¿å¯¹å¤–è¿˜æ²¡å‘ä¿®æ”¹äº†ã€‚

é‚£èƒ½æœ‰ä»€ä¹ˆåŠæ³•åœ¨æˆ‘å†™è¿™æ ·çš„å•è¯å±æ€§åç§°çš„æ—¶å€™ï¼Œç»™æˆ‘æ¥ä¸ªæç¤ºï¼ŒæŠŠé‚£äº›å…³è”åˆ°çš„æ­£ç¡®çš„æé†’å‡ºæ¥ï¼Œä¸è¦è®©æˆ‘è¿˜å¾—ä¸€ä¸ªä¸ªæ•²ï¼Œä¸»è¦æ˜¯è¿˜ä¸å—æ§åˆ¶çš„æ•²é”™å‘¢ï¼Ÿ

åŠæ³•æ˜¯æœ‰çš„ï¼Œæœ¬ç« èŠ‚æˆ‘ä»¬å°±ç»“åˆ IDEA Plugin å¼€å‘çš„èƒ½åŠ›ï¼Œåœ¨å¯åŠ¨æ’ä»¶ååŠ è½½å¸¸ç”¨å•è¯æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªå•è¯æ ‘çš„ç»“æ„ã€‚é‚£ä¹ˆç”¨æˆ·åœ¨ IDEA å¼€å‘æ—¶è¾“å…¥å±æ€§åç§°çš„æ—¶å€™ï¼ŒæŒ‰ç…§è¾“å…¥ä¿¡æ¯è·å–å•è¯æ ‘ä¸­çš„åŒ¹é…ä¿¡æ¯ï¼Œå¹¶æé†’æˆåˆ—è¡¨åé¦ˆåˆ°ç”¨æˆ·è¾“å…¥ç•Œé¢ã€‚

## ä¸‰ã€æ¡ˆä¾‹å¼€å‘

### 1. å·¥ç¨‹ç»“æ„

```java
guide-idea-plugin-remind
â”œâ”€â”€ .gradle
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â””â”€â”€ java
    â”‚   	â””â”€â”€ cn.bugstack.guide.idea.plugin 
    â”‚       	â”œâ”€â”€ action
    â”‚       	â”‚	â””â”€â”€ RemindCompletionContributor.java
    â”‚       	â”œâ”€â”€ application
    â”‚       	â”‚	â””â”€â”€ IWordManageService.java
    â”‚       	â”œâ”€â”€ domain
    â”‚       	â”‚	â”œâ”€â”€ model
    â”‚       	â”‚	â”‚   â””â”€â”€ Node.java
    â”‚       	â”‚	â””â”€â”€ service
    â”‚       	â”‚	    â”œâ”€â”€ AbstractWordManage.java
    â”‚       	â”‚	    â””â”€â”€ WordManageServiceImpl.java
    â”‚       	â””â”€â”€ infrastructure
    â”‚       	 	â””â”€â”€ Utils.java
    â”œâ”€â”€ resources
    â”‚   â”œâ”€â”€ dictionary
    â”‚   â”‚   â”œâ”€â”€ word01.txt
    â”‚   â”‚   â”œâ”€â”€ word02.txt
    â”‚   â”‚   â””â”€â”€ word03.txt
    â”‚   â””â”€â”€ META-INF
    â”‚       â””â”€â”€ plugin.xml
    â”œâ”€â”€ build.gradle
    â””â”€â”€ gradle.properties
```

**æºç è·å–**ï¼š#å…¬ä¼—å·ï¼š`bugstackè™«æ´æ ˆ` å›å¤ï¼š`idea` å³å¯ä¸‹è½½å…¨éƒ¨ IDEA æ’ä»¶å¼€å‘æºç 

åœ¨æ­¤ IDEA æ’ä»¶å·¥ç¨‹ä¸­ï¼Œä¸»è¦åˆ†ä¸º2å—æ ¸å¿ƒåŠŸèƒ½ï¼š
- ä»¥æ¥å£ `IWordManageService` ä¸ºä¸»çš„ç”¨äºå®ç°å¯¹ `dictionary` å¤„ç†ï¼Œç”Ÿæˆå•è¯æ ‘é“¾è¡¨ç»“æ„ã€‚
- ä»¥æœåŠ¡ `RemindCompletionContributor` æ£€æµ‹ç”¨æˆ·è¾“å…¥çš„ç†Ÿæ‚‰å•è¯ä¿¡æ¯ï¼Œä»å•è¯æ ‘ä¸­ç´¢å¼•åˆ°åŒ¹é…çš„å†…å®¹è¿”å›ç»™ç”¨æˆ·ã€‚

### 2. å•è¯æ ‘å¤„ç†

#### 2.1 æ•°æ®ç»“æ„

å¤„ç†å•è¯æ ‘ï¼Œå…¶å®å°±æ˜¯å¤„ç†çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œæ€ä¹ˆè®©åœ¨ç”¨æˆ·ä¸€ä¸ªä¸ªçš„è¾“å…¥å­—æ¯çš„æ—¶å€™ï¼Œæ‰¾åˆ°å¯¹åº”åŒ¹é…çš„å•è¯ã€‚é‚£ä¹ˆè¿™é‡Œå°±éœ€è¦æŠŠæ–‡ä»¶ä¸­çš„å•è¯æŒ‰ç…§å­—æ¯ä¸€ä¸ªä¸ªå­˜æ”¾åˆ°é“¾è¡¨ç»“æ„ä¸­ï¼Œä¾‹å¦‚æŠŠ fustack å­˜æ”¾åˆ°å•è¯æ ‘ä¸­ï¼Œå¦‚ä¸‹ï¼š

**word.txt**

```java
fustack#adj.å°å‚…å“¥çš„å¾®ä¿¡
batch#adj.æ‰¹é‡
bitch#adj.å½ªå­ PSï¼šä½ æ˜¯è¦è¾“å…¥ batch å§ï¼Ÿ
```

**word tree**

```java
f->u
f->u->s
f->u->s->t
f->u->s->t->a
f->u->s->t->a->c
f->u->s->t->a->k
```

å½“ç”¨æˆ·è¾“å…¥fã€uï¼Œé‚£ä¹ˆå°±å¼€å§‹ç´¢å¼•è¿™æ£µå•è¯æ ‘ï¼Œæ‰¾åˆ°åŒ¹é…çš„å­—æ¯ä»¥åŠå½“å‰å­—æ¯ä½ç½®åç»­é“¾è·¯ä¸Šçš„æ•´ä¸ªå†…å®¹ï¼Œå¹¶è®°å½•åˆ°å¯ä»¥åé¦ˆç»™ç”¨æˆ·çš„å•è¯åˆ—è¡¨ä¸­ã€‚

#### 2.2 å•è¯å­˜æ”¾

**cn.bugstack.guide.idea.plugin.domain.service.AbstractWordManage**

```java
private void loadFile(String path) {
    try {
        BufferedReader br = new BufferedReader(new InputStreamReader(getClass().getResourceAsStream(path), StandardCharsets.UTF_8));
        String line;
        while ((line = br.readLine()) != null) {
            String[] wordInfo = line.split("#");
            if (!compile.matcher(wordInfo[0]).matches()) {
                continue;
            }
            wordInfo[0] = wordInfo[0].toLowerCase().trim();
            StringBuilder sb = new StringBuilder();
            if (wordInfo.length == 2) {
                Matcher matcher = explainPattern.matcher(wordInfo[1]);
                boolean hasMatch = matcher.find();
                String singleExplain = wordInfo[1];
                do {
                    if (hasMatch) {
                        singleExplain = matcher.group(2);
                        sb.append(matcher.group(1));
                    }
                    sb.append(Arrays.stream(singleExplain.split("[ï¼›;,ï¼Œ]")).min(Comparator.comparingInt(String::length)).get());
                    wordInfo[1] = sb.toString();
                } while (hasMatch = matcher.find());
            }
            insert(wordsTree, wordInfo[0].toLowerCase().trim(), wordInfo.length == 2 ? wordInfo[1] : "");
        }
        br.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
}
```

```java
private static void insert(Node root, String words, String explain) {
    char[] chars = words.toCharArray();
    for (char aChar : chars) {
        int charIndex = aChar - 'a';
        if (root.slot[charIndex] == null) {
            root.slot[charIndex] = new Node();
        }
        root = root.slot[charIndex];
        root.c = aChar;
        root.prefix++;
    }
    root.explain = explain;
    root.count++;
}
```

- loadFile åŠ è½½å’Œè§£ææ–‡ä»¶ä¸­çš„å•è¯ï¼Œä¹‹åä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è·å–å•è¯å’Œæè¿°ä¿¡æ¯ã€‚
- insert æ˜¯å½¢æˆå•è¯æ ‘çš„ä¸€ä¸ªæ“ä½œï¼ŒæŠŠå¯¹åº”åŒ¹é…çš„å•è¯å­—æ¯ï¼Œç”ŸæˆnodeèŠ‚ç‚¹ï¼Œå› ä¸ºä¸€ç»„nodeé›†åˆæœ€å¤šæ˜¯26ä¸ªå­—æ¯ï¼ŒnodeèŠ‚ç‚¹æ‹‰å‡ºæ¥çš„é“¾è·¯ä¾æ—§æ˜¯æœ€å¤š26ä¸ªå­—æ¯ï¼Œä»¥æ­¤ç±»æ¨å½¢æˆé“¾è¡¨æ ‘ç»“æ„ã€‚

### 3. å•è¯ä½¿ç”¨

æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨åˆ°ç»§æ‰¿ `CompletionContributor` çš„å®ç°ç±»ï¼Œæ¥ç›‘å¬ç”¨æˆ·è¾“å…¥çš„å±æ€§å­—æ¯ä¿¡æ¯ï¼Œæ¯ä¸€ä¸ªè¾“å…¥éƒ½ä¼šè°ƒç”¨åˆ°è¿™ä¸ªå®ç°ç±»ä¸­ï¼Œä¹‹ååœ¨å®ç°ç±»é‡Œç´¢å¼•åˆ°åŒ¹é…çš„å•è¯åˆ—è¡¨åé¦ˆç»™ç”¨æˆ·ã€‚

#### 3.1 å¯åŠ¨ç›‘å¬

**cn.bugstack.guide.idea.plugin.action.RemindCompletionContributor**

```java
public RemindCompletionContributor() {
    IWordManageService wordManageService = ApplicationManager.getApplication().getService(WordManageServiceImpl.class);
    
    CompletionProvider<CompletionParameters> provider = new DefaultCompletionProvider(wordManageService);
    
    extend(CompletionType.BASIC, psiElement(PsiIdentifier.class).withParent(PsiLocalVariable.class), provider);
    extend(CompletionType.BASIC, psiElement(PsiIdentifier.class).withParent(PsiMethod.class), provider);
    extend(CompletionType.BASIC, psiElement(PsiIdentifier.class).withParent(PsiField.class), provider);
    extend(CompletionType.BASIC, psiElement(PsiIdentifier.class).withParent(PsiParameter.class), provider);
}
```

- é¦–å…ˆè¿™é‡Œéœ€è¦æŠŠå¤„ç†å•è¯æä¾›è¾…åŠ©è¾“å…¥æé†’çš„æ“ä½œï¼Œæ³¨å…¥åˆ° extend ä¸­ï¼Œç›®å‰è¿™ä¸ªæ”¯æŒ Java è¾“å…¥ï¼Œä¹Ÿå¯ä»¥æ‰©å±•æˆå…¶ä»–è¯­è¨€çš„è¾“å…¥è¾…åŠ©æé†’ã€‚

#### 3.2 å•è¯ç´¢å¼•

è¿™é‡Œçš„ç´¢å¼•æ˜¯ä¸€ä¸ªç»§æ‰¿ `CompletionProvider` çš„å®ç°ç±»ï¼Œé€šè¿‡å¯¹ `addCompletions` çš„æ‰©å±•ï¼Œå®Œæˆå¯¹å•è¯çš„ç´¢å¼•æ“ä½œã€‚

**ç´¢å¼•å•è¯**

**cn.bugstack.guide.idea.plugin.domain.service.WordManageServiceImpl**

```java
@Override
public List<Node> searchPrefix(String prefix) {
    Node root = wordsTree;
    char[] chars = prefix.toCharArray();
    StringBuilder sb = new StringBuilder();
    for (char aChar : chars) {
        int charIndex = aChar - 'a';
        if (charIndex > root.slot.length || charIndex < 0 || root.slot[charIndex] == null) {
            return Collections.emptyList();
        }
        sb.append(aChar);
        root = root.slot[charIndex];
    }
    ArrayList<Node> list = new ArrayList<>();
    if (root.prefix != 0) {
        for (int i = 0; i < root.slot.length; i++) {
            if (root.slot[i] != null) {
                char c = (char) (i + 'a');
                collect(root.slot[i], String.valueOf(sb) + c, list, RESULT_LIMIT);
                if (list.size() >= RESULT_LIMIT) {
                    return list;
                }
            }
        }
    }
    return list;
}
```

- å…¥å‚ `prefix` æ˜¯ç”¨äºè¾“å…¥çš„å•è¯ï¼Œåœ¨ searchPrefix ä¸­æå–å•è¯ä¸­ä¸­çš„å­—æ¯ï¼Œä¾‹å¦‚ï¼šfusï¼Œåˆ™é™†ç»­æå–ä¸‰ä¸ªå­—æ¯ï¼Œä¸€ç›´åˆ°æœ€åä¸€ä¸ªå­—æ¯ `root = root.slot[charIndex];`
- åœ¨ç´¢å¼•åˆ°åŒ¹é…çš„å­—æ¯åï¼ŒæŒ‰ç…§å½“å‰å­—æ¯çš„å¯¹åº” `så¼€å¤´` çš„åˆ—è¡¨ï¼Œå¾ªç¯è·å–åç»­çš„å­—æ¯å¹¶è¿”å›æœ€ç»ˆçš„ç»“æœåˆ—è¡¨ã€‚

### 4. plugin é…ç½®

```xml
<extensions defaultExtensionNs="com.intellij">
    <!-- Add your extensions here -->
    <applicationService serviceImplementation="cn.bugstack.guide.idea.plugin.domain.service.WordManageServiceImpl"/>
    
    <completion.contributor language="JAVA"
                            order="first"
                            implementationClass="cn.bugstack.guide.idea.plugin.action.RemindCompletionContributor"/>
</extensions>
```

- è¿™é‡Œæˆ‘ä»¬éœ€è¦æŠŠå•è¯æ–‡ä»¶æ ‘å¤„ç†å®ç°ç±»å’Œç›‘å¬ç”¨æˆ·çš„å•è¯è¾“å…¥ï¼Œé…ç½®åˆ° extensions ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„å•è¯è¾“å…¥æé†’æ“ä½œäº†ã€‚

## å››ã€æµ‹è¯•éªŒè¯

**å¯åŠ¨æ’ä»¶**

![](https://bugstack.cn/images/article/assembly/assembly-220122-9-01.png)

- åœ¨ Grandle -> Tasks -> intellj -> runIde è¿›è¡Œå¯åŠ¨
- å¯åŠ¨åæ‰“å¼€ä¸€ä¸ªä½ çš„å·¥ç¨‹è¿›è¡Œè¾“å…¥æµ‹è¯•å±æ€§ä¿¡æ¯è¿›è¡Œæµ‹è¯•

**æµ‹è¯•æ’ä»¶**

![](https://bugstack.cn/images/article/assembly/assembly-220122-9-02.png)

- ç°åœ¨å½“ä½ è¾“å…¥ä¸€ä¸ªå•è¯çš„æ—¶å€™ï¼Œå°±å¯ä»¥æŠŠæˆ‘ä»¬å­˜æ”¾å¥½åœ¨æ–‡ä»¶é‡Œçš„å•è¯æé†’ç»™ç”¨æˆ·äº†ã€‚*å¾ˆå¥½ç©å§*

## äº”ã€æ€»ç»“

- åœ¨æœ¬ç« èŠ‚æˆ‘ä»¬å­¦ä¹ åˆ°äº†å¦‚ä½•å»å¤„ç†æ ‘ç»“æ„çš„å•è¯åˆ—è¡¨çš„å­˜æ”¾å’Œè¯»å–ï¼Œå¯¹äºè¿™æ ·çš„æ•°æ®ç»“æ„ä½¿ç”¨å…¶å®ä¸åªæ˜¯åœ¨è¿™é‡Œï¼Œä¹Ÿå¯ä»¥æ”¾åˆ°ä¸€äº›å…¶ä»–æ–‡å­—ç±»çš„è¾…åŠ©è¾“å…¥æé†’ä¸­ã€‚
- æ¥ä¸‹æ¥åˆæ˜¯ä¸€ä¸ªæœ‰å…³ IDEA æ’ä»¶å¼€å‘çš„çŸ¥è¯†ç‚¹ï¼Œå°±æ˜¯æŠŠä¸€äº›æé†’ä¿¡æ¯è‡ªå®šä¹‰å•è¯å’Œæè¿°ï¼Œåé¦ˆç»™ç”¨æˆ·è¾“å…¥ç•Œé¢ä¸­ã€‚
- è¿™äº›å†…å®¹çš„çŸ¥è¯†ç‚¹ä½¿ç”¨ï¼Œéƒ½å¯ä»¥è¢«æˆ‘ä»¬èµ‹èƒ½äºå…¶ä»–åœºæ™¯å¼€å‘ä¸­ï¼Œè¿œè¿œä¸åªæ˜¯è¿™æ ·ä¸€ä¸ªåœºæ™¯ã€‚è€Œè¿™äº›å†…å®¹è™½ç„¶ä¸æ˜¯å¤šæœ‰éš¾åº¦ï¼Œä½†å¦‚æœæ²¡è§è¿‡ã€æ²¡æƒ³è¿‡ã€æ²¡ç”¨è¿‡ï¼Œå°±ä¸€å®šä¸ä¼šæƒ³å¾—åˆ°å¯ä»¥ç”¨ã€‚