---
title: ç¬¬4èŠ‚ï¼šè¯¾ç¨‹å®Œç»“ï¼Œä¸Šçº¿éƒ¨ç½²æ•™ç¨‹
lock: no
---

# ã€Šå¤§è¥é”€å¹³å°ç³»ç»Ÿè®¾è®¡å®ç°ã€‹ - å¼€å‘è¿ç»´ ç¬¬4èŠ‚ï¼šè¯¾ç¨‹å®Œç»“ï¼Œä¸Šçº¿éƒ¨ç½²æ•™ç¨‹

ä½œè€…ï¼šå°å‚…å“¥
<br/>åšå®¢ï¼š[https://bugstack.cn](https://bugstack.cn)

>æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æŠ€æœ¯UPä¸»å°å‚…å“¥ã€‚

ä¸å°‘å°ä¼™ä¼´åœ¨é¢è¯•ä¸­æ€»ä¼šè¢«æé—®ï¼Œä½ çš„å¾®æœåŠ¡æ˜¯å“ªä¸¤å¥—é¡¹ç›®å¯¹æ¥ï¼Œä½ æ˜¯åˆ†å¸ƒå¼ä½“ç°åœ¨å“ªã€‚å¥½åƒè¿™ä¹ˆä¸€é—®ï¼Œå¹³æ—¶åšçš„é¡¹ç›®æ—¢ä¸æ˜¯å¾®æœåŠ¡ï¼Œä¹Ÿä¸æ˜¯åˆ†å¸ƒå¼ï¼Œéƒ½ä¸çŸ¥é“æ€ä¹ˆå›ç­”å•¦ï¼å’‹åŠï¼ï¼ŸğŸ¤”

<div align="center">
    <img src="https://bugstack.cn/images/roadmap/tutorial/road-map-docker-idea-00.png" width="200px">
</div>

**è¿˜æ˜¯åˆ«åšç©å…·é¡¹ç›®äº†ï¼**

è¦è¯´è¿™ç§çº§åˆ«çš„ä¸œè¥¿ï¼Œè¦ä¸æ˜¯åœ¨å…¬å¸é‡ŒçœŸçš„å®è·µè¿‡ï¼Œè¦ä¸æ˜¯è·Ÿç€å°å‚…å“¥å®Œå®Œå…¨å…¨çš„åšè¿‡ã€‚å¦åˆ™è¿˜çœŸæ²¡æœ‰è¿™ç±»ç»éªŒï¼Œå¾ˆå¤šå¸‚é¢çš„CRUDé¡¹ç›®éƒ½æ˜¯ä¸€ä¸ªä¸ªå­¤å²›å•ä½“ï¼Œæ ¹æœ¬æ²¡æœ‰å¾®æœåŠ¡å¯¹æ¥ï¼Œä¹Ÿè°ˆä¸ä¸Šåˆ†å¸ƒå¼æ¶æ„ã€‚æ‰€æœ‰çš„è¿™ç±»ä¸œè¥¿ï¼Œéƒ½æ˜¯çœŸçš„åœ¨èŒåœºå¤šå¹´å®è·µï¼Œæ‰èƒ½ä¸€æ­¥æ­¥å¸¦ç€ä½ å­¦ä¹ æŒæ¡åˆ°ï¼

è¿™æ¬¡ï¼Œæˆ‘æŠŠä¸¤å¥—é¡¹ç›®å®Œæˆäº†å¾®æœåŠ¡å¯¹æ¥ï¼Œåˆ†å¸ƒå¼æ¶æ„éƒ¨ç½²ã€‚ä½ å¯ä»¥å®Œå…¨å…¨å…¨çš„å­¦ä¹ åˆ°è¿™äº›ä¸œè¥¿åˆ°åº•æ˜¯æ€ä¹ˆç©çš„ï¼

>ä¸Šè½¦ï¼Œè¿™æ¬¡é¡¹ç›®åšçš„å¾ˆç¡¬æ ¸ï¼æ–‡æœ«å¯ä»¥è·å–å…¨éƒ¨é¡¹ç›®è¯¾ç¨‹ã€‚

## 1. æ•ˆæœå±•ç¤º

è¿™æ˜¯ä¸€æ¬¡éå¸¸åºå¤§çš„ç³»ç»Ÿå¼€å‘å®è·µï¼Œå­¦ä¹ è¿™æ ·ä¸€å¥—ä¸œè¥¿ï¼Œå¯ä»¥å…¨é¢çš„æé«˜ä¸ªäººç»¼åˆæŠ€æœ¯å®æˆ˜èƒ½åŠ›ã€‚äº†è§£ä¸šåŠ¡ã€æ‡‚å¾—æ¶æ„ã€æåˆ°æ€ç»´ã€é”»ç‚¼ç¼–ç ã€‚ä¸€ä¸ªä¸ªåœºæ™¯çš„è§£å†³æ–¹æ¡ˆï¼Œä¸€ä¸ªä¸ªè®¾è®¡æ¨¡å¼çš„å®è·µè¿ç”¨ã€‚

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-06.png" width="600px">
</div>

- åœ°å€ï¼š[https://openai.gaga.plus/](https://openai.gaga.plus/) - ä¾§è¾¹æ ï¼Œç‚¹å‡»å…‘æ¢ã€è´­ç‰©ã€è¥é”€ã€‚
- è¯´æ˜ï¼šä½ å¯ä»¥ä½“éªŒ OpenAI å…‘æ¢ã€æŠ½å¥–ã€å…‘æ¢ã€ç­¾åˆ°ç­‰å„ä¸ªåŠŸèƒ½ã€‚è¿™äº›ä¹Ÿéƒ½å„ä¸ªäº’è”ç½‘å…¬å¸Cç«¯åœºæ™¯çš„äº§å“è®¾è®¡ã€‚

>æ¥ä¸‹æ¥æ˜¯ä¸€æ•´å¥—çš„é¡¹ç›®çš„éƒ¨ç½²æ‰§è¡Œè¿‡ç¨‹ï¼Œå…¬å¸ä¸­å¤§å®¶ä¸Šçº¿ï¼Œå¯¹äºä¸­å¤§å‹é¡¹ç›®å’Œéœ€æ±‚ï¼Œä¹Ÿä¼šåˆ—å‡ºæ˜ç¡®çš„ä¸Šçº¿æ‰§è¡Œæ­¥éª¤ã€‚

## 2. éƒ¨ç½²ç»“æ„

### 2.1 å¾®æœåŠ¡&åˆ†å¸ƒå¼

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-07.png" width="750px">
</div>

- å¾®æœåŠ¡ï¼šä¸€å¥— OpenAi chatgpt-data åç«¯åº”ç”¨ï¼Œä¸€å¥— big-market åç«¯åº”ç”¨ï¼Œä¸¤å¥—å¾®æœåŠ¡ã€‚
- åˆ†å¸ƒå¼ï¼šNginx è´Ÿè½½ httpï¼Œå¤§è¥é”€è´Ÿè½½ rpcï¼Œæ”¯æŒå¤šå®ä¾‹éƒ¨ç½²ï¼Œmq æ¶ˆæ¯è§£è€¦æµç¨‹ã€xxl-job ä»»åŠ¡é©±åŠ¨ã€redis ç¼“å­˜é¢„çƒ­æ•°æ®ã€‚åˆ†åº“åˆ†è¡¨ã€canal å®Œæˆæ•°æ®çš„åˆ†ç¦»å’Œèšåˆã€‚

### 2.2 åˆ†å±‚éƒ¨ç½²å…³ç³»

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-08.png" width="750px">
</div>

- ä»åº•å±‚å¾€ä¸Šï¼Œä¾æ¬¡æ˜¯[æœåŠ¡å™¨ï¼ˆ4c16gï¼‰](http://618.gaga.plus/)ã€éƒ¨ç½²ç¯å¢ƒã€åº”ç”¨ç¯å¢ƒã€ä¸Šçº¿é…ç½®ã€åº”ç”¨æ„å»ºã€å‚æ•°é…ç½®ï¼Œä¹‹åå°±æ˜¯æ‰§è¡Œåº”ç”¨å¯åŠ¨å•¦ã€‚
- æ¥ä¸‹æ¥æˆ‘ä»¬çš„éƒ¨ç½²ï¼Œä¹Ÿä¼šåšè¿™äº›æ“ä½œã€‚

## 3. ç¯å¢ƒè¯‰æ±‚

>ä¸ºäº†æ–¹ä¾¿å¤§å®¶å®Œæˆé¡¹ç›®çš„éƒ¨ç½²ï¼Œè¿™é‡Œé‡‡ç”¨äº† Linux æœåŠ¡å™¨ç›´æ¥æ­å»ºæ„å»ºç¯å¢ƒçš„æ–¹å¼è¿›è¡Œå¤„ç†ã€‚åœ¨ä»¥ä¸‹æ“ä½œä¸­ä½ å¯ä»¥æŠŠ Linux å½“åšä¸€å°æœ¬åœ°çš„ç”µè„‘è¿›è¡Œä½¿ç”¨ã€‚åªä¸è¿‡éƒ½æ˜¯å‘½ä»¤æ–¹å¼æ“ä½œã€‚

æœ¬èŠ‚éœ€è¦åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œéƒ¨ç½²åˆ†å¸ƒå¼æŠ€æœ¯æ ˆï¼ˆnacosã€mysqlã€redisã€xxl-jobã€rabbitmqã€Zookeeperç­‰ï¼‰ï¼Œ2å¥— big-market å¤§è¥é”€åå°ï¼ˆrpc è´Ÿè½½ï¼‰ã€1å¥— chatgpt-data åç«¯ã€1å¥— chatgpt-web å‰ç«¯ã€‚

1. æ¨è `4c16g` æœåŠ¡å™¨ 3ä¸ªæœˆï¼šhttps://618.gaga.plus - `158å…ƒ(ç»­è´¹åŒä»·)`ï¼Œè¿™ä¸ªä»·æ ¼æ¯”è¾ƒé€‚åˆä¸´æ—¶åšæµ‹è¯•éªŒè¯ã€‚ã€å ç”¨åœ¨12g+ã€‘
2. dockerã€portainer - `åœ¨ bugstack.cn è·¯ä¹¦ä¸­æœ‰å®‰è£…æ•™ç¨‹`
3. jdk 1.8ã€maven 3.8.8ã€gitï¼Œè¯¾ç¨‹æä¾›äº†å®‰è£…éƒ¨ç½²è§†é¢‘
4. Gitä½¿ç”¨æ•™ç¨‹ï¼š[https://bugstack.cn/md/road-map/git.html](https://bugstack.cn/md/road-map/git.html)
5. ç”³è¯·å¾®ä¿¡å…¬ä¼—å·æµ‹è¯•å¹³å°ï¼š[https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&t=sandbox/index](https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&t=sandbox/index) - éœ€è¦ç”³è¯·ã€‚
6. æ™ºè°±AIï¼Œç”³è¯·Keyï¼š[https://bigmodel.cn/usercenter/apikeys](https://bigmodel.cn/usercenter/apikeys) - OpenAI é¡¹ç›®ä¼šä½¿ç”¨åˆ°

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-01.png" width="600px">
</div>

- è„šæœ¬ï¼š[https://gitcode.net/KnowledgePlanet/big-market/big-market-dev-ops](https://gitcode.net/KnowledgePlanet/big-market/big-market-dev-ops)
- è¯´æ˜ï¼šè¿™é‡Œå°å‚…å“¥å·²ç»åˆ†å„ä¸ªé˜¶æ®µç»™å¤§å®¶æä¾›å¥½äº†éƒ¨ç½²è„šæœ¬ï¼Œä½ å¯ä»¥å‚ç…§ä½¿ç”¨ã€‚åœ¨ mysql åŒ…ä¸‹ï¼Œå·²ç»æä¾›äº†æœ¬æ¬¡é¡¹ç›®éƒ¨ç½²æ‰€éœ€çš„ sql åˆå§‹åŒ–æ–‡ä»¶ã€‚

**docker é•œåƒæ¨è**

```java
# æ¸…ç©º /etc/docker/daemon.json æ–‡ä»¶ï¼Œå‡†å¤‡å†™å…¥æ–°å†…å®¹
echo >/etc/docker/daemon.json

# ä½¿ç”¨ cat å‘½ä»¤å°†ä»¥ä¸‹å†…å®¹å†™å…¥ /etc/docker/daemon.json æ–‡ä»¶
# é…ç½® Docker é•œåƒåŠ é€Ÿå™¨ï¼Œä½¿ç”¨å¤šä¸ªé•œåƒæºæ¥æé«˜é•œåƒä¸‹è½½é€Ÿåº¦
cat >/etc/docker/daemon.json <<EOF
{
  "registry-mirrors": [
    "https://dc.j8.work",
    "https://proxy.1panel.live",
    "https://dockerproxy.cn",
    "https://hub1.nat.tf",
    "https://dockerproxy.1panel.live",
    "https://docker.awsl9527.cn",
    "https://docker.vpszj.top"
  ]
}
EOF

# é‡å¯ Docker æœåŠ¡ä»¥ä½¿é…ç½®ç”Ÿæ•ˆ
systemctl restart docker
```

- åœ°å€ï¼š[https://status.1panel.top/status/docker](https://status.1panel.top/status/docker) - è¿™é‡Œç”±1panelæä¾›äº†å¯ç”¨çš„é•œåƒåœ°å€ã€‚
- è¯´æ˜ï¼šå¦‚æœä½ å¸Œæœ›ä»å®˜ç½‘æ‹‰å–é•œåƒï¼Œé‚£ä¹ˆå¯ä»¥åšä»¥ä¸Šçš„é•œåƒé…ç½®ã€‚

## 4. ç¯å¢ƒé…ç½®

æ³¨æ„ï¼šæ‰§è¡Œè„šæœ¬å‰ï¼Œç¡®ä¿ä½ å·²ç»å®Œæˆäº† linux æœåŠ¡å™¨çš„è´­ä¹°ï¼Œdockerã€portainer ç¯å¢ƒçš„å®‰è£…ã€‚è¿™æ ·ä½ æ‰èƒ½æ‰§è¡Œ docker-compose-environment.yml æ–‡ä»¶å®‰è£…ç¯å¢ƒã€‚

### 1. ä¸Šä¼ è„šæœ¬

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-02.png" width="600px">
</div>

- æ¨èä½¿ç”¨ [termius](https://termius.com/) è¿æ¥äº‘æœåŠ¡å™¨ï¼Œåœ¨æ ¹ç›®å½•åˆ›å»º `/dev-ops` æ–‡ä»¶å¤¹ã€‚å†é€šè¿‡ SFTP å·¥å…·ï¼ŒæŠŠæœ¬åœ°çš„éƒ¨ç½²è„šæœ¬ä¸Šä¼ åˆ°æ–‡ä»¶å¤¹ä¸­ã€‚

### 2. æ‰§è¡Œè„šæœ¬

```shell
cd /dev-ops
# æ–¹å¼1
docker-compose -f docker-compose-environment.yml up -d

# æ–¹å¼2        
docker-compose -f docker-compose-environment-xfg-studio.yml up -d
```

- æ–¹å¼1ï¼›éœ€è¦é…ç½®å¯ç”¨çš„ docker é•œåƒï¼Œæ‰èƒ½æ‹‰å–ã€‚
- æ–¹å¼2ï¼›æ˜¯å°å‚…å“¥å‡†å¤‡å¥½çš„é•œåƒåœ°å€ï¼Œé€Ÿåº¦æ›´å¿«ä¸€äº›ã€‚å¦‚æœæ–¹å¼2ä¸å¯ç”¨äº†ï¼Œå¯ä»¥ç»§ç»­ç”¨æ–¹å¼1

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-03.png" width="950px">
</div>

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-05.png" width="750px">
</div>

```java
- nacosï¼šhttp://117.72.90.238:8848/nacos - ã€Œè´¦å¯†ï¼šnacos/nacosã€
- rabbitmqï¼šhttp://117.72.90.238:15672/ - ã€Œè´¦å¯†ï¼šadmin/12qw!@QWã€
- redis-adminï¼šhttp://117.72.90.238:8081/ - ã€Œè´¦å¯†ï¼šadmin/12qw!@QWã€
- xxl-job-adminï¼šhttp://117.72.90.238:9090/xxl-job-admin - ã€Œè´¦å¯†ï¼šroot/12qw!@QWã€
- phpmyadminï¼šhttp://117.72.90.238:8899/ - ã€Œè´¦å¯†ï¼šroot/12qw!@QWã€
```

- éƒ¨ç½²å®Œæˆåï¼Œå¯ä»¥ä¾æ¬¡è®¿é—® phpmyadminã€rabbitmqã€redis-adminã€xxl-job-adminã€nacos è¿™äº›ç®¡ç†åå°ã€‚æ£€æŸ¥æ•°æ®åº“è¡¨æ˜¯å¦å·²ç»å…¨éƒ¨åˆå§‹åŒ–å®Œæˆã€‚
- è´¦å·ã€å¯†ç ã€IPï¼Œä½ å¯ä»¥æŒ‰ç…§è‡ªå·±çš„è¿›è¡Œä¿®æ”¹ï¼Œå¯†ç æ˜¯é…ç½®åœ¨ docker-compose-environment/environment-xfg-studio è„šæœ¬ä¸­ã€‚

## 5. åº”ç”¨æ„å»º

åœ¨ /dev-ops/ ç›®å½•ä¸‹åˆ›å»ºåˆ›å»º gitcode æ–‡ä»¶å¤¹ï¼Œé‡Œé¢åˆ†åˆ«æ‹‰å–ä»£ç ï¼›

### 1. big-market å¤§è¥é”€åç«¯

#### 1.1 å‚æ•°é…ç½®

1. application.yml ä¿®æ”¹ `active: prod` ä¸ºä¸Šçº¿å‚æ•°
2. application-prod.yml ä¸ºä¸Šçº¿éƒ¨ç½²é…ç½®ï¼Œå…¶ä¸­ä¸€äº›IPçš„åœ°æ–¹è¢«åç§°æ›¿ä»£ï¼Œå¦‚ mysqlã€zookeeperç­‰ï¼Œæ˜¯å› ä¸ºè¿™äº›IPå¯ä»¥åœ¨ docker-compose éƒ¨ç½²ä¸­ï¼Œåœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œèµ°åŒä¸€ä¸ªç½‘ç»œï¼Œè¿›è¡Œå†…ç½‘é€šä¿¡ã€‚
3. docker-compose-app.yml big-market æ³¨æ„é…ç½® rabbitmq åœ°å€ä¸ºä½ çš„æœåŠ¡å™¨å…¬ç½‘ipåœ°å€ï¼Œå¹¶å¼€æ”¾ç«¯å£ 5672
4. docker-compose-app.yml é…ç½®äº†2å¥— big-market åº”ç”¨å®ä¾‹ï¼ˆä¸åŒç«¯å£ï¼‰è¿›è¡Œè´Ÿè½½ã€‚
5. gitcode æ£€å‡ºä»£ç ï¼Œå¯å‚è€ƒæ–‡ç« å¼€å¤´æåˆ°çš„ Git ä½¿ç”¨æ•™ç¨‹ã€‚

#### 1.2 æ„å»ºè„šæœ¬

```shell
cd /dev-ops/gitcode/
git clone -b docker-images-v5.0 https://gitcode.net/KnowledgePlanet/big-market/big-market.git

cd big-market/
mvn clean install

cd big-market-app
chmod +x build.sh
./build.sh
```

### 2. chatgpt-data OpenAI åç«¯

#### 2.1 å‚æ•°é…ç½®

1. application.yml ä¿®æ”¹ `active: prod` ä¸ºä¸Šçº¿å‚æ•°
2. application-prod.yml ä¸ºä¸Šçº¿éƒ¨ç½²é…ç½®ï¼Œå…¶ä¸­ä¸€äº›IPçš„åœ°æ–¹è¢«åç§°æ›¿ä»£ï¼Œå¦‚ mysqlã€nacosï¼Œæ˜¯å› ä¸ºè¿™äº›IPå¯ä»¥åœ¨ docker-compose éƒ¨ç½²ä¸­ï¼Œåœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œèµ°åŒä¸€ä¸ªç½‘ç»œï¼Œè¿›è¡Œå†…ç½‘é€šä¿¡ã€‚
3. chatgpt.sdk.config.enabledã€wxpay.config.enabledï¼Œå¯ä»¥éƒ½é…ç½®falseï¼Œå¦‚æœä½ æœ‰ chatgpt å’Œ å¾®ä¿¡æ”¯ä»˜é‚£ä¹ˆå¯ä»¥é…ç½®ã€‚æ˜Ÿçƒä¸­è¿˜æœ‰å…³äºæ”¯ä»˜å®æ²™ç®±ã€è“å…”æ”¯ä»˜ï¼Œä¹Ÿå¯ä»¥æ›´æ¢å¯¹æ¥ã€‚

#### 2.2 æ„å»ºè„šæœ¬

```shell
cd /dev-ops/gitcode/
git clone -b docker-images-v5.0 https://gitcode.net/KnowledgePlanet/chatgpt/chatgpt-data.git

cd chatgpt-data/
mvn clean install

cd chatgpt-data-app
chmod +x build.sh
./build.sh
```

### 3. chatgpt-web OpenAI å‰ç«¯

#### 3.1 é…ç½®

**index.tsx**

```java
const openAIApiHostUrl = "http://117.72.90.238:8091";
const bigMarketApiHostUrl = "http://117.72.90.238:8092";
```

- ä¿®æ”¹ä¸ºä½ çš„IP:PORTåœ°å€ï¼Œå¦‚æœä½ æœ‰åŸŸåä¹Ÿå¯ä»¥ç»Ÿä¸€é…ç½® https çš„åŸŸååœ°å€ï¼Œä½†è¦å…¨éƒ¨éƒ½æ˜¯ç»Ÿä¸€çš„ã€‚é¿å…è·¨åŸŸé—®é¢˜ã€‚

#### 3.2 è„šæœ¬

```shell
cd /dev-ops/gitcode/
git clone -b docker-images-v5.0 https://gitcode.net/KnowledgePlanet/chatgpt/chatgpt-web.git

chmod +x build.sh
./build.sh
```

## 6. åº”ç”¨éƒ¨ç½²

### 1. è„šæœ¬å¯åŠ¨

ä»¥ä¸‹ä¸ºåº”ç”¨éƒ¨ç½² docker compose è„šæœ¬ï¼Œéƒ¨ç½²çš„æ—¶å€™è¿›å…¥linuxæ­¤è„šæœ¬æ‰€åœ¨æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œ `docker-compose -f docker-compose-app.yml up -d` å³å¯ã€‚

```java
version: '3.8'
# å‘½ä»¤æ‰§è¡Œ docker-compose -f docker-compose-app.yml up -d
services:
  # å¤§è¥é”€åç«¯
  big-market-app-01:
    image: fuzhengwei/big-market-app:5.1
    container_name: big-market-app-01
    restart: always
    ports:
      - "8092:8092"
    environment:
      - TZ=PRC
      - SERVER_PORT=8092
      - APP_CONFIG_API_VERSION=v1
      - APP_CONFIG_CROSS_ORIGIN=*
      - ZOOKEEPER_SDK_CONFIG_ENABLE=false
      - SPRING_RABBITMQ_ADDRESSES=117.72.90.238
    volumes:
      - ./log:/data/log
    networks:
      - my-network
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  # å¤§è¥é”€åç«¯
  big-market-app-02:
    image: fuzhengwei/big-market-app:5.1
    container_name: big-market-app-02
    restart: always
    ports:
      - "8093:8093"
    environment:
      - TZ=PRC
      - SERVER_PORT=8093
      - APP_CONFIG_API_VERSION=v1
      - APP_CONFIG_CROSS_ORIGIN=*
      - ZOOKEEPER_SDK_CONFIG_ENABLE=false
      - SPRING_RABBITMQ_ADDRESSES=117.72.90.238
    volumes:
      - ./log:/data/log
    networks:
      - my-network
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  # OpenAI åº”ç”¨åç«¯
  chatgpt-data-app:
    image: fuzhengwei/chatgpt-data-app:5.1
    container_name: chatgpt-data-app
    ports:
      - "8091:8091"
    environment:
      - TZ=PRC
      - SERVER_PORT=8091
      - APP_CONFIG_API_VERSION=v1
      - APP_CONFIG_CROSS_ORIGIN=*
      - APP_CONFIG_LIMIT_COUNT=3
      - APP_CONFIG_WHITE_LIST=ojbZUv18lbmriaTjcCWBYkOrSbHA
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=12qw!@QW
      - SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/openai?useUnicode=true&characterEncoding=utf8&autoReconnect=true&zeroDateTimeBehavior=convertToNull&serverTimezone=UTC&useSSL=true
      - WX_CONFIG_ORIGINALID=gh_e067c267e056
      - WX_CONFIG_APPID=wx5a228ff69e28a91f
      - WX_CONFIG_TOKEN=b8b6
      - CHATGPT_SDK_CONFIG_ENABLED=false
      - CHATGPT_SDK_CONFIG_API_HOST=https://service-d6wuqy4n-1320869466.cd.apigw.tencentcs.com/
      - CHATGPT_SDK_CONFIG_API_KEY=sk-cVvbudeJq3yQUvcyCeBeB97253C146BaAaC94d70D2890b8e
      - CHATGLM_SDK_CONFIG_ENABLED=true
      - CHATGLM_SDK_CONFIG_API_HOST=https://open.bigmodel.cn/
      - CHATGLM_SDK_CONFIG_API_KEY=96b1fb042a0b51f334ecfdb28ef95837.6pgWXziv5CdbJdGP
    volumes:
      - ./log:/data/log
    networks:
      - my-network
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    restart: always

  # OpenAI åº”ç”¨å‰ç«¯
  chatgpt-web-app:
    container_name: chatgpt-web-app
    image: fuzhengwei/chatgpt-web-app:5.1
    ports:
      - "3002:3002"
    networks:
      - my-network
    restart: always

networks:
  my-network:
    driver: bridge
```

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-04.png" width="950px">
</div>

- æ³¨æ„ï¼š`SPRING_RABBITMQ_ADDRESSES=117.72.90.238`ï¼Œéœ€è¦é…ç½®äº‘æœåŠ¡å™¨IPåœ°å€ï¼Œå¹¶å¼€æ”¾ RabbitMQ ç«¯å£ã€‚
- æ‰§è¡Œé¢„çƒ­æ´»åŠ¨ï¼š`http://117.72.90.238:8092/api/v1/raffle/activity/armory?activityId=100401`
- æœ¬èº«å¤§è¥é”€è¿˜æœ‰ä¸€ä¸ªåå°ï¼Œä½†æœåŠ¡å™¨å¯èƒ½ä¸å¤Ÿï¼Œå¦‚æœä¸éƒ¨ç½²åå°ï¼Œä¸åšæ´»åŠ¨ä¸Šæ¶ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡æ‰§è¡Œé¢„çƒ­æ´»åŠ¨æ¥å£å®Œæˆæ´»åŠ¨é¢„çƒ­ã€‚
- æ³¨æ„å¾®ä¿¡é…ç½®

```java
- WX_CONFIG_ORIGINALID=gh_e067c267e056
- WX_CONFIG_APPID=wx5a228ff69e28a91f
- WX_CONFIG_TOKEN=b8b6
```

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-11.png" width="950px">
</div>
- å…¨éƒ¨æ›´æ¢ä¸ºä½ çš„é…ç½®ä¿¡æ¯ã€‚æ³¨æ„ï¼Œæ¥å£é…ç½®ä¿¡æ¯ï¼Œéœ€è¦åœ¨æœåŠ¡å¯åŠ¨åé…ç½®ã€‚


### 2. natapp å¯åŠ¨ - æ— è‡ªå·±åŸŸå

#### 2.1 è´­ä¹°éš§é“

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-09.png" width="950px">
</div>

```java
[default]
authtoken=bcffa08ea0a7dde4      #å¯¹åº”ä¸€æ¡éš§é“çš„authtokenï¼Œä½ éœ€è¦æ›´æ¢ä¸ºä½ çš„ã€‚å¦åˆ™ä¸èƒ½æ­£å¸¸å¯åŠ¨ã€‚
clienttoken=                    #å¯¹åº”å®¢æˆ·ç«¯çš„clienttoken,å°†ä¼šå¿½ç•¥authtoken,è‹¥æ— è¯·ç•™ç©º,
log=none                        #log æ—¥å¿—æ–‡ä»¶,å¯æŒ‡å®šæœ¬åœ°æ–‡ä»¶, none=ä¸åšè®°å½•,stdout=ç›´æ¥å±å¹•è¾“å‡º ,é»˜è®¤ä¸ºnone
loglevel=ERROR                  #æ—¥å¿—ç­‰çº§ DEBUG, INFO, WARNING, ERROR é»˜è®¤ä¸º DEBUG
http_proxy=                     #ä»£ç†è®¾ç½® å¦‚ http://10.123.10.10:3128 éä»£ç†ä¸Šç½‘ç”¨æˆ·è¯·åŠ¡å¿…ç•™ç©º
```

- æ‰“å¼€ natapp/config.ini æ–‡ä»¶ï¼Œå¤åˆ¶ authtoken æ›¿æ¢ä¸ºä½ çš„ã€‚

#### 2.2 æ‰§è¡Œå¯åŠ¨

```java
[root@lavm-snw6pd3z62 chatgpt-web]# cd /dev-ops/
[root@lavm-snw6pd3z62 dev-ops]# ls
canal          docker-compose-app.yml                     gitcode  kibana    maven   nginx       redis
canal-adapter  docker-compose-environment-xfg-studio.yml  grafana  log       mysql   prometheus
curl           docker-compose-environment.yml             java     logstash  natapp  rabbitmq
[root@lavm-snw6pd3z62 dev-ops]# cd natapp/
[root@lavm-snw6pd3z62 natapp]# ./natapp 
```

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-10.png" width="550px">
</div>

- å¯åŠ¨ Natapp ç©¿é€ç¨‹åºï¼Œä¸»è¦æ˜¯å› ä¸ºå¾®ä¿¡å…¬ä¼—å·é…ç½®ï¼Œéœ€è¦åŸŸåã€‚å¦‚æœä½ æ²¡æœ‰åŸŸåå°±æŒ‰ç…§è¿™ä¸ªæ–¹å¼ï¼Œå¦‚æœæœ‰åŸŸåï¼Œå¯ä»¥èµ°è‡ªå·±çš„åŸŸåã€‚
- åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°é…ç½® URL éªŒç­¾åœ°å€ï¼š[https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&t=sandbox/index](https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&t=sandbox/index) é…ç½®åœ°å€ï¼š`http://xfg-studio.natapp1.cc/api/v1/wx/portal/wxad979c0307864a66` - æ›´æ¢ä¸ºä½ çš„ natapp å†…ç½‘ç©¿é€åœ°å€ã€‚

### 3. Nginx é…ç½® - æœ‰è‡ªå·±åŸŸå

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-12.png" width="550px">
</div>

- åŸŸåï¼šéœ€è¦è´­ä¹°ï¼Œå„ä¸ªäº‘æœåŠ¡å™¨å‚å•†ï¼Œéƒ½å¯ä»¥è´­ä¹°åŸŸåã€‚
- sslï¼šåœ¨ bugstack.cn è·¯ä¹¦ä¸­æœ‰è®²è§£å¦‚ä½•é…ç½®å…è´¹ sslã€‚
- åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°é…ç½® URL éªŒç­¾åœ°å€ï¼š[https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&t=sandbox/index](https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&t=sandbox/index) é…ç½®åœ°å€ï¼š`http://api-test.gaga.plus/api/v1/wx/portal/wxad979c0307864a66` - æ›´æ¢ä¸ºä½ çš„åŸŸååœ°å€ã€‚

## 7. åº”ç”¨è®¿é—®

åœ°å€ï¼š[http://117.72.90.238:3002/](http://117.72.90.238:3002/) - `æ›´æ¢ä¸ºä½ çš„IPåœ°å€`

<div align="center">
    <img src="https://bugstack.cn/images/article/project/big-market/big-market-dev-ops-5-13.png" width="550px">
</div>

> ç™»å½•ä¹‹åï¼Œä½ å°±å¯ä»¥æ„‰å¿«çš„ç©è€å•¦ï¼
