---
title: ç¬¬3èŠ‚ï¼šå®Œå–„å®ç°å„ç±»å¸¸ç”¨æ¥å£
pay: https://t.zsxq.com/0e00sZUOu
---

# ã€ŠChatGPT å¾®æœåŠ¡åº”ç”¨ä½“ç³»æ„å»ºã€‹ - chatgpt-sdk ç¬¬3èŠ‚ï¼šå®Œå–„å®ç°å„ç±»å¸¸ç”¨æ¥å£

ä½œè€…ï¼šå°å‚…å“¥
<br/>åšå®¢ï¼š[https://bugstack.cn](https://bugstack.cn)

>æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„

- **æœ¬ç« éš¾åº¦**ï¼šâ˜…â˜…â˜…â˜†â˜†
- **æœ¬ç« é‡ç‚¹**ï¼šé‰´äºåœ¨ chatgpt-sdk çš„ç¬¬2èŠ‚å·²ç»é€šè¿‡æ‰‹æŠŠæ‰‹çš„æ–¹å¼å¸¦ç€å¤§å®¶åšäº†ä¸€æ•´å¥—æ¥å£çš„è®¾è®¡å’Œå¼€å‘ï¼Œæ‰€ä»¥æœ¬ç« ç»“åˆå‰é¢çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­å®Œå–„æ‰€æœ‰å¸¸ç”¨çš„æ¥å£äº†ã€‚
- **è¯¾ç¨‹è§†é¢‘**ï¼š[https://t.zsxq.com/0eZo0s8q1](https://t.zsxq.com/0eZo0s8q1)

## ä¸€ã€æœ¬ç« è¯‰æ±‚

ChatGPT å®˜ç½‘é™¤äº†æä¾›äº†ä¸Šä¸€ç« å·²å®ç°çš„é—®ç­”æ¥å£ï¼Œå…¶å®è¿˜æœ‰å¾ˆå¤šæ¥å£å†…å®¹ï¼Œä¹ŸåŒ…æ‹¬é€šè¿‡ä¸€æ®µæ–‡å­—æè¿°å°±å¯ä»¥ç»˜åˆ¶å‡ºå›¾ç‰‡çš„æ“ä½œã€‚ä»¥åŠï¼›`æ–‡æœ¬ä¿®å¤`ã€`å‘é‡è®¡ç®—`ã€`æ–‡ä»¶ä¸Šä¼ /æ£€ç´¢`ã€`è¯­éŸ³è½¬æ–‡å­—`ã€`è¯­éŸ³ç¿»è¯‘`ã€`è´¦å•æŸ¥è¯¢`ã€`æ¶ˆè€—æŸ¥è¯¢`è¿™äº›æ¥å£ã€‚æ‰€ä»¥æœ¬ç« æˆ‘ä»¬å°±æ¥åšä¸€ä¸‹è¿™æ ·çš„å®ç°ã€‚ä»¥åŠå®Œæˆä¸€ä¸ªä¸Šä¸‹æ–‡çš„åº”ç­”éªŒè¯ã€‚

## äºŒã€æµç¨‹è®¾è®¡

æ•´ä¸ªæµç¨‹ä¸ºï¼›æŒ‰ç…§æ•´ä½“çš„ä¼šè¯æ¨¡å‹è®¾è®¡ï¼Œå°è£…æœ¬ç« æ‰€æè¯‰æ±‚çš„æ¥å£å†…å®¹ã€‚

<div align="center">
    <img src="https://bugstack.cn/images/article/project/chatgpt/chatgpt-sdk-03-01.png?raw=true" width="750px">
</div>

- æœ¬ç« çš„å®ç°ä¼šåŸºäºå®˜ç½‘çš„HTTPæ¥å£è¿›è¡Œå°è£…å¤„ç†ï¼Œä½ ä¹Ÿå¯ä»¥æ‰“å¼€å®˜ç½‘æŸ¥çœ‹ï¼š[https://platform.openai.com/docs/api-reference](https://platform.openai.com/docs/api-reference) - å®˜ç½‘ä¸­å¯¹å„ä¸ªä¾‹å­éƒ½æœ‰è°ƒç”¨çš„å…¥å‚å’Œå‡ºå‚ï¼Œéå¸¸æ¸…æ™°ã€‚åç»­ä¹Ÿå¯ä»¥ç»“åˆå®˜ç½‘å†…å®¹åšæ›´æ–°å’Œæ‰©å±•ã€‚ä¾‹å¦‚ï¼›å¾®è°ƒç›¸å…³çš„æ¥å£ä¹Ÿå¯ä»¥å…ˆè‡ªè¡Œæ‰©å±•ã€‚
- åªè¦å¤§å®¶æŠŠè¿™æ ·ä¸€å¥—æ¥å£å°è£…çš„ SDK åšä¸‹æ¥ï¼Œä»¥åä½ å†å°è£…å…¶ä»–å„ç±» API éƒ½æœ‰è‡ªå·±çš„è®¾è®¡æ€è·¯å’Œè½åœ°ç»éªŒäº†ã€‚

## ä¸‰ã€æ–¹æ¡ˆå®ç°

### 1. å·¥ç¨‹ç»“æ„

<div align="center">
    <img src="https://bugstack.cn/images/article/project/chatgpt/chatgpt-sdk-03-02.png?raw=true" width="750px">
</div>

- æ•´ä¸ªå·¥ç¨‹ä¸­åœ¨ IOpenAiApi å®šä¹‰æ¥å£ï¼Œå†æœ‰ OpenAiSession å°è£…æ¥å£æœåŠ¡çš„æ–¹å¼å¯¹å¤–æä¾›ä½¿ç”¨ã€‚
- å¦‚æœä½ åœ¨å‰é¢å…³äºchatgpt-sdkç« èŠ‚ä¸­ç†è§£äº†æ•´ä¸ªæ¨¡å‹ç»“æ„ï¼Œé‚£ä¹ˆä¼šéå¸¸å®¹æ˜“ç†è§£è¿™ä»½æ¥å£è®¾è®¡ã€‚å‰©ä¸‹çš„å°±æ˜¯å¯¹ç…§æ¨¡å‹å¡«å……ä»£ç äº†ã€‚

### 2. ç”Ÿæˆå›¾ç‰‡

æ•´ä¸ªAPIçš„æ¥å£å®ç°éƒ½æ¯”è¾ƒç±»ä¼¼ï¼Œå¤§å®¶ä¼šä¸€ä¸ªï¼ŒåŸºæœ¬ä¹Ÿå°±èƒ½æŒ‰ç…§è¿™ä¸ªæ¥å£ï¼Œä»¥å®˜ç½‘çš„å…¥å‚å’Œå‡ºå‚å°è£…å‡ºä½ éœ€è¦å®ç°çš„æ¥å£äº†ã€‚è¿™é‡Œæ¼”ç¤ºä¸€ä¸ªå›¾ç‰‡ç”Ÿæˆçš„æ¥å£ï¼Œå…¶ä»–çš„å¤§å®¶å¯ä»¥å‚è€ƒæºç æ¥å®ç°ã€‚

#### 2.1 æ¥å£å®šä¹‰

```java
/**
 * ç”Ÿæˆå›¾ç‰‡
 * curl https://api.openai.com/v1/images/generations \
 * -H "Content-Type: application/json" \
 * -H "Authorization: Bearer $OPENAI_API_KEY" \
 * -d '{
 * "prompt": "A cute baby sea otter",
 * "n": 2,
 * "size": "1024x1024"
 * }'
 * <p>
 * {
 * "created": 1589478378,
 * "data": [
 * {
 * "url": "https://..."
 * },
 * {
 * "url": "https://..."
 * }
 * ]
 * }
 *
 * @param imageRequest å›¾ç‰‡å¯¹è±¡
 * @return åº”ç­”ç»“æœ
 */
@POST("v1/images/generations")
Single<ImageResponse> genImages(@Body ImageRequest imageRequest);
```

- å®˜ç½‘ï¼š[https://platform.openai.com/docs/api-reference/images/create](https://platform.openai.com/docs/api-reference/images/create)
- æŒ‰ç…§å®˜ç½‘çš„æ ‡å‡†æ‹†è§£å‡º ImageRequestã€ImageResponse å¯¹è±¡ä¿¡æ¯ã€‚

#### 2.2 æ¥å£å®ç°

**æºç **ï¼š`cn.bugstack.chatgpt.session.defaults.DefaultOpenAiSession#genImages`

```java
/**
 * ç”Ÿæˆå›¾ç‰‡
 *
 * @param imageRequest å›¾ç‰‡æè¿°
 * @return åº”ç­”ç»“æœ
 */
ImageResponse genImages(ImageRequest imageRequest);

@Override
public ImageResponse genImages(ImageRequest imageRequest) {
    return this.openAiApi.genImages(imageRequest).blockingGet();
}
```

- å°è£…å¥½å‚æ•°ï¼Œç›´æ¥ä¼ é€’ç»™ openAiApi å°±å¯ä»¥äº†ã€‚

## å››ã€åŠŸèƒ½éªŒè¯

### 1. ç”Ÿæˆå›¾ç‰‡

**æºç **ï¼š`cn.bugstack.chatgpt.test.ApiTest#test_genImages`

```java
@Test
public void test_genImages() {
    // æ–¹å¼1ï¼Œç®€å•è°ƒç”¨
    ImageResponse imageResponse01 = openAiSession.genImages("ç”»ä¸€ä¸ª996åŠ ç­çš„ç¨‹åºå‘˜");
    log.info("æµ‹è¯•ç»“æœï¼š{}", imageResponse01);
    // æ–¹å¼2ï¼Œè°ƒå‚è°ƒç”¨
    ImageResponse imageResponse02 = openAiSession.genImages(ImageRequest.builder()
            .prompt("ç”»ä¸€ä¸ª996åŠ ç­çš„ç¨‹åºå‘˜")
            .size(ImageEnum.Size.size_256.getCode())
            .responseFormat(ImageEnum.ResponseFormat.B64_JSON.getCode()).build());
    log.info("æµ‹è¯•ç»“æœï¼š{}", imageResponse02);
}
```

**æµ‹è¯•ç»“æœ**

```java
[main] INFO cn.bugstack.chatgpt.test.ApiTest - æµ‹è¯•ç»“æœï¼šImageResponse(data=[Item(url=https://oaidalleapiprodscus.blob.core.windows.net/private/org-fEPRM4BdbSjwYUiVNVME9bqC/user-CEHecrasF8SCsXUnZaPV7xsu/img-Oz0hX9BzkGeDRGRpfk3oVihv.png?st=2023-05-20T09%3A13%3A20Z&se=2023-05-20T11%3A13%3A20Z&sp=r&sv=2021-08-06&sr=b&rscd=inline&rsct=image/png&skoid=6aaadede-4fb3-4698-a8f6-684d7786b067&sktid=a48cca56-e6da-484e-a814-9c849652bcb3&skt=2023-05-19T20%3A56%3A34Z&ske=2023-05-20T20%3A56%3A34Z&sks=b&skv=2021-08-06&sig=lzW6/sD6M43d3IlNBHSd8ajwCZkXCm0pCAn1SVVQUKM%3D, b64Json=null)], created=1684577600)
[main] INFO cn.bugstack.chatgpt.test.ApiTest - æµ‹è¯•ç»“æœï¼šImageResponse(data=[Item(url=null, b64Json=iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAIAAADTED8xAAAAaGVYSWZNTQAqAAAACAACknwAAgAAACkAAAAmkoYAAgAAABgAAABQAAAAAE9wZW5BSS0tMmE1YjRlMjgxNGQwOTYxNTIwZjJlNTdlZDBiYmE0YjIAAE1hZGUgd2l0aCBPcGVuQUkgREFMTC1FAOgnY2cAAQAASURBVHgBACuB1H4B/f38/wAAAAABAAAAAQD...
```

- ä¸¤ç§è¿”å›æ ¼å¼ï¼Œä¸€ç§æ˜¯å›¾ç‰‡çš„åœ°å€ï¼Œå¦å¤–ä¸€ç§æ˜¯Base64çš„æ–¹å¼ã€‚

### 2. ä¸Šä¸‹æ–‡åº”ç­”

è¿™ä¸ªå†…å®¹çš„æ·»åŠ æ˜¯ä¸ºäº†æ–¹ä¾¿å°ç™½ä¼™ä¼´å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬å®ç°çš„APIæ€ä¹ˆè¿›è¡Œå…³è”ä¸Šä¸‹æ–‡çš„ä½¿ç”¨ã€‚ä¸Šä¸‹æ–‡çš„ä½¿ç”¨ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼æ–­å¼€ï¼Œä¸€ç§æ˜¯è®¾å®šå¥½ä¼šè¯çš„è¶…æ—¶æ—¶é—´ï¼Œå¦å¤–ä¸€ç§æ˜¯ç›´åˆ°ä¼šè¯å­—ç¬¦ä¸²è¶…é•¿ï¼Œéœ€è¦å¼€å¯æ–°çš„ä¼šè¯ã€‚æˆ‘ä»¬è¿™é‡Œæš‚æ—¶ä¸åŠ é™åˆ¶ã€‚

**æºç **ï¼š`cn.bugstack.chatgpt.test.ClientTest`

```java
public class ClientTest {

    public static void main(String[] args) {
        // 1. é…ç½®æ–‡ä»¶
        Configuration configuration = new Configuration();
        configuration.setApiHost("https://sdk.xfg.im/");
        configuration.setApiKey("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");
        // æµ‹è¯•æ—¶å€™ï¼Œéœ€è¦å…ˆè·å¾—æˆæƒtokenï¼šhttp://api.xfg.im:8080/authorize?username=xfg&password=123 - æ­¤åœ°å€æš‚æ—¶æœ‰æ•ˆï¼Œåç»­æ ¹æ®è¯¾ç¨‹é¦–é¡µè¯´æ˜è·å–tokenï¼›https://t.zsxq.com/0d3o5FKvc
        configuration.setAuthToken("eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ4ZmciLCJleHAiOjE");

        // 2. ä¼šè¯å·¥å‚
        OpenAiSessionFactory factory = new DefaultOpenAiSessionFactory(configuration);
        OpenAiSession openAiSession = factory.openSession();

        System.out.println("æˆ‘æ˜¯ OpenAI ChatGPTï¼Œè¯·è¾“å…¥ä½ çš„é—®é¢˜ï¼š");

        ChatCompletionRequest chatCompletion = ChatCompletionRequest
                .builder()
                .messages(new ArrayList<>())
                .model(ChatCompletionRequest.Model.GPT_3_5_TURBO.getCode())
                .user("testUser01")
                .build();

        // 3. ç­‰å¾…è¾“å…¥
        Scanner scanner = new Scanner(System.in);
        while (scanner.hasNextLine()) {
            String text = scanner.nextLine();
            chatCompletion.getMessages().add(Message.builder().role(Constants.Role.USER).content(text).build());
            ChatCompletionResponse chatCompletionResponse = openAiSession.completions(chatCompletion);
            chatCompletion.getMessages().add(Message.builder().role(Constants.Role.USER).content(chatCompletionResponse.getChoices().get(0).getMessage().getContent()).build());
            // è¾“å‡ºç»“æœ
            System.out.println(chatCompletionResponse.getChoices().get(0).getMessage().getContent());
            System.out.println("è¯·è¾“å…¥ä½ çš„é—®é¢˜ï¼š");
        }
    }

}
```

- è¿™é‡Œç®€å•çš„å†™äº†ä¸€ä¸ªIOæµï¼Œå…è®¸åœ¨æ§åˆ¶å°è¾“å…¥æ¥å£å¹¶åš ChatGPT çš„åº”ç­”å¤„ç†ã€‚
- å…³è”ä¸Šä¸‹æ–‡çš„å›ç­”ï¼Œéœ€è¦æŠŠæ¯æ¬¡çš„ä¼šè¯ä¿¡æ¯å†ä¼ é€’å› ChatGPT è¯·æ±‚ã€‚`ä½ ä¹Ÿå¯ä»¥å°è¯•åªæŠŠæ¯æ¬¡çš„æé—®ä¿¡æ¯ä¼ é€’å›å»ã€‚è¿™æ ·å¯ä»¥å‡å°‘ä¼ é€’çš„ä¿¡æ¯ï¼Œä½†ä¸èƒ½é‚£ä¹ˆå‡†ç¡®çš„å…³è”ä¸Šä¸‹æ–‡`

**æµ‹è¯•ç»“æœ**

<div align="center">
    <img src="https://bugstack.cn/images/article/project/chatgpt/chatgpt-sdk-03-03.png?raw=true" width="750px">
</div>

- å¦‚å›¾å±•ç¤ºå‡ºæ¥çš„å°±æ˜¯å…³è”ä¸Šä¸‹æ–‡çš„åº”ç­”æ•ˆæœã€‚

## äº”ã€è¯»è€…ä½œä¸š

- ç®€å•ä½œä¸šï¼šå­¦ä¹ æœ¬ç« çš„ä»£ç ï¼Œå®Œæˆæ‰€æœ‰çš„APIå®ç°ã€‚
- å¤æ‚ä½œä¸šï¼šClientTest ä¸Šä¸‹æ–‡æµ‹è¯•ï¼Œåšä¸€ä¸ªå°ä¼˜åŒ–ï¼Œæ€ä¹ˆåœ¨æ²¡æœ‰å¾—åˆ°ä¿¡æ¯åé¦ˆçš„æ—¶å€™ï¼Œåœ¨æ§åˆ¶å°æ‰“å°ã€AI æ­£åœ¨æ€è€ƒ ...ã€‘ä»¥ä¸‹æ˜¯æˆ‘æä¾›ç»™ä½ çš„ä¸€æ®µâ³æ²™æ¼æ•ˆæœä»£ç ï¼Œä½ å¯ä»¥ç”¨åˆ°ä»£ç å®ç°ä¸­ã€‚

```java
char[] spinners = {'â ‡', 'â ‹', 'â ™', 'â ¸', 'â ´', 'â ¦', 'â ‡', 'â ‹'};
int index = 0;
while (true) {
    System.out.print("\r" + spinners[index++ % spinners.length]);
    Thread.sleep(100);
}
```
