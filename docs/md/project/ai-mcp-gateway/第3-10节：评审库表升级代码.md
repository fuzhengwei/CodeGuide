---
title: 【更】第3-10节：评审库表升级代码
pay: https://t.zsxq.com/FxVTE
---

# 《AI MCP Gateway 网关服务系统》第3-10节：评审库表升级代码

作者：小傅哥
<br/>博客：[https://bugstack.cn](https://bugstack.cn)
<br/>视频：[https://t.zsxq.com/PzIhJ](https://t.zsxq.com/PzIhJ)

>沉淀、分享、成长，让自己和他人都能有所收获！😄

## 一、本章诉求

针对升级的库表结构，调整工程代码`基础设施层`（dao、po、mapper），重新设计`领域层值对象`，附带调整InitializeHandler、ToolsListHandler、ToolsCallHandler的数据使用。

本节是一个很好的练习篇，原有的功能、流程、结构都不变，只是把库表升级，之后针对这些数据的时候重新定义对象。所以，这一节我们采用互联网公司中的代码评审方式来讲解变更信息，你可以在这个过程中，对比代码变化，来编写你的代码。也可以在学习文档和视频后，自己来编写。可能在这个过程中会遇到错误，但这些错误会驱动你深入的debug调试，快速的积累核心知识。这节学习透彻了以后，后面的章节将会非常好学习。

git 教程：[https://bugstack.cn/md/road-map/git.html](https://bugstack.cn/md/road-map/git.html)

## 二、流程设计

如图，库表升级对于领域功能的改造；

<div align="center">
	<img src="https://bugstack.cn/images/article/project/ai-mcp-gateway/ai-mcp-gateway-3-10-01.png" width="700px"/>
</div>

- InitializeHandler 旧版是通过网关配置和工具两部分拿到基础信息，新版直接从网关配置拿到即可。
- ToolsListHandler 旧版从 McpGatewayToolConfigVO 定义的工具和映射，拿到 list 数据，之后做的拆分。新版定义了 McpToolConfigVO - 工具部分、McpToolProtocolConfigVO - 协议部分，有工具引入协议信息。
- ToolsCallHandler 这部分增强了查询，通过 gatewayId 网关ID、toolName 工具名称，来获取到当前当前要调用的协议信息。这里查询的是 http 协议。如果对接了更多的协议，这部分要做策略处理。

