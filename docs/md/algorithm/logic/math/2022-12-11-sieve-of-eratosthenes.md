---
title: ç­›é€‰ç´ æ•° SieveOfEratosthenes
lock: need
---

# ã€Šç¨‹åºå‘˜æ•°å­¦ï¼šç­›é€‰ç´ æ•°ã€‹â€”â€” å¦‚ä½•è®¡ç®—100å†…çš„ç´ æ•°ï¼Ÿ

ä½œè€…ï¼šå°å‚…å“¥
<br/>åšå®¢ï¼š[https://bugstack.cn](https://bugstack.cn)
<br/>æºç ï¼š[https://github.com/fuzhengwei/java-algorithms](https://github.com/fuzhengwei/java-algorithms)

> æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„

## ä¸€ã€å‰è¨€

ç´ æ•°åœ¨å°å‚…å“¥å‰é¢çš„æ–‡ç« å…³äº [RSA åŠ å¯†ç®—æ³•](https://bugstack.cn/md/algorithm/logic/math/2022-11-20-primality.html)ä¸­å·²ç»è®²è§£è¿‡å®ƒçš„ä½¿ç”¨åœºæ™¯ã€‚å¯¹äºä¸€ä¸ªç´ æ•°çš„åˆ¤æ–­ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨æŠ˜åŠæ±‚æ¨¡è®¡ç®—æ–¹å¼æ¥åˆ¤æ–­æ˜¯å¦ä¸ºç´ æ•°ã€‚é‚£ä¹ˆå¦‚æœæ˜¯ç»™å®šèŒƒå›´çš„1...Nä¸ªæ•°å­—ï¼Œæ‰¾å‡ºè¿™é‡Œæ‰€æœ‰çš„ç´ æ•°è¦æ€ä¹ˆè®¡ç®—å‘¢ï¼Ÿ

```java
public boolean isPrime(long number) {
    boolean isPrime = number > 0;
    // è®¡ç®—numberçš„å¹³æ–¹æ ¹ä¸ºkï¼Œå¯ä»¥å‡å°‘ä¸€åŠçš„è®¡ç®—é‡
    int k = (int) Math.sqrt(number);
    for (int i = 2; i <= k; i++) {
        if (number % i == 0) {
            isPrime = false;
            break;
        }
    }
    return isPrime;
}
```

è¿™æ ·çš„æ–¹å¼å°±ä¸å¤ªé€‚åˆäºæŠŠæ¯ä¸ªæ•°å­—éƒ½è½®è®­ä¸€éæ•ˆç‡ä¹Ÿä¼šæ¯”è¾ƒä½ã€‚é‚£ä¹ˆæœ¬ç« ä¸­å°å‚…å“¥å°±æ¥åˆ†äº«å¦å¤–ä¸€ç§ç­›é€‰ç´ æ•°çš„è®¡ç®—æ–¹å¼[**åŸƒæ‹‰æ‰˜è‰²å°¼ç­›æ³•**](https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)

## äºŒã€ä»€ä¹ˆæ˜¯åŸƒæ‹‰æ‰˜è‰²å°¼ç­›æ³•

åœ¨æ•°å­¦ä¸­ï¼Œ**Eratosthenes ç­›æ³•**æ˜¯ä¸€ç§å¤è€çš„ç®—æ³•ï¼Œå®ƒå¯ä»¥ç”¨äºæŸ¥æ‰¾ä¸è¶…è¿‡ç»™å®šæé™çš„æ‰€æœ‰ç´ æ•°ã€‚

<div align="center">
    <img src="https://bugstack.cn/images/article/algorithm/logic/sieve-of-eratosthenes-01.png?raw=true" width="550px">
</div>

å®ƒé€šè¿‡ä»ç¬¬ä¸€ä¸ªç´ æ•°2å¼€å§‹ï¼Œå°†æ¯ä¸ªç´ æ•°çš„å€æ•°è¿­ä»£æ ‡è®°ä¸ºåˆæ•°ã€‚ä¹Ÿå°±æ˜¯2çš„ä¸‹ä¸€ä¸ªåˆæ•°æ˜¯4ï¼Œä¹‹åä¾æ¬¡æ˜¯6ã€8ã€10ã€12 ... 100ã€‚å½“è®¡ç®—åˆ°100ä»¥åï¼Œå†æ‰¾å¦å¤–ä¸€ä¸ªç´ æ•°3ï¼Œä»3å¼€å§‹æ‰¾ä¸‹ä¸€ä¸ªåˆæ•°6ã€9...ç›´è‡³ç»“æŸåç»§ç»­å¾ªç¯ã€‚å½“æ‰€æœ‰çš„åˆæ•°éƒ½è¢«æŸ“è‰²åï¼Œå‰©ä½™çš„æ•°å­—å°±æ˜¯æŒ‡å®šèŒƒå›´å†…çš„æ‰€æœ‰ç´ æ•°äº†ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œæ‰¾åˆ°å°äº30ä»¥å†…çš„ç´ æ•°ï¼š`2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30`

- ç¬¬ä¸€ç»„è®¡ç®—2ï¼š2  3  ~~4~~  5  ~~6~~  7 ~~ 8~~ 9  ~~10~~ 11 ~~12~~ 13 ~~14~~ 15 ~~16~~ 17 ~~18~~ 19 ~~20~~ 21 ~~22~~ 23 ~~24~~ 25 ~~26~~ 27 ~~28~~ 29 ~~30~~
- ç¬¬äºŒç»„è®¡ç®—3ï¼š2  3  ~~4~~  5  ~~6~~  7 ~~ 8~~ ~~9~~  ~~10~~ 11 ~~12~~ 13 ~~14~~ ~~15~~ ~~16~~ 17 ~~18~~ 19 ~~20~~ ~~21~~ ~~22~~ 23 ~~24~~ 25 ~~26~~ ~~27~~ ~~28~~ 29 ~~30~~
- ç¬¬ä¸‰ç»„è®¡ç®—5ï¼š2  3  ~~4~~  5  ~~6~~  7 ~~ 8~~ ~~9~~  ~~10~~ 11 ~~12~~ 13 ~~14~~ ~~15~~ ~~16~~ 17 ~~18~~ 19 ~~20~~ ~~21~~ ~~22~~ 23 ~~24~~ 25 ~~26~~ ~~27~~ ~~28~~ 29 ~~30~~

æœ€åå‰©ä½™æ•°å­—å°±éƒ½æ˜¯ç´ æ•°äº†ï¼ŒåŒ…æ‹¬ï¼š 2  3     5     7           11    13          17    19          23                29

## ä¸‰ã€Eratosthenes ç®—æ³•å®ç°

**ç­›é€‰ç®—æ³•**ï¼šâ€”â€” è¿™é‡Œå°å‚…å“¥é¢å¤–åŠ äº†ä¸€äº›è¾…åŠ©ä»£ç *primesMap*ï¼Œç”¨äºæ‰“å°ç»“æœï¼Œæ–¹ä¾¿å¤§å®¶å­¦ä¹ ã€‚

```java
public class SieveOfEratosthenes {

    public List<Integer> sieveOfEratosthenes(int maxNumber) {
        // æ–¹ä¾¿æ‰“å°ç»“æœï¼Œå¯åˆ é™¤æ­¤ä»£ç 
        Map<Integer, List<Integer>> primesMap = new HashMap<>();

        List<Integer> isPrime = new ArrayList<>(maxNumber + 1);
        isPrime.add(0);
        isPrime.add(1);

        List<Integer> primes = new ArrayList<>();
        for (int number = 2; number < maxNumber; number++) {
            if (!isPrime.contains(number)) {
                primes.add(number);
                // æ–¹ä¾¿æ‰“å°ç»“æœï¼Œå¯åˆ é™¤æ­¤ä»£ç 
                primesMap.put(number, new ArrayList<>());

                int nextNumber = number * number;
                while (nextNumber <= maxNumber) {
                    isPrime.add(nextNumber);
                    nextNumber += number;

                    // æ–¹ä¾¿æ‰“å°ç»“æœï¼Œå¯åˆ é™¤æ­¤ä»£ç 
                    primesMap.get(number).add(nextNumber);
                }
            }
        }

        System.out.println("ç­›é€‰ç´ æ•°è¿‡ç¨‹");
        for (Integer key : primesMap.keySet()) {
            System.out.println(key + "ï¼š" + JSON.toJSONString(primesMap.get(key)));
        }

        return primes;

    }

}
```

- ä»¥2å¼€å§‹å¾ªç¯è®¡ç®—ï¼Œä»â€œp*pâ€å¼€å§‹æ ‡è®°â€œpâ€çš„å€æ•°ï¼Œè€Œä¸æ˜¯ä»â€œ2*pâ€å¼€å§‹ã€‚è¿™ä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæ˜¯å› ä¸ºåœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œè¾ƒå°çš„å€æ•°â€œpâ€çš„å°†å·²æ ‡è®°ä¸ºâ€œfalseâ€ã€‚â€”â€” è¿™æ˜¯ä¸€ä¸ªä¼˜åŒ–å¤„ç†ã€‚
- å¤„ç†éå¸¸å¤§çš„æ•°å­—æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æº¢å‡ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥å°†å…¶æ›´æ”¹ä¸ºï¼šè®©`nextNumber=2*number;`â€”â€” ä½ å¯ä»¥å°è¯•å‹æ¦¨ä¸€ä¸‹ã€‚

## ä¸‰ã€Eratosthenes ç®—æ³•æµ‹è¯•

**å•å…ƒæµ‹è¯•**ï¼šè®¡ç®—1-100å†…çš„ç´ æ•°

```java
@Test
public void test_SieveOfEratosthenes() {
    SieveOfEratosthenes sieveOfEratosthenes = new SieveOfEratosthenes();
    List<Integer> primes = sieveOfEratosthenes.sieveOfEratosthenes(100);
    System.out.println("ç´ æ•°ï¼š" + JSON.toJSONString(primes));
}
```

**æµ‹è¯•ç»“æœ**

```java
ç­›é€‰ç´ æ•°è¿‡ç¨‹
2ï¼š[6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102]
3ï¼š[12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,78,81,84,87,90,93,96,99,102]
67ï¼š[]
5ï¼š[30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,105]
7ï¼š[56,63,70,77,84,91,98,105]
71ï¼š[]
73ï¼š[]
11ï¼š[]
13ï¼š[]
79ï¼š[]
17ï¼š[]
19ï¼š[]
83ï¼š[]
23ï¼š[]
89ï¼š[]
29ï¼š[]
31ï¼š[]
97ï¼š[]
37ï¼š[]
41ï¼š[]
43ï¼š[]
47ï¼š[]
53ï¼š[]
59ï¼š[]
61ï¼š[]
ç´ æ•°ï¼š[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97]
```

- åœ¨ HashMap ä¸­ä¿ç•™äº†æ¯ä¸€ä¸ªç´ æ•°åœ¨100å†…å¯¹åº”çš„åˆæ•°ï¼Œä»¥æ­¤ç±»æ¨ä¸æ–­åœ°æŸ¥æ‰¾ã€‚æœ€ç»ˆç­›é€‰åå‰©ä½™çš„æ•°å­—å°±æ˜¯ç´ æ•°ã€‚
- æ•´ä¸ªè®¡ç®—è¿‡ç¨‹çš„æ—¶é—´å¤æ‚åº¦æ˜¯ï¼š`O(n log(log n))`

## äº”ã€å¸¸è§é¢è¯•é¢˜

- å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°å­—æ˜¯å¦ä¸ºç´ æ•°
- å¦‚ä½•è®¡ç®—1-nä¸­æœ‰å¤šå°‘ä¸ªç´ æ•°