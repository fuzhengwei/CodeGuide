---
title: ç¬¬7ç« ï¼šå­—å…¸æ ‘
lock: need
---

# ã€ŠJava æ•°æ®ç»“æ„å’Œç®—æ³•ã€‹ç¬¬7ç« ï¼šå­—å…¸æ ‘

ä½œè€…ï¼šå°å‚…å“¥
<br/>åšå®¢ï¼š[https://bugstack.cn](https://bugstack.cn)

> æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„

## ä¸€ã€å‰è¨€

`Trie çš„å†å²`

å­—å…¸æ ‘ Trie è¿™ä¸ªè¯æ¥è‡ªäº re**trie**valï¼Œäº 1912 å¹´ï¼ŒAxel Thue é¦–æ¬¡æŠ½è±¡åœ°æè¿°äº†ä¸€ç»„å­—ç¬¦ä¸²æ•°æ®ç»“æ„çš„å­˜æ”¾æ–¹å¼ä¸º Trie çš„æƒ³æ³•ã€‚è¿™ä¸ªæƒ³æ³•äº 1960 å¹´ç”± Edward Fredkin ç‹¬ç«‹æè¿°ï¼Œå¹¶åˆ›é€ äº† Trie ä¸€è¯ã€‚*ä½ çœ‹çœ‹ï¼Œå¤šå°‘ç¨‹åºå‘˜ä¸ºäº†ä¸€ä¸ªè¯ã€æ–¹æ³•åã€å±æ€§åï¼Œæƒ³ç ´è„‘è¢‹ï¼*

## äºŒã€å­—å…¸æ ‘æ•°æ®ç»“æ„

åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œå­—å…¸æ ‘(Trie)ä¹Ÿè¢«ç§°ä¸ºâ€å•è¯æŸ¥æ‰¾æ ‘â€œæˆ–â€æ•°å­—æ ‘â€œï¼Œæœ‰æ—¶å€™ä¹Ÿè¢«ç§°ä¸ºåŸºæ•°æ ‘æˆ–å‰ç¼€æ ‘ï¼ˆå› ä¸ºå¯ä»¥é€šè¿‡å‰ç¼€çš„æ–¹å¼è¿›è¡Œç´¢å¼•ï¼‰ã€‚â€”â€” å®ƒæ˜¯ä¸€ç§æœç´¢æ ‘ï¼Œä¸€ç§å·²æ’åºçš„æ•°æ®ç»“æ„ï¼Œé€šå¸¸ç”¨äºå­˜å‚¨åŠ¨æ€é›†æˆ–é”®ä¸ºå­—ç¬¦ä¸²çš„å…³è”æ•°ç»„ã€‚

ä¸äºŒå‰æŸ¥æ‰¾æ ‘ä¸åŒï¼Œé”®ä¸æ˜¯ç›´æ¥ä¿å­˜åœ¨èŠ‚ç‚¹ä¸­ï¼Œè€Œæ˜¯ç”±èŠ‚ç‚¹åœ¨æ ‘ä¸­çš„ä½ç½®å†³å®šã€‚ä¸€ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å­å­™éƒ½æœ‰ç›¸åŒçš„å‰ç¼€ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªèŠ‚ç‚¹å¯¹åº”çš„å­—ç¬¦ä¸²ï¼Œè€Œæ ¹èŠ‚ç‚¹å¯¹åº”ç©ºå­—ç¬¦ä¸²ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸æ˜¯æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æœ‰å¯¹åº”çš„å€¼ï¼Œåªæœ‰å¶å­èŠ‚ç‚¹å’Œéƒ¨åˆ†å†…éƒ¨èŠ‚ç‚¹æ‰€å¯¹åº”çš„é”®æ‰æœ‰ç›¸å…³çš„å€¼ã€‚

![](https://bugstack.cn/images/article/algorithm/trie-01.png)

- è¿™æ˜¯ä¸€ä¸ªæŠŠ battle å•è¯å­—ç¬¦ä¸²ï¼ŒæŒ‰ç…§å­—æ¯æ‹†åˆ†åˆ°å­—å…¸æ ‘è¿›è¡Œå­˜æ”¾çš„å›¾ã€‚
- é”®æ ‡æ³¨åœ¨èŠ‚ç‚¹ä¸­ï¼Œå€¼æ ‡æ³¨åœ¨èŠ‚ç‚¹ä¹‹ä¸‹ã€‚æ¯ä¸€ä¸ªå®Œæ•´çš„è‹±æ–‡å•è¯å¯¹åº”ä¸€ä¸ªç‰¹å®šçš„æ•´æ•°ã€‚ä¹Ÿå°±æ˜¯26ä¸ªå­—æ¯å¯¹åº”çš„ ASCII è½¬æ¢åçš„å€¼ã€‚

## ä¸‰ã€å­—å…¸æ ‘ç»“æ„å®ç°

å­—å…¸æ ‘å­—æ¯çš„å­˜æ”¾æœ‰26ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹çš„åˆ†æ”¯éƒ½æœ‰26ä¸ªæ§½ä½ç”¨æ¥å­˜æ”¾å¯èƒ½å‡ºç°çš„å­—æ¯ç»„åˆã€‚åŒç†å¦‚æœæ˜¯æ•°å­—æ ‘çš„è¯å°±æ˜¯10ä¸ªæ•°å­—çš„ç»„åˆï¼Œæ¯ä¸ªå­—å…¸æ ‘ä¸Šçš„èŠ‚ç‚¹å¯¹åº”çš„åˆ†æ”¯åˆ™æœ‰10ä¸ªæ“ä½œå­˜æ”¾å¯èƒ½å‡ºç°ç»„åˆçš„æ•°å­—ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬å°±åŸºäº Java è¯­è¨€å®ç°ä¸€ä¸ªå­—å…¸æ ‘çš„å­˜æ”¾å’Œéå†ç´¢å¼•çš„åŠŸèƒ½ã€‚
- æºç åœ°å€ï¼š[https://github.com/fuzhengwei/java-algorithms](https://github.com/fuzhengwei/java-algorithms)
- æœ¬ç« æºç ï¼š[https://github.com/fuzhengwei/java-algorithms/tree/main/data-structures/src/main/java/stack](https://github.com/fuzhengwei/java-algorithms/tree/main/data-structures/src/main/java/stack)

### 1. æ ‘æèŠ‚ç‚¹

```java
public class TrieNode {

    /** å½¢æˆä¸€ä¸ªé“¾ */
    public TrieNode[] slot = new TrieNode[26];

    /** å­—æ¯ */
    public char c;

    /** å•è¯ï¼šæ•°é‡ > 0 è¡¨ç¤ºä¸€ä¸ªå•è¯ */
    public boolean isWord;

    /** å‰ç¼€ */
    public int prefix;

    /** å•è¯ï¼šå…·ä½“çš„ä¸€ä¸ªå•è¯å­—ç¬¦ä¸² */
    public String word;

    /** è§£é‡Šï¼šå•è¯çš„æ³¨é‡Šè¯´æ˜ */
    public String explain;

}
```

- å­—å…¸çš„æ ‘çš„èŠ‚ç‚¹éœ€è¦åŒ…æ‹¬æ­¤èŠ‚ç‚¹å†…åµŒçš„å…³è”èŠ‚ç‚¹ï¼Œä¹‹åæ˜¯èŠ‚ç‚¹çš„å­—æ¯ã€åˆ°æ­¤å­—æ¯æ˜¯å¦ä¸ºå•è¯ã€å•è¯çš„å‰ç¼€ã€å•è¯å­—ç¬¦ä¸²å’Œå½“å‰å•è¯çš„éå¿…è¦æ³¨é‡Šã€‚

### 2. æ’å…¥å…ƒç´ 

![](https://bugstack.cn/images/article/algorithm/trie-02.png)

```java
public void insert(String words, String explain) {
    TrieNode root = wordsTree;
    char[] chars = words.toCharArray();
    for (char c : chars) {
        int idx = c - 'a'; // - a ä» 0 å¼€å§‹ï¼Œå‚è€ƒ ASCII ç è¡¨
        if (root.slot[idx] == null) {
            root.slot[idx] = new TrieNode();
        }
        root = root.slot[idx];
        root.c = c;
        root.prefix++;
    }
    root.explain = explain; // å•è¯çš„æ³¨é‡Šè¯´æ˜ä¿¡æ¯
    root.isWord = true;     // å¾ªç¯æ‹†è§£å•è¯åæ ‡è®°
}
```

- insert æ–¹æ³•æ¥æ”¶å•è¯å’Œæ³¨é‡Šä¿¡æ¯ï¼Œå¹¶å¯¹ä¸€ä¸ªå•è¯æŒ‰ç…§ char è¿›è¡Œæ‹†åˆ†ï¼Œæ‹†åˆ†ååˆ™è®¡ç®—å‡ºç´¢å¼•ä½ç½®å¹¶ä»¥æ­¤å­˜æ”¾ã€‚å­˜æ”¾å®Œæˆåæ ‡è®°å•è¯å’Œé™„å±ä¸Šå•è¯çš„æ³¨é‡Šä¿¡æ¯ã€‚

### 3. ç´¢å¼•å…ƒç´ 

![](https://bugstack.cn/images/article/algorithm/trie-03.png)

```java
public List<String> searchPrefix(String prefix) {
    TrieNode root = wordsTree;
    char[] chars = prefix.toCharArray();
    StringBuilder cache = new StringBuilder();
    // ç²¾å‡†åŒ¹é…ï¼šæ ¹æ®å‰ç½®ç²¾å‡†æŸ¥æ‰¾
    for (char c : chars) {
        int idx = c - 'a';
        // åŒ¹é…ä¸ºç©º
        if (idx > root.slot.length || idx < 0 || root.slot[idx] == null) {
            return Collections.emptyList();
        }
        cache.append(c);
        root = root.slot[idx];
    }
    // æ¨¡ç³ŠåŒ¹é…ï¼šæ ¹æ®å‰ç¼€çš„æœ€åä¸€ä¸ªå•è¯ï¼Œé€’å½’éå†æ‰€æœ‰çš„å•è¯
    ArrayList<String> list = new ArrayList<>();
    if (root.prefix != 0) {
        for (int i = 0; i < root.slot.length; i++) {
            if (root.slot[i] != null) {
                char c = (char) (i + 'a');
                collect(root.slot[i], String.valueOf(cache) + c, list, 15);
                if (list.size() >= 15) {
                    return list;
                }
            }
        }
    }
    return list;
}

protected void collect(TrieNode trieNode, String pre, List<String> queue, int resultLimit) {
    // æ‰¾åˆ°å•è¯
    if (trieNode.isWord) {
        trieNode.word = pre;
        // ä¿å­˜æ£€ç´¢åˆ°çš„å•è¯åˆ° queue
        queue.add(trieNode.word + " -> " + trieNode.explain);
        if (queue.size() >= resultLimit) {
            return;
        }
    }
    // é€’å½’è°ƒç”¨ï¼ŒæŸ¥æ‰¾å•è¯
    for (int i = 0; i < trieNode.slot.length; i++) {
        char c = (char) ('a' + i);
        if (trieNode.slot[i] != null) {
            collect(trieNode.slot[i], pre + c, queue, resultLimit);
        }
    }
}
```

- ä»å­—å…¸æ ‘ä»æ£€ç´¢å…ƒç´ çš„è¿‡ç¨‹åˆ†ä¸º2éƒ¨åˆ†ï¼Œç¬¬1éƒ¨åˆ†æ˜¯æ ¹æ®æä¾›çš„ç´¢å¼•å‰ç¼€ç²¾å‡†åŒ¹é…åˆ°å•è¯ä¿¡æ¯ï¼Œç¬¬2éƒ¨åˆ†æ˜¯æ ¹æ®ç´¢å¼•å‰ç¼€çš„æœ€åä¸€ä¸ªå•è¯å¼€å§‹ï¼Œå¾ªç¯é€’å½’éå†ä»å½“å‰ä½ç½®æ‰€èƒ½å…³è”åˆ°çš„å­—æ¯ç›´è‡³åˆ¤æ–­ä¸ºæ˜¯å•è¯æ ‡è®°ä¸ºç»“æŸï¼Œé€šè¿‡è¿™æ ·çš„æ–¹å¼æŠŠæ‰€æœ‰åŒ¹é…åŠ¨çš„å•è¯ç´¢å¼•å‡ºæ¥ã€‚
- list.size() >= 15 æ˜¯åˆ¤å®šç´¢å¼•çš„æœ€å¤§é•¿åº¦ï¼Œè¶…è¿‡è¿™ä¸ªæ•°é‡å°±åœæ­¢ç´¢å¼•äº†ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä¸€ç§O(n)æ—¶é—´å¤æ‚åº¦çš„æ“ä½œï¼Œå¦‚æœåŠ è½½æ•°åä¸‡å•è¯è¿›è¡ŒåŒ¹é…ï¼Œæ‰§è¡Œé€Ÿåº¦è¿˜æ˜¯æ¯”è¾ƒè€—æ—¶çš„ã€‚

## å››ã€å­—å…¸æ ‘åŠŸèƒ½æµ‹è¯•

```java
@Test
public void test_trie() {
    Trie trie = new Trie();
    // å­˜å…¥
    trie.insert("bat","å¤§å‚");
    trie.insert("batch", "æ‰¹é‡");
    trie.insert("bitch", "å½ªå­");
    trie.insert("battle", "æˆ˜æ–—");
    logger.info(trie.toString());
    // æ£€ç´¢
    List<String> trieNodes = trie.searchPrefix("ba");
    logger.info("æµ‹è¯•ç»“æœï¼š{}", JSON.toJSONString(trieNodes));
}
```

- è¿™é‡Œæä¾›ä¸€äº›æœ‰ç›¸è¿‘å­—æ¯çš„å•è¯å’Œåè¯ï¼Œç”¨äºæµ‹è¯•ã€‚ä½ ä¹Ÿå¯ä»¥å°è¯•è¯»å–txtæ–‡ä»¶ï¼Œæ£€ç´¢å­˜å…¥æ•°åä¸‡å•è¯è¿›è¡Œæ£€ç´¢éªŒè¯ã€‚

**æµ‹è¯•ç»“æœ**

```java
06:21:38.226 [main] INFO trie.__test__.TrieTest - æµ‹è¯•ç»“æœï¼š["bat -> å¤§å‚","batch -> æ‰¹é‡","battle -> æˆ˜æ–—"]

Process finished with exit code 0
```

- é€šè¿‡æµ‹è¯•ç»“æœå¯ä»¥çœ‹åˆ°ï¼ŒæŠŠæ‰€æœ‰ä»¥ **ba** å¼€å¤´çš„å•è¯å…¨éƒ¨æ£€ç´¢å‡ºæ¥äº†ã€‚è¿™ä¹Ÿæ˜¯å­—å…¸æ ‘æœ€æ ¸å¿ƒåŠŸèƒ½çš„ä½“ç°ã€‚
- è¯»è€…åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥å°è¯•åœ¨æ£€ç´¢çš„æ–¹æ³•ä½“å†…æ‰“ä¸€äº›æ–­ç‚¹çœ‹ä¸€ä¸‹å…·ä½“çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæ–¹ä¾¿å­¦ä¹ æ•´ä¸ªæ‰§è¡Œæ­¥éª¤ã€‚

## äº”ã€å¸¸è§é¢è¯•é¢˜

- ç®€è¿°å­—å…¸æ ‘çš„æ•°æ®ç»“æ„
- å™è¿°ä½ æ€ä¹ˆæ¥å®ç°ä¸€ä¸ªå­—å…¸æ ‘
- å­—å…¸æ ‘çš„å®é™…ä¸šåŠ¡åœºæ™¯ä¸¾ä¾‹ã€æ’åºã€å…¨æ–‡æœç´¢ã€ç½‘ç»œæœç´¢å¼•æ“ã€ç”Ÿç‰©ä¿¡æ¯ã€‘
- å­—å…¸æ ‘çš„å­˜å…¥å’Œæ£€ç´¢çš„æ—¶é—´å¤æ‚åº¦
- è¿˜æœ‰å“ªäº›å­—å…¸æ ‘çš„å®ç°æ–¹å¼ã€[åç¼€æ ‘](https://en.wikipedia.org/wiki/Suffix_tree)ã€[å“ˆå¸Œæ ‘](https://en.wikipedia.org/wiki/Hash_trie)ã€[å¸½å­æ ‘](https://en.wikipedia.org/wiki/HAT-trie)ã€‘ 
