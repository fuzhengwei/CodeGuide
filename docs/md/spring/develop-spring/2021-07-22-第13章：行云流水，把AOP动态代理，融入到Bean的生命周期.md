---
layout: post
category: spring
title: ç¬¬13ç« ï¼šæŠŠAOPæ‰©å±•åˆ°Beançš„ç”Ÿå‘½å‘¨æœŸ
tagline: by å°å‚…å“¥
tag: [java]
excerpt: åœ¨ç”µè§†å‰§ã€Šæ¥šæ±‰ä¼ å¥‡ã€‹ä¸­æœ‰ä¸€æ®µåˆ˜é‚¦ä¸éŸ©ä¿¡çš„é¥®é…’å¯¹è¯ï¼Œåˆ˜é‚¦é—®éŸ©ä¿¡æ›¹å‚ã€æ¨Šå“™ã€å¢ç»¾ã€å‘¨å‹ƒï¼Œéƒ½èƒ½å¸¦å¤šå°‘å…µï¼ŒéŸ©ä¿¡è¯´éƒ½ä¸è¶³2ä¸‡ï¼Œä½†éŸ©ä¿¡è¯´è‡ªå·±å¯ä»¥å¤šå¤šç›Šå–„ã€‚è¿™åƒä¸åƒä½ é¢†å¯¼é—®ä½ ï¼Œä½ èƒ½å†™å¤šå°‘ä»£ç ã€æ­å¤šå°‘æ¡†æ¶ã€æ¥å¤šå°‘é¡¹ç›®ã€‚
lock: need
---

# ã€ŠSpring æ‰‹æ’¸ä¸“æ ã€‹ç¬¬ 13 ç« ï¼šè¡Œäº‘æµæ°´ï¼ŒæŠŠAOPåŠ¨æ€ä»£ç†ï¼Œèå…¥åˆ°Beançš„ç”Ÿå‘½å‘¨æœŸ

ä½œè€…ï¼šå°å‚…å“¥
<br/>åšå®¢ï¼š[https://bugstack.cn](https://bugstack.cn)
<br/>åŸæ–‡ï¼š[https://mp.weixin.qq.com/s/BFYJLNzVO8NxjmeCUzmLyg](https://mp.weixin.qq.com/s/BFYJLNzVO8NxjmeCUzmLyg)

> æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„

## ä¸€ã€å‰è¨€

`å˜å°å­ï¼Œè¿™ç‰‡ä»£ç æ°´å¤ªæ·±ä½ æŠŠæ¡ä¸ä½ï¼`

åœ¨ç”µè§†å‰§ã€Šæ¥šæ±‰ä¼ å¥‡ã€‹ä¸­æœ‰è¿™ä¹ˆä¸€æ®µåˆ˜é‚¦ä¸éŸ©ä¿¡çš„é¥®é…’å¯¹è¯ï¼Œåˆ˜é‚¦é—®éŸ©ä¿¡æˆ‘é‚£ä¸ª`æ›¹å‚`è¯»è¿‡ä¹¦è§è¿‡ä¸–é¢èƒ½å¸¦å¤šå°‘å…µï¼ŒéŸ©ä¿¡è¯´èƒ½å¸¦ä¸€ä¸‡äº”ï¼Œåˆè¡¥å……è¯´ä¸€ä¸‡äº”éƒ½åƒåŠ›ã€‚åˆ˜é‚¦åˆä¸€ä¸€è¯´å‡º`æ¨Šå“™`ã€`å¢ç»¾`ã€`å‘¨å‹ƒ`ï¼ŒéŸ©ä¿¡ç¬‘ç€è¯´ä¸è¶³2ä¸‡ï¼Œè„‘å­ä¸è¡Œã€‚è¿™æ—¶å€™åˆ˜é‚¦æœ‰ç‚¹æŒ‚ä¸ä½è„¸äº†ï¼Œé—®ï¼šé‚£æˆ‘å‘¢ï¼Œæˆ‘èƒ½å¸¦å¤šå°‘å…µã€‚éŸ©ä¿¡è¯´ï¼Œä½ èƒ½å¸¦åä¸‡ã€‚åˆ˜é‚¦ä¸€çœ‹æ¯”ä»–ä»¬éƒ½å¤šï¼Œå•Šï¼Œè¿˜è¡Œã€‚è½¬å¤´ä¸€æƒ³å°±é—®éŸ©ä¿¡é‚£ä½ å‘¢ï¼Œä½ èƒ½å¸¦å¤šå°‘å…µã€‚éŸ©ä¿¡å–å¤šäº†ï¼Œè¯´å•Šï¼Œæˆ‘ï¼Œæˆ‘å¤šå¤šç›Šå–„ã€‚è¿™æ—¶å€™åˆ˜é‚¦æ¼äº†é¢†å¯¼åŠ²ä¸Šæ¥äº†ï¼Œé—®ï¼šé‚£æˆ‘ä¸ºä»€ä¹ˆèƒ½ç®¡ç€ä½ ï¼Œä½ ç»™æˆ‘è¯´ï¼Œè¯´å‘€ï¼

---

è¿™åƒä¸åƒä½ é¢†å¯¼é—®ä½ ï¼Œä½ èƒ½å†™å¤šå°‘ä»£ç ã€æ­å¤šå°‘æ¡†æ¶ã€æ¥å¤šå°‘é¡¹ç›®ã€‚å¯èƒ½å¾ˆå¤§ä¸€éƒ¨åˆ†æ²¡ç»å†å¤ªå¤šçš„æ–°äººç å†œï¼Œä»…ä»…æ˜¯èƒ½å®Œæˆä¸€äº›ç®€å•çš„åŠŸèƒ½æ¨¡å—å¼€å‘ï¼Œè€Œæ²¡æœ‰åŠæ³•é©¾é©­æ•´ä¸ªé¡¹ç›®çš„æ¶‰åŠåˆ°çš„æ‰€æœ‰å·¥ç¨‹ï¼Œä¹Ÿä¸èƒ½ä¸ºé¡¹ç›®æç‚¼å‡ºä¸€äº›å¯å¤ç”¨çš„é€šç”¨æ€§ç»„ä»¶æ¨¡å—ã€‚åœ¨åˆçº§ç å†œçš„å¿ƒé‡Œï¼Œæ¥ä¸€ç‚¹éœ€æ±‚è¿˜å¥½ï¼Œä½†æ²¡æœ‰äººå¸¦çš„æ—¶å€™å®Œå…¨æ¥ä¸€ä¸ªè¾ƒå¤§å‹é¡¹ç›®å°±ä¼šæ¯”è¾ƒæ…Œäº†ï¼Œä¸çŸ¥é“è¿™é‡Œæœ‰æ²¡æœ‰å‘ï¼Œè‡ªå·±ä¹ŸæŠŠæ¡ä½ä¸ã€‚*è¿™äº›ä»£ç ä¸€å—å—çš„å¸¦ç€èƒ½å†™ï¼Œä½†æ˜¯éƒ½å¼„åˆ°ä¸€å—ï¼Œå°±å¤ªéš¾äº†ï¼*

åœ¨ä»£ç å¼€å‘æˆé•¿çš„è¿™æ¡è·¯ä¸Šï¼Œè¦ç»å†CRUDã€ERPæŸ¥æ•°æ®ã€æ¥å£åŒ…è£…ã€åŠŸèƒ½å¼€å‘ã€æœåŠ¡æ•´åˆã€ç³»ç»Ÿå»ºè®¾ç­‰ï¼Œä¸€ç›´åˆ°ç‹¬ç«‹å¸¦äººæ‰¿æ‹…è¾ƒå¤§å‹é¡¹ç›®çš„æ­å»ºã€‚è¿™ä¸€è¿‡ç¨‹éœ€è¦ä½ èƒ½æœ‰å¤§é‡çš„ç¼–å†™ä»£ç ç»éªŒç§¯ç´¯å’Œå¤æ‚é—®é¢˜çš„å¤„ç†æ‰‹æ®µï¼Œä¹‹åæ‰èƒ½ä¸€æ®µæ®µçš„æŠŠçœ‹ä¼¼ç‹¬ç«‹çš„æ¨¡å—åè€…ä»£ç ç‰‡æ®µç»„è£…æˆä¸€ä¸ªè¾ƒå¤§å‹èƒ½è·‘èµ·æ¥çš„é¡¹ç›®ã€‚å°±åƒ Spring çš„å¼€å‘è¿‡ç¨‹ä¸€æ ·ï¼Œæˆ‘ä»¬æ€»æ˜¯ä¸æ–­åœ¨æ·»åŠ æ–°çš„åŠŸèƒ½ç‰‡æ®µï¼Œæœ€ååˆæŠŠæŠ€æœ¯å®ç°ä¸Spring å®¹å™¨æ•´åˆï¼Œè®©ä½¿ç”¨æ–¹å¯ä»¥æ›´ç®€å•çš„è¿ç”¨ Spring æä¾›çš„èƒ½åŠ›ã€‚

## äºŒã€ç›®æ ‡

åœ¨ä¸Šä¸€ç« èŠ‚æˆ‘ä»¬é€šè¿‡åŸºäº Proxy.newProxyInstance ä»£ç†æ“ä½œä¸­å¤„ç†æ–¹æ³•åŒ¹é…å’Œæ–¹æ³•æ‹¦æˆªï¼Œå¯¹åŒ¹é…çš„å¯¹è±¡è¿›è¡Œè‡ªå®šä¹‰çš„å¤„ç†æ“ä½œã€‚å¹¶æŠŠè¿™æ ·çš„æŠ€æœ¯æ ¸å¿ƒå†…å®¹æ‹†è§£åˆ° Spring ä¸­ï¼Œç”¨äºå®ç° AOP éƒ¨åˆ†ï¼Œé€šè¿‡æ‹†åˆ†ååŸºæœ¬å¯ä»¥æ˜ç¡®å„ä¸ªç±»çš„èŒè´£ï¼ŒåŒ…æ‹¬ä½ çš„ä»£ç†ç›®æ ‡å¯¹è±¡å±æ€§ã€æ‹¦æˆªå™¨å±æ€§ã€æ–¹æ³•åŒ¹é…å±æ€§ï¼Œä»¥åŠä¸¤ç§ä¸åŒçš„ä»£ç†æ“ä½œ JDK å’Œ CGlib çš„æ–¹å¼ã€‚

å†æœ‰äº†ä¸€ä¸ª AOP æ ¸å¿ƒåŠŸèƒ½çš„å®ç°åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å•å…ƒæµ‹è¯•çš„æ–¹å¼è¿›è¡ŒéªŒè¯åˆ‡é¢åŠŸèƒ½å¯¹æ–¹æ³•è¿›è¡Œæ‹¦æˆªï¼Œä½†å¦‚æœè¿™æ˜¯ä¸€ä¸ªé¢å‘ç”¨æˆ·ä½¿ç”¨çš„åŠŸèƒ½ï¼Œå°±ä¸å¤ªå¯èƒ½è®©ç”¨æˆ·è¿™ä¹ˆå¤æ‚ä¸”æ²¡æœ‰ä¸ Spring ç»“åˆçš„æ–¹å¼å•ç‹¬ä½¿ç”¨ AOPï¼Œè™½ç„¶å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œä½†ä½¿ç”¨ä¸Šè¿˜æ˜¯è¿‡å»åˆ†æ•£ã€‚

å› æ­¤æˆ‘ä»¬éœ€è¦åœ¨æœ¬ç« èŠ‚å®Œæˆ AOP æ ¸å¿ƒåŠŸèƒ½ä¸ Spring æ¡†æ¶çš„æ•´åˆï¼Œæœ€ç»ˆèƒ½é€šè¿‡åœ¨ Spring é…ç½®çš„æ–¹å¼å®Œæˆåˆ‡é¢çš„æ“ä½œã€‚

## ä¸‰ã€æ–¹æ¡ˆ

å…¶å®åœ¨æœ‰äº†AOPçš„æ ¸å¿ƒåŠŸèƒ½å®ç°åï¼ŒæŠŠè¿™éƒ¨åˆ†åŠŸèƒ½æœåŠ¡èå…¥åˆ° Spring å…¶å®ä¹Ÿä¸éš¾ï¼Œåªä¸è¿‡è¦è§£å†³å‡ ä¸ªé—®é¢˜ï¼ŒåŒ…æ‹¬ï¼šæ€ä¹ˆå€Ÿç€ BeanPostProcessor æŠŠåŠ¨æ€ä»£ç†èå…¥åˆ° Bean çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œä»¥åŠå¦‚ä½•ç»„è£…å„é¡¹åˆ‡ç‚¹ã€æ‹¦æˆªã€å‰ç½®çš„åŠŸèƒ½å’Œé€‚é…å¯¹åº”çš„ä»£ç†å™¨ã€‚æ•´ä½“è®¾è®¡ç»“æ„å¦‚ä¸‹å›¾ï¼š

![](https://bugstack.cn/assets/images/spring/spring-13-01.png)

- ä¸ºäº†å¯ä»¥è®©å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œèƒ½æŠŠxmlä¸­é…ç½®çš„ä»£ç†å¯¹è±¡ä¹Ÿå°±æ˜¯åˆ‡é¢çš„ä¸€äº›ç±»å¯¹è±¡å®ä¾‹åŒ–ï¼Œå°±éœ€è¦ç”¨åˆ° BeanPostProcessor æä¾›çš„æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªç±»çš„ä¸­çš„æ–¹æ³•å¯ä»¥åˆ†åˆ«ä½œç”¨ä¸ Bean å¯¹è±¡æ‰§è¡Œåˆå§‹åŒ–å‰åä¿®æ”¹ Bean çš„å¯¹è±¡çš„æ‰©å±•ä¿¡æ¯ã€‚ä½†è¿™é‡Œéœ€è¦é›†åˆäº BeanPostProcessor å®ç°æ–°çš„æ¥å£å’Œå®ç°ç±»ï¼Œè¿™æ ·æ‰èƒ½å®šå‘è·å–å¯¹åº”çš„ç±»ä¿¡æ¯ã€‚
- ä½†å› ä¸ºåˆ›å»ºçš„æ˜¯ä»£ç†å¯¹è±¡ä¸æ˜¯ä¹‹å‰æµç¨‹é‡Œçš„æ™®é€šå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å‰ç½®äºå…¶ä»–å¯¹è±¡çš„åˆ›å»ºï¼Œæ‰€ä»¥åœ¨å®é™…å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦åœ¨ AbstractAutowireCapableBeanFactory#createBean ä¼˜å…ˆå®Œæˆ Bean å¯¹è±¡çš„åˆ¤æ–­ï¼Œæ˜¯å¦éœ€è¦ä»£ç†ï¼Œæœ‰åˆ™ç›´æ¥è¿”å›ä»£ç†å¯¹è±¡ã€‚*åœ¨Springçš„æºç ä¸­ä¼šæœ‰ createBean å’Œ doCreateBean çš„æ–¹æ³•æ‹†åˆ†*
- è¿™é‡Œè¿˜åŒ…æ‹¬è¦è§£å†³æ–¹æ³•æ‹¦æˆªå™¨çš„å…·ä½“åŠŸèƒ½ï¼Œæä¾›ä¸€äº› BeforeAdviceã€AfterAdvice çš„å®ç°ï¼Œè®©ç”¨æˆ·å¯ä»¥æ›´ç®€åŒ–çš„ä½¿ç”¨åˆ‡é¢åŠŸèƒ½ã€‚é™¤æ­¤ä¹‹å¤–è¿˜åŒ…æ‹¬éœ€è¦åŒ…è£…åˆ‡é¢è¡¨è¾¾å¼ä»¥åŠæ‹¦æˆªæ–¹æ³•çš„æ•´åˆï¼Œä»¥åŠæä¾›ä¸åŒç±»å‹çš„ä»£ç†æ–¹å¼çš„ä»£ç†å·¥å‚ï¼Œæ¥åŒ…è£…æˆ‘ä»¬çš„åˆ‡é¢æœåŠ¡ã€‚

## å››ã€å®ç°

### 1. å·¥ç¨‹ç»“æ„

```java
small-spring-step-12
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â””â”€â”€ java
    â”‚       â””â”€â”€ cn.bugstack.springframework
    â”‚           â”œâ”€â”€ aop
    â”‚           â”‚   â”œâ”€â”€ aspectj
    â”‚           â”‚   â”‚   â””â”€â”€ AspectJExpressionPointcut.java
    â”‚           â”‚   â”‚   â””â”€â”€ AspectJExpressionPointcutAdvisor.java
    â”‚           â”‚   â”œâ”€â”€ framework 
    â”‚           â”‚   â”‚   â”œâ”€â”€ adapter
    â”‚           â”‚   â”‚   â”‚   â””â”€â”€ MethodBeforeAdviceInterceptor.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ autoproxy
    â”‚           â”‚   â”‚   â”‚   â””â”€â”€ DefaultAdvisorAutoProxyCreator.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ AopProxy.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ Cglib2AopProxy.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ JdkDynamicAopProxy.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ ProxyFactory.java
    â”‚           â”‚   â”‚   â””â”€â”€ ReflectiveMethodInvocation.java
    â”‚           â”‚   â”œâ”€â”€ AdvisedSupport.java
    â”‚           â”‚   â”œâ”€â”€ Advisor.java
    â”‚           â”‚   â”œâ”€â”€ BeforeAdvice.java
    â”‚           â”‚   â”œâ”€â”€ ClassFilter.java
    â”‚           â”‚   â”œâ”€â”€ MethodBeforeAdvice.java
    â”‚           â”‚   â”œâ”€â”€ MethodMatcher.java
    â”‚           â”‚   â”œâ”€â”€ Pointcut.java
    â”‚           â”‚   â”œâ”€â”€ PointcutAdvisor.java
    â”‚           â”‚   â””â”€â”€ TargetSource.java
    â”‚           â”œâ”€â”€ beans
    â”‚           â”‚   â”œâ”€â”€ factory
    â”‚           â”‚   â”‚   â”œâ”€â”€ config
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ AutowireCapableBeanFactory.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ BeanDefinition.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ BeanFactoryPostProcessor.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ BeanPostProcessor.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ BeanReference.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ ConfigurableBeanFactory.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ InstantiationAwareBeanPostProcessor.java
    â”‚           â”‚   â”‚   â”‚   â””â”€â”€ SingletonBeanRegistry.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ support
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ AbstractAutowireCapableBeanFactory.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ AbstractBeanDefinitionReader.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ AbstractBeanFactory.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ BeanDefinitionReader.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ BeanDefinitionRegistry.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ CglibSubclassingInstantiationStrategy.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ DefaultListableBeanFactory.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ DefaultSingletonBeanRegistry.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ DisposableBeanAdapter.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ FactoryBeanRegistrySupport.java
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ InstantiationStrategy.java
    â”‚           â”‚   â”‚   â”‚   â””â”€â”€ SimpleInstantiationStrategy.java  
    â”‚           â”‚   â”‚   â”œâ”€â”€ support
    â”‚           â”‚   â”‚   â”‚   â””â”€â”€ XmlBeanDefinitionReader.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ Aware.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ BeanClassLoaderAware.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ BeanFactory.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ BeanFactoryAware.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ BeanNameAware.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ ConfigurableListableBeanFactory.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ DisposableBean.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ FactoryBean.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ HierarchicalBeanFactory.java
    â”‚           â”‚   â”‚   â”œâ”€â”€ InitializingBean.java
    â”‚           â”‚   â”‚   â””â”€â”€ ListableBeanFactory.java
    â”‚           â”‚   â”œâ”€â”€ BeansException.java
    â”‚           â”‚   â”œâ”€â”€ PropertyValue.java
    â”‚           â”‚   â””â”€â”€ PropertyValues.java 
    â”‚           â”œâ”€â”€ context
    â”‚           â”‚   â”œâ”€â”€ event
    â”‚           â”‚   â”‚   â”œâ”€â”€ AbstractApplicationEventMulticaster.java 
    â”‚           â”‚   â”‚   â”œâ”€â”€ ApplicationContextEvent.java 
    â”‚           â”‚   â”‚   â”œâ”€â”€ ApplicationEventMulticaster.java 
    â”‚           â”‚   â”‚   â”œâ”€â”€ ContextClosedEvent.java 
    â”‚           â”‚   â”‚   â”œâ”€â”€ ContextRefreshedEvent.java 
    â”‚           â”‚   â”‚   â””â”€â”€ SimpleApplicationEventMulticaster.java 
    â”‚           â”‚   â”œâ”€â”€ support
    â”‚           â”‚   â”‚   â”œâ”€â”€ AbstractApplicationContext.java 
    â”‚           â”‚   â”‚   â”œâ”€â”€ AbstractRefreshableApplicationContext.java 
    â”‚           â”‚   â”‚   â”œâ”€â”€ AbstractXmlApplicationContext.java 
    â”‚           â”‚   â”‚   â”œâ”€â”€ ApplicationContextAwareProcessor.java 
    â”‚           â”‚   â”‚   â””â”€â”€ ClassPathXmlApplicationContext.java 
    â”‚           â”‚   â”œâ”€â”€ ApplicationContext.java 
    â”‚           â”‚   â”œâ”€â”€ ApplicationContextAware.java 
    â”‚           â”‚   â”œâ”€â”€ ApplicationEvent.java 
    â”‚           â”‚   â”œâ”€â”€ ApplicationEventPublisher.java 
    â”‚           â”‚   â”œâ”€â”€ ApplicationListener.java 
    â”‚           â”‚   â””â”€â”€ ConfigurableApplicationContext.java
    â”‚           â”œâ”€â”€ core.io
    â”‚           â”‚   â”œâ”€â”€ ClassPathResource.java 
    â”‚           â”‚   â”œâ”€â”€ DefaultResourceLoader.java 
    â”‚           â”‚   â”œâ”€â”€ FileSystemResource.java 
    â”‚           â”‚   â”œâ”€â”€ Resource.java 
    â”‚           â”‚   â”œâ”€â”€ ResourceLoader.java 
    â”‚           â”‚   â””â”€â”€ UrlResource.java
    â”‚           â””â”€â”€ utils
    â”‚               â””â”€â”€ ClassUtils.java
    â””â”€â”€ test
        â””â”€â”€ java
            â””â”€â”€ cn.bugstack.springframework.test
                â”œâ”€â”€ bean
                â”‚   â”œâ”€â”€ IUserService.java
                â”‚   â”œâ”€â”€ UserService.java
                â”‚   â””â”€â”€ UserServiceInterceptor.java
                â””â”€â”€ ApiTest.java
```

**å·¥ç¨‹æºç **ï¼š`å…¬ä¼—å·ã€Œbugstackè™«æ´æ ˆã€ï¼Œå›å¤ï¼šSpring ä¸“æ ï¼Œè·å–å®Œæ•´æºç `

AOP åŠ¨æ€ä»£ç†èå…¥åˆ°Beançš„ç”Ÿå‘½å‘¨æœŸä¸­ç±»å…³ç³»ï¼Œå¦‚å›¾ 13-2

![å›¾ 13-2](https://bugstack.cn/assets/images/spring/spring-13-02.png)

- æ•´ä¸ªç±»å…³ç³»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä»¥ BeanPostProcessor æ¥å£å®ç°ç»§æ‰¿çš„ InstantiationAwareBeanPostProcessor æ¥å£åï¼Œåšäº†ä¸€ä¸ªè‡ªåŠ¨ä»£ç†åˆ›å»ºçš„ç±» DefaultAdvisorAutoProxyCreatorï¼Œè¿™ä¸ªç±»çš„å°±æ˜¯ç”¨äºå¤„ç†æ•´ä¸ª AOP ä»£ç†èå…¥åˆ° Bean ç”Ÿå‘½å‘¨æœŸä¸­çš„æ ¸å¿ƒç±»ã€‚
- DefaultAdvisorAutoProxyCreator ä¼šä¾èµ–äºæ‹¦æˆªå™¨ã€ä»£ç†å·¥å‚å’ŒPointcutä¸Advisorçš„åŒ…è£…æœåŠ¡ AspectJExpressionPointcutAdvisorï¼Œç”±å®ƒæä¾›åˆ‡é¢ã€æ‹¦æˆªæ–¹æ³•å’Œè¡¨è¾¾å¼ã€‚
- Spring çš„ AOP æŠŠ Advice ç»†åŒ–äº† BeforeAdviceã€AfterAdviceã€AfterReturningAdviceã€ThrowsAdviceï¼Œç›®å‰æˆ‘ä»¬åšçš„æµ‹è¯•æ¡ˆä¾‹ä¸­åªç”¨åˆ°äº† BeforeAdviceï¼Œè¿™éƒ¨åˆ†å¯ä»¥å¯¹ç…§ Spring çš„æºç è¿›è¡Œè¡¥å……æµ‹è¯•ã€‚

### 2. å®šä¹‰Adviceæ‹¦æˆªå™¨é“¾   

**cn.bugstack.springframework.aop.BeforeAdvice**

```java
public interface BeforeAdvice extends Advice {

}
```

**cn.bugstack.springframework.aop.MethodBeforeAdvice**

```java
public interface MethodBeforeAdvice extends BeforeAdvice {

    /**
     * Callback before a given method is invoked.
     *
     * @param method method being invoked
     * @param args   arguments to the method
     * @param target target of the method invocation. May be <code>null</code>.
     * @throws Throwable if this object wishes to abort the call.
     *                   Any exception thrown will be returned to the caller if it's
     *                   allowed by the method signature. Otherwise the exception
     *                   will be wrapped as a runtime exception.
     */
    void before(Method method, Object[] args, Object target) throws Throwable;

}
```

- åœ¨ Spring æ¡†æ¶ä¸­ï¼ŒAdvice éƒ½æ˜¯é€šè¿‡æ–¹æ³•æ‹¦æˆªå™¨ MethodInterceptor å®ç°çš„ã€‚ç¯ç»• Advice ç±»ä¼¼ä¸€ä¸ªæ‹¦æˆªå™¨çš„é“¾è·¯ï¼ŒBefore Adviceã€After adviceç­‰ï¼Œä¸è¿‡æš‚æ—¶æˆ‘ä»¬éœ€è¦é‚£ä¹ˆå¤šå°±åªå®šä¹‰äº†ä¸€ä¸ª MethodBeforeAdvice çš„æ¥å£å®šä¹‰ã€‚

### 3. å®šä¹‰ Advisor è®¿é—®è€… 

**cn.bugstack.springframework.aop.Advisor**

```java
public interface Advisor {

    /**
     * Return the advice part of this aspect. An advice may be an
     * interceptor, a before advice, a throws advice, etc.
     * @return the advice that should apply if the pointcut matches
     * @see org.aopalliance.intercept.MethodInterceptor
     * @see BeforeAdvice
     */
    Advice getAdvice();

}
```

**cn.bugstack.springframework.aop.PointcutAdvisor**

```java
public interface PointcutAdvisor extends Advisor {

    /**
     * Get the Pointcut that drives this advisor.
     */
    Pointcut getPointcut();

}
```

- PointcutAdvisor æ‰¿æ‹…äº† Pointcut å’Œ Advice çš„ç»„åˆï¼ŒPointcut ç”¨äºè·å– JoinPointï¼Œè€Œ Advice å†³å®šäº JoinPoint æ‰§è¡Œä»€ä¹ˆæ“ä½œã€‚

**cn.bugstack.springframework.aop.aspectj.AspectJExpressionPointcutAdvisor**

```java
public class AspectJExpressionPointcutAdvisor implements PointcutAdvisor {

    // åˆ‡é¢
    private AspectJExpressionPointcut pointcut;
    // å…·ä½“çš„æ‹¦æˆªæ–¹æ³•
    private Advice advice;
    // è¡¨è¾¾å¼
    private String expression;

    public void setExpression(String expression){
        this.expression = expression;
    }

    @Override
    public Pointcut getPointcut() {
        if (null == pointcut) {
            pointcut = new AspectJExpressionPointcut(expression);
        }
        return pointcut;
    }

    @Override
    public Advice getAdvice() {
        return advice;
    }

    public void setAdvice(Advice advice){
        this.advice = advice;
    }

}
```

- AspectJExpressionPointcutAdvisor å®ç°äº† PointcutAdvisor æ¥å£ï¼ŒæŠŠåˆ‡é¢ pointcutã€æ‹¦æˆªæ–¹æ³• advice å’Œå…·ä½“çš„æ‹¦æˆªè¡¨è¾¾å¼åŒ…è£…åœ¨ä¸€èµ·ã€‚è¿™æ ·å°±å¯ä»¥åœ¨ xml çš„é…ç½®ä¸­å®šä¹‰ä¸€ä¸ª pointcutAdvisor åˆ‡é¢æ‹¦æˆªå™¨äº†ã€‚

### 4. æ–¹æ³•æ‹¦æˆªå™¨

**cn.bugstack.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor**

```java
public class MethodBeforeAdviceInterceptor implements MethodInterceptor {

    private MethodBeforeAdvice advice;

    public MethodBeforeAdviceInterceptor(MethodBeforeAdvice advice) {
        this.advice = advice;
    }

    public MethodBeforeAdvice getAdvice() {
        return advice;
    }

    public void setAdvice(MethodBeforeAdvice advice) {
        this.advice = advice;
    }

    @Override
    public Object invoke(MethodInvocation methodInvocation) throws Throwable {
        this.advice.before(methodInvocation.getMethod(), methodInvocation.getArguments(), methodInvocation.getThis());
        return methodInvocation.proceed();
    }

}
```

- MethodBeforeAdviceInterceptor å®ç°äº† MethodInterceptor æ¥å£ï¼Œåœ¨ invoke æ–¹æ³•ä¸­è°ƒç”¨ advice ä¸­çš„ before æ–¹æ³•ï¼Œä¼ å…¥å¯¹åº”çš„å‚æ•°ä¿¡æ¯ã€‚
- è€Œè¿™ä¸ª advice.before åˆ™æ˜¯ç”¨äºè‡ªå·±å®ç° MethodBeforeAdvice æ¥å£ååšçš„ç›¸åº”å¤„ç†ã€‚*å…¶å®å¯ä»¥çœ‹åˆ°å…·ä½“çš„ MethodInterceptor å®ç°ç±»ï¼Œå…¶å®å’Œæˆ‘ä»¬ä¹‹å‰åšçš„æµ‹è¯•æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡ç°åœ¨äº¤ç»™äº† Spring æ¥å¤„ç†*

### 5. ä»£ç†å·¥å‚

**cn.bugstack.springframework.aop.framework.ProxyFactory**

```java
public class ProxyFactory {

    private AdvisedSupport advisedSupport;

    public ProxyFactory(AdvisedSupport advisedSupport) {
        this.advisedSupport = advisedSupport;
    }

    public Object getProxy() {
        return createAopProxy().getProxy();
    }

    private AopProxy createAopProxy() {
        if (advisedSupport.isProxyTargetClass()) {
            return new Cglib2AopProxy(advisedSupport);
        }

        return new JdkDynamicAopProxy(advisedSupport);
    }

}
```

- å…¶å®è¿™ä¸ªä»£ç†å·¥å‚ä¸»è¦è§£å†³çš„æ˜¯å…³äº JDK å’Œ Cglib ä¸¤ç§ä»£ç†çš„é€‰æ‹©é—®é¢˜ï¼Œæœ‰äº†ä»£ç†å·¥å‚å°±å¯ä»¥æŒ‰ç…§ä¸åŒçš„åˆ›å»ºéœ€æ±‚è¿›è¡Œæ§åˆ¶ã€‚

### 6. èå…¥Beanç”Ÿå‘½å‘¨æœŸçš„è‡ªåŠ¨ä»£ç†åˆ›å»ºè€…

**cn.bugstack.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator**

```java
public class DefaultAdvisorAutoProxyCreator implements InstantiationAwareBeanPostProcessor, BeanFactoryAware {

    private DefaultListableBeanFactory beanFactory;

    @Override
    public void setBeanFactory(BeanFactory beanFactory) throws BeansException {
        this.beanFactory = (DefaultListableBeanFactory) beanFactory;
    }

    @Override
    public Object postProcessBeforeInstantiation(Class<?> beanClass, String beanName) throws BeansException {

        if (isInfrastructureClass(beanClass)) return null;

        Collection<AspectJExpressionPointcutAdvisor> advisors = beanFactory.getBeansOfType(AspectJExpressionPointcutAdvisor.class).values();

        for (AspectJExpressionPointcutAdvisor advisor : advisors) {
            ClassFilter classFilter = advisor.getPointcut().getClassFilter();
            if (!classFilter.matches(beanClass)) continue;

            AdvisedSupport advisedSupport = new AdvisedSupport();

            TargetSource targetSource = null;
            try {
                targetSource = new TargetSource(beanClass.getDeclaredConstructor().newInstance());
            } catch (Exception e) {
                e.printStackTrace();
            }
            advisedSupport.setTargetSource(targetSource);
            advisedSupport.setMethodInterceptor((MethodInterceptor) advisor.getAdvice());
            advisedSupport.setMethodMatcher(advisor.getPointcut().getMethodMatcher());
            advisedSupport.setProxyTargetClass(false);

            return new ProxyFactory(advisedSupport).getProxy();

        }

        return null;
    }
    
}
```

- è¿™ä¸ª DefaultAdvisorAutoProxyCreator ç±»çš„ä¸»è¦æ ¸å¿ƒå®ç°åœ¨äº postProcessBeforeInstantiation æ–¹æ³•ä¸­ï¼Œä»é€šè¿‡ beanFactory.getBeansOfType è·å– AspectJExpressionPointcutAdvisor å¼€å§‹ã€‚
- è·å–äº† advisors ä»¥åå°±å¯ä»¥éå†ç›¸åº”çš„ AspectJExpressionPointcutAdvisor å¡«å……å¯¹åº”çš„å±æ€§ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šç›®æ ‡å¯¹è±¡ã€æ‹¦æˆªæ–¹æ³•ã€åŒ¹é…å™¨ï¼Œä¹‹åè¿”å›ä»£ç†å¯¹è±¡å³å¯ã€‚
- é‚£ä¹ˆç°åœ¨è°ƒç”¨æ–¹è·å–åˆ°çš„è¿™ä¸ª Bean å¯¹è±¡å°±æ˜¯ä¸€ä¸ªå·²ç»è¢«åˆ‡é¢æ³¨å…¥çš„å¯¹è±¡äº†ï¼Œå½“è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ï¼Œåˆ™ä¼šè¢«æŒ‰éœ€æ‹¦æˆªï¼Œå¤„ç†ç”¨æˆ·éœ€è¦çš„ä¿¡æ¯ã€‚

### 7. èå…¥åˆ°Beançš„ç”Ÿå‘½å‘¨æœŸ

**cn.bugstack.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory**

```java
public abstract class AbstractAutowireCapableBeanFactory extends AbstractBeanFactory implements AutowireCapableBeanFactory {

    private InstantiationStrategy instantiationStrategy = new CglibSubclassingInstantiationStrategy();

    @Override
    protected Object createBean(String beanName, BeanDefinition beanDefinition, Object[] args) throws BeansException {
        Object bean = null;
        try {
            // åˆ¤æ–­æ˜¯å¦è¿”å›ä»£ç† Bean å¯¹è±¡
            bean = resolveBeforeInstantiation(beanName, beanDefinition);
            if (null != bean) {
                return bean;
            }

            bean = createBeanInstance(beanDefinition, beanName, args);
            // ç»™ bean å¡«å……å±æ€§
            applyPropertyValues(beanName, bean, beanDefinition);
            // æ‰§è¡Œ Bean çš„åˆå§‹åŒ–æ–¹æ³•å’Œ BeanPostProcessor çš„å‰ç½®å’Œåç½®å¤„ç†æ–¹æ³•
            bean = initializeBean(beanName, bean, beanDefinition);
        } catch (Exception e) {
            throw new BeansException("Instantiation of bean failed.", e);
        }

        // æ³¨å†Œå®ç°äº† DisposableBean æ¥å£çš„ Bean å¯¹è±¡
        registerDisposableBeanIfNecessary(beanName, bean, beanDefinition);

        // åˆ¤æ–­ SCOPE_SINGLETONï¼ŒSCOPE_PROTOTYPE
        if (beanDefinition.isSingleton()) {
            registerSingleton(beanName, bean);
        }
        return bean;
    }

    protected Object resolveBeforeInstantiation(String beanName, BeanDefinition beanDefinition) {
        Object bean = applyBeanPostProcessorBeforeInstantiation(beanDefinition.getBeanClass(), beanName);
        if (null != bean) {
            bean = applyBeanPostProcessorAfterInitialization(bean, beanName);
        }
        return bean;
    }

    // æ³¨æ„ï¼Œæ­¤æ–¹æ³•ä¸ºæ–°å¢æ–¹æ³•ï¼Œä¸ â€œapplyBeanPostProcessorBeforeInitializationâ€ æ˜¯ä¸¤ä¸ªæ–¹æ³•
    public Object applyBeanPostProcessorBeforeInstantiation(Class<?> beanClass, String beanName) throws BeansException {
        for (BeanPostProcessor processor : getBeanPostProcessors()) {
            if (processor instanceof InstantiationAwareBeanPostProcessor) {
                Object result = ((InstantiationAwareBeanPostProcessor)processor).postProcessBeforeInstantiation(beanClass, beanName);
                if (null != result) return result;
            }
        }
        return null;
    }
}
```

- å› ä¸ºåˆ›å»ºçš„æ˜¯ä»£ç†å¯¹è±¡ä¸æ˜¯ä¹‹å‰æµç¨‹é‡Œçš„æ™®é€šå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å‰ç½®äºå…¶ä»–å¯¹è±¡çš„åˆ›å»ºï¼Œå³éœ€è¦åœ¨ AbstractAutowireCapableBeanFactory#createBean ä¼˜å…ˆå®Œæˆ Bean å¯¹è±¡çš„åˆ¤æ–­ï¼Œæ˜¯å¦éœ€è¦ä»£ç†ï¼Œæœ‰åˆ™ç›´æ¥è¿”å›ä»£ç†å¯¹è±¡ã€‚

## äº”ã€æµ‹è¯•

### 1. äº‹å…ˆå‡†å¤‡

```java
public class UserService implements IUserService {

    public String queryUserInfo() {
        try {
            Thread.sleep(new Random(1).nextInt(100));
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        return "å°å‚…å“¥ï¼Œ100001ï¼Œæ·±åœ³";
    }

    public String register(String userName) {
        try {
            Thread.sleep(new Random(1).nextInt(100));
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        return "æ³¨å†Œç”¨æˆ·ï¼š" + userName + " successï¼";
    }

}
```

- åœ¨ UserService ä¸­æä¾›äº†2ä¸ªä¸åŒæ–¹æ³•ï¼Œå¦å¤–ä½ è¿˜å¯ä»¥å¢åŠ æ–°çš„ç±»æ¥åŠ å…¥æµ‹è¯•ã€‚åé¢æˆ‘ä»¬çš„æµ‹è¯•è¿‡ç¨‹ï¼Œä¼šç»™è¿™ä¸ªä¸¤ä¸ªæ–¹æ³•æ·»åŠ æˆ‘ä»¬çš„æ‹¦æˆªå¤„ç†ï¼Œæ‰“å°æ–¹æ³•æ‰§è¡Œè€—æ—¶ã€‚

### 2. è‡ªå®šä¹‰æ‹¦æˆªæ–¹æ³•

```java
public class UserServiceBeforeAdvice implements MethodBeforeAdvice {

    @Override
    public void before(Method method, Object[] args, Object target) throws Throwable {
        System.out.println("æ‹¦æˆªæ–¹æ³•ï¼š" + method.getName());
    }

}
```

- ä¸ä¸Šä¸€ç« èŠ‚çš„æ‹¦æˆªæ–¹æ³•ç›¸æ¯”ï¼Œæˆ‘ä»¬ä¸åœ¨æ˜¯å®ç° MethodInterceptor æ¥å£ï¼Œè€Œæ˜¯å®ç° MethodBeforeAdvice ç¯ç»•æ‹¦æˆªã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æˆ‘ä»¬å¯ä»¥è·å–åˆ°æ–¹æ³•çš„ä¸€äº›ä¿¡æ¯ï¼Œå¦‚æœè¿˜å¼€å‘äº†å®ƒçš„ MethodAfterAdvice åˆ™å¯ä»¥ä¸¤ä¸ªæ¥å£ä¸€èµ·å®ç°ã€‚

### 3. spring.xml é…ç½® AOP

```xml
<beans>

    <bean id="userService" class="cn.bugstack.springframework.test.bean.UserService"/>

    <bean class="cn.bugstack.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator"/>

    <bean id="beforeAdvice" class="cn.bugstack.springframework.test.bean.UserServiceBeforeAdvice"/>

    <bean id="methodInterceptor" class="cn.bugstack.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor">
        <property name="advice" ref="beforeAdvice"/>
    </bean>

    <bean id="pointcutAdvisor" class="cn.bugstack.springframework.aop.aspectj.AspectJExpressionPointcutAdvisor">
        <property name="expression" value="execution(* cn.bugstack.springframework.test.bean.IUserService.*(..))"/>
        <property name="advice" ref="methodInterceptor"/>
    </bean>

</beans>
```

- è¿™å›å†ä½¿ç”¨ AOP å°±å¯ä»¥åƒ Spring ä¸­ä¸€æ ·ï¼Œé€šè¿‡åœ¨ xml ä¸­é…ç½®å³å¯ã€‚å› ä¸ºæˆ‘ä»¬å·²ç»æŠŠ AOP çš„åŠŸèƒ½èåˆåˆ° Bean çš„ç”Ÿå‘½å‘¨æœŸé‡Œå»äº†ï¼Œä½ çš„æ–°å¢æ‹¦æˆªæ–¹æ³•éƒ½ä¼šè¢«è‡ªåŠ¨å¤„ç†ã€‚

### 4. å•å…ƒæµ‹è¯•

```java
@Test
public void test_aop() {
    ClassPathXmlApplicationContext applicationContext = new ClassPathXmlApplicationContext("classpath:spring.xml");
    IUserService userService = applicationContext.getBean("userService", IUserService.class);
    System.out.println("æµ‹è¯•ç»“æœï¼š" + userService.queryUserInfo());
}
```

- åœ¨å•å…ƒæµ‹è¯•ä¸­ä½ åªéœ€è¦æŒ‰ç…§æ­£å¸¸è·å–å’Œä½¿ç”¨ Bean å¯¹è±¡å³å¯ï¼Œä¸è¿‡è¿™ä¸ªæ—¶å€™å¦‚æœè¢«åˆ‡é¢æ‹¦æˆªäº†ï¼Œé‚£ä¹ˆå…¶å®ä½ è·å–åˆ°çš„å°±æ˜¯å¯¹åº”çš„ä»£ç†å¯¹è±¡é‡Œé¢çš„å¤„ç†æ“ä½œäº†ã€‚

**æµ‹è¯•ç»“æœ**

![](https://bugstack.cn/assets/images/spring/spring-13-03.png)

```java
æ‹¦æˆªæ–¹æ³•ï¼šqueryUserInfo
æµ‹è¯•ç»“æœï¼šå°å‚…å“¥ï¼Œ100001ï¼Œæ·±åœ³

Process finished with exit code 0
```

- é€šè¿‡æµ‹è¯•ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å·²ç»è®©æ‹¦æˆªæ–¹æ³•ç”Ÿæ•ˆäº†ï¼Œä¹Ÿä¸éœ€è¦è‡ªå·±æ‰‹åŠ¨å¤„ç†åˆ‡é¢ã€æ‹¦æˆªæ–¹æ³•ç­‰å†…å®¹ã€‚*æˆªå›¾ä¸Šå¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ—¶å€™çš„ IUserService å°±æ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡*

## å…­ã€æ€»ç»“

- æœ¬ç« èŠ‚å®ç° AOP åŠŸèƒ½çš„å¤–åœ¨ä½“ç°ä¸»è¦æ˜¯æŠŠä»¥å‰è‡ªå·±åœ¨å•å…ƒæµ‹è¯•ä¸­çš„åˆ‡é¢æ‹¦æˆªï¼Œäº¤ç»™ Spring çš„ xml é…ç½®äº†ï¼Œä¹Ÿå°±ä¸éœ€è¦è‡ªå·±æ‰‹åŠ¨å¤„ç†äº†ã€‚é‚£ä¹ˆè¿™é‡Œæœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„çŸ¥è¯†ç‚¹ï¼Œå°±æ˜¯æŠŠç›¸åº”çš„åŠŸèƒ½å¦‚ä½•ä¸ Spring çš„ Bean ç”Ÿå‘½å‘¨æœŸç»“åˆèµ·æ¥ï¼Œæœ¬ç« èŠ‚ç”¨åˆ°çš„ BeanPostProcessorï¼Œå› ä¸ºå®ƒå¯ä»¥è§£å†³åœ¨ Bean å¯¹è±¡æ‰§è¡Œåˆå§‹åŒ–æ–¹æ³•ä¹‹å‰ï¼Œç”¨äºä¿®æ”¹æ–°å®ä¾‹åŒ– Bean å¯¹è±¡çš„æ‰©å±•ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå°±å¯ä»¥å¤„ç†è‡ªå·±çš„ AOP ä»£ç†å¯¹è±¡é€»è¾‘äº†ã€‚
- ä¸€ä¸ªåŠŸèƒ½çš„å®ç°å¾€å¾€åŒ…æ‹¬æ ¸å¿ƒéƒ¨åˆ†ã€ç»„è£…éƒ¨åˆ†ã€é“¾æ¥éƒ¨åˆ†ï¼Œä¸ºäº†è¿™äº›å„è‡ªèŒè´£çš„åˆ†å·¥ï¼Œåˆ™éœ€è¦åˆ›å»ºæ¥å£å’Œç±»ï¼Œç”±ä¸åŒå…³ç³»çš„ç»§æ‰¿ã€å®ç°è¿›è¡Œç»„è£…ã€‚åªæœ‰æ˜ç¡®äº†å„ä¸ªèŒè´£åˆ†å·¥ï¼Œæ‰å¥½çµæ´»çš„æ‰©å±•ç›¸åº”çš„åŠŸèƒ½é€»è¾‘ï¼Œå¦åˆ™å¾ˆéš¾é©¾é©­å¤§å‹ç³»ç»Ÿçš„å¼€å‘å’Œå»ºè®¾ï¼Œä¹Ÿå°±æ˜¯é‚£ç§ä¸å¥½æŠŠæ¡çš„æ„Ÿè§‰ã€‚
- ç›®å‰æˆ‘ä»¬å®ç°çš„ AOP ä¸ Spring æºç ä¸­çš„æ ¸å¿ƒé€»è¾‘æ˜¯ç±»ä¼¼çš„ï¼Œä½†æ›´ä¼šåç®€å•ä¸€äº›ï¼Œä¹Ÿä¸ä¼šè€ƒè™‘æ›´å¤šçš„å¤æ‚åœºæ™¯é‡åˆ°çš„é—®é¢˜ï¼ŒåŒ…æ‹¬æ˜¯å¦æœ‰æ„é€ å‡½æ•°ã€æ˜¯å¦ä¸ºä»£ç†ä¸­çš„åˆ‡é¢ç­‰ã€‚å…¶å®ä¹Ÿå¯ä»¥çœ‹å‡ºåªè¦æ˜¯ Java ä¸­çš„ä¸€äº›ç‰¹æ€§ï¼Œéƒ½éœ€è¦åœ¨çœŸå®ä½¿ç”¨çš„ Spring ä¸­è¿›è¡Œå®Œæ•´çš„å®ç°ï¼Œå¦åˆ™åœ¨ä½¿ç”¨è¿™äº›åŠŸèƒ½çš„æ—¶å€™å°±ä¼šé‡åˆ°å„ç§é—®é¢˜ã€‚

## ä¸ƒã€ä¼˜ç§€ä½œä¸š

- [å®šä¹‰ Adviceé€šçŸ¥ æ‹¦æˆªå™¨é“¾ @Ray](https://t.zsxq.com/05B2vRvzr)
- [å·²ç»é€šè¿‡ä¸€äº›åŒ…è£…ç±»å°†åˆ‡ç‚¹ä¿¡æ¯è¿›è¡ŒåŒ…è£…ï¼Œä½¿ç”¨jdkå’Œcglibè¿›è¡ŒåŠ¨æ€ä»£ç† @W](https://t.zsxq.com/06Ybq3fE2)
- [å€Ÿç€ BeanPostProcessorï¼ˆè¯¥æ¥å£çš„å®ç°ç±»æä¾›çš„æ–¹æ³•å¯ä»¥ä½œç”¨äºBeanå¯¹è±¡æ‰§è¡Œåˆå§‹åŒ–å‰åï¼Œä¿®æ”¹Beanå¯¹è±¡çš„æ‰©å±•ä¿¡æ¯ï¼‰ æŠŠåŠ¨æ€ä»£ç†èå…¥åˆ° Bean çš„ç”Ÿå‘½å‘¨æœŸä¸­ @liuc](https://t.zsxq.com/081HcrZMA)