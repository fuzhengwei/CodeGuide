---
layout: post
category: itstack-demo-any
title: æºç åˆ†æ | å’‹å˜ï¼Ÿä½ çš„IDEAè¿‡æœŸäº†å§ï¼åŠ ä¸ªJaråŒ…å°±ç ´è§£äº†ï¼Œä¸ºä»€ä¹ˆï¼Ÿ
tagline: by ä»˜æ”¿å§”
tag: [itstack-demo-code,itstack-demo-any]
excerpt: å½“ä½ è¿‡äº†å…ƒæ—¦ï¼Œçˆ½äº†å‘¨æœ«ï¼Œæ¸…æ—©ä¸Šç­ï¼Œæ‹¿èµ·æ¯å­ï¼ŒåŠ ç‚¹æ–°(è–ª)æ°´ï¼Œæ‰“å¼€ç”µè„‘ï¼Œæ”¶èµ·çƒ¦æ¼ï¼Œç¿˜èµ·å°è„šï¼Œä¸Šæ‰¬å˜´è§’ã€‚ä¸€åˆ‡å°±ç»ªéƒ½å‡†å¤‡å¥½ï¼Œå¥½ï¼æ’¸ä»£ç ï¼å•Šï¼ï¼ï¼IDEA duang duang duangï¼Œè¿‡æœŸäº†ï¼
lock: need
---

# æºç åˆ†æ | å’‹å˜ï¼Ÿä½ çš„IDEAè¿‡æœŸäº†å§ï¼åŠ ä¸ªJaråŒ…å°±ç ´è§£äº†ï¼Œä¸ºä»€ä¹ˆï¼Ÿ

ä½œè€…ï¼šå°å‚…å“¥
<br/>åšå®¢ï¼š[https://bugstack.cn](https://bugstack.cn)

> æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„

## ä¸€ã€å‰è¨€ä»‹ç»
2020å¹´äº†ï¼Œå¯¹äºä¸€ä¸ªç¨‹åºçŒ¿æ¥è¯´ï¼›

```java
2020 = 1024 + 996 | 404 + 404 + 404 + 404 + 404
2021 = 1024 + 997
2022 = 1024 + 9106
2023 = 1024 + 9107
...
20xx = ä»ä»Šå¹´å¼€å§‹å¯æ€•
```

å½“ä½ è¿‡äº†å…ƒæ—¦ï¼Œçˆ½äº†å‘¨æœ«ï¼Œæ¸…æ—©ä¸Šç­ï¼Œæ‹¿èµ·æ¯å­ï¼ŒåŠ ç‚¹æ–°(è–ª)æ°´ï¼Œæ‰“å¼€ç”µè„‘ï¼Œæ”¶èµ·çƒ¦æ¼ï¼Œç¿˜èµ·å°è„šï¼Œä¸Šæ‰¬å˜´è§’ã€‚ä¸€åˆ‡å°±ç»ªéƒ½å‡†å¤‡å¥½ï¼Œå¥½ï¼æ’¸ä»£ç ï¼å•Šï¼ï¼ï¼IDEA duang duang duangï¼Œè¿‡æœŸäº†ï¼

![å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ & IDEA è¿‡æœŸ](https://bugstack.cn/assets/images/pic-content/2019/11/itstack-demo-code-idea-03.png)

è„‘ç“œä¸€çƒ­èµ¶ç´§æœç´¢ç ´è§£ç ï¼›
- ç¬¬ä¸€ä¸ªï¼Œå¤±è´¥
- ç¬¬äºŒä¸ªï¼Œå¤±è´¥
- ç¬¬ä¸‰ä¸ªï¼Œå¤±è´¥
- ...
- ç¬¬Nä¸ªï¼Œç»ˆäºï¼Œç ´è§£äº†ä¸‰ä¸ªæœˆï¼Œå…ˆç”¨ç€ï¼Œå…ˆç”¨ç€ï¼Œä»¥åå†è¯´ï¼

å¯èƒ½å¤§éƒ¨åˆ†ä¼™ä¼´éƒ½åœ¨æœå„ç§ä¸€å †ä¸€å¤§ä¸²çš„ç ´è§£ç å¾€é‡Œé¢ç²˜ï¼Œä¸€ä¸ªä¸ªè¯•åˆ°æœ€åç»ˆäºè¿‡äº†ã€‚ä½†ä¹Ÿæœ‰ä¸€éƒ¨åˆ†è€å¸æœºæ˜¯ä¸æœç ´è§£ç çš„ï¼Œä»–ä»¬ä½¿ç”¨jaråŒ…ç ´è§£ï¼Œæœ‰æ•ˆæœŸ100å¹´ã€‚

é‚£ä¹ˆï¼æœ¬æ–‡å¹¶ä¸å¼•å¯¼ç”¨æˆ·éƒ½å»ä½¿ç”¨ç ´è§£ç‰ˆï¼ŒåƒIDEAè¿™ä¹ˆä¼˜ç§€ï¼Œå…¶å®ç»™ä½ æä¾›äº†å¾ˆå¤šé€‰æ‹©ï¼›
1. å¦‚æœä½ æ˜¯å­¦ç”Ÿå¯ä»¥å…è´¹ä½¿ç”¨
2. åˆ†ä¸ºç¤¾åŒºåŠå’Œæ——èˆ°ç‰ˆï¼Œä½ å¯ä»¥ä½¿ç”¨ç¤¾åŒºç‰ˆ Free, open-source
3. ä¸€èˆ¬å¤§å…¬å¸éƒ½æ˜¯æœ‰æ­£ç‰ˆæˆæƒçš„ï¼Œå¯ä»¥ä½¿ç”¨
4. å¦‚æœä½ æœ‰å¼€æºé¡¹ç›®ä¹Ÿå¯ä»¥ç”³è¯· IDEA æˆæƒ

æ‰€ä»¥ï¼Œä¸ªäººå¼€å‘ä½¿ç”¨ç¤¾åŒºç‰ˆæœ¬å³å¯ï¼Œä¸è¦ä½¿ç”¨ç ´è§£ã€‚

å¥½ï¼å›å½’æ­£é¢˜ï¼Œæœ¬æ–‡ä¸»è¦è®²è§£æ˜¯ä¸ºä»€ä¹ˆæ”¾ä¸ªJaråŒ…å°±èƒ½ç ´è§£ï¼Œæœ€ååœ¨ä½¿ç”¨ä¸€ä¸ªjarè¿›è¡Œç ´è§£æ¼”ç¤ºã€‚åœ¨ä»¥ä¸‹ç« èŠ‚ä¸­ä½ å¯ä»¥å­¦ä¹ åˆ°å¦‚ä¸‹çŸ¥è¯†ï¼›
- Java Agent éç¡¬ç¼–ç å¼ä»£ç†ç±»ï¼Œè¿™ä¹Ÿå°±æ˜¯å¸¸è¯´çš„æ¢é’ˆæŠ€æœ¯
- ASM å­—èŠ‚ç ç¼–ç¨‹ç®€å•ä½¿ç”¨
- å·¥ç¨‹æ‰“åŒ…é¢å¤–åŠ è½½å…¶ä»– jar æ–¹æ³•
- æœ€åæ˜¯ä¸€ä¸ªç ´è§£æ¼”ç¤ºï¼Œä»…é€‚åˆä¸ªäººå­¦ä¹ ä½¿ç”¨

## äºŒã€æ¡ˆä¾‹å·¥ç¨‹

æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæ¡ˆä¾‹å·¥ç¨‹æ¥æ¨¡æ‹Ÿç ´è§£è¿‡ç¨‹æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Œå…¶å®æ¯ä¸ªç‰ˆæœ¬çš„IDEAéƒ½åœ¨å¢å¼ºé˜²æŠ¤æœºåˆ¶ï¼Œç ´è§£ä¹Ÿè¶Šæ¥è¶Šéš¾ã€‚

```java
itstack-demo-code-idea
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â”œâ”€â”€ java
    â”‚   â”‚   â””â”€â”€ org.itstack.demo
    â”‚   â”‚       â””â”€â”€ JetbrainsCrack.java
    â”‚   â””â”€â”€ resources	
    â”‚       â””â”€â”€ META-INF	
    â”‚           â””â”€â”€ MANIFEST.MF
    â””â”€â”€ test
         â””â”€â”€ java
             â”œâ”€â”€ com.jetbrains.ls.newLicenses
             â”‚   â””â”€â”€ DecodeCertificates.java			 
             â””â”€â”€ org.itstack.demo.test
                 â””â”€â”€ ApiTest.java
```

## ä¸‰ã€ç¯å¢ƒé…ç½®
1. JDK 1.8
2. IDEA 2019.3.1
3. asm-all 3.3.1

## å››ã€ä»£ç è®²è¿°

åœ¨æ¡ˆä¾‹ä¸­æˆ‘ä»¬æ¨¡æ‹Ÿ IDEA æœ‰ä¸€ä¸ª DecodeCertificates ç±»ï¼Œç”¨äºåšæˆæƒç æ ¡éªŒã€‚ä¹‹åé€šè¿‡æˆ‘ä»¬çš„ java agent ç¼–ç¨‹æ¨¡æ‹Ÿæˆæƒè¢«ç ´è§£ã€‚

### 1. Java Agent ä»‹ç» 
åœ¨ JDK1.5 ä»¥åï¼ŒJVM æä¾›äº† agent æŠ€æœ¯æ„å»ºä¸€ä¸ªç‹¬ç«‹äºåº”ç”¨ç¨‹åºçš„ä»£ç†ç¨‹åºï¼ˆå³ä¸ºAgentï¼‰ï¼Œç”¨æ¥ååŠ©ç›‘æµ‹ã€è¿è¡Œç”šè‡³æ›¿æ¢å…¶ä»–JVMä¸Šçš„ç¨‹åºã€‚ä½¿ç”¨å®ƒå¯ä»¥å®ç°è™šæ‹Ÿæœºçº§åˆ«çš„AOPåŠŸèƒ½ã€‚

### 2. ASM ä»‹ç»
ASM æ˜¯ä¸€ä¸ª JAVA å­—èŠ‚ç åˆ†æã€åˆ›å»ºå’Œä¿®æ”¹çš„å¼€æºåº”ç”¨æ¡†æ¶ã€‚åœ¨ ASM ä¸­æä¾›äº†è¯¸å¤šçš„APIç”¨äºå¯¹ç±»çš„å†…å®¹è¿›è¡Œå­—èŠ‚ç æ“ä½œçš„æ–¹æ³•ã€‚ä¸ä¼ ç»Ÿçš„ BCEL å’Œ SERL ä¸åŒï¼Œåœ¨ ASM ä¸­æä¾›äº†æ›´ä¸ºä¼˜é›…å’Œçµæ´»çš„æ“ä½œå­—èŠ‚ç çš„æ–¹å¼ã€‚ç›®å‰ ASM å·²è¢«å¹¿æ³›çš„å¼€æºåº”ç”¨æ¶æ„æ‰€ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼šSpringã€Hibernate ç­‰ã€‚

### 3. å¼€å§‹æˆ‘ä»¬çš„æ¨¡æ‹Ÿç ´è§£ä¹‹è·¯

>JetbrainsCrack.java & Agent æ“ä½œç±»

```java
/**
 * åšå®¢ï¼šhttp://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ›´å¤šåŸå¤„ä¼˜è´¨å¹²è´§
 * Agent ç±»ï¼Œæ‰€æœ‰ç¨‹åºå¯åŠ¨åªè¦é…ç½®äº† -javaagent: éƒ½ä¼šèµ°åˆ° premain æ–¹æ³•
 */
public class JetbrainsCrack {

    public static void premain(String args, Instrumentation inst) {
        System.out.println("**************************************");
        System.out.println("*       å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ       *");
        System.out.println("*     åšå®¢ï¼šhttps://bugstack.cn      *");
        System.out.println("*   ä½ ç”¨å‰‘ï¼Œæˆ‘ç”¨åˆ€ï¼Œå¥½çš„ä»£ç éƒ½å¾ˆçƒ§ï¼ *");
        System.out.println("**************************************");
        inst.addTransformer(new MethodEntryTransformer());
    }

    static class MethodEntryTransformer implements ClassFileTransformer {

        private Logger logger = LoggerFactory.getLogger(MethodEntryTransformer.class);

        public byte[] transform(ClassLoader loader, String className, Class<?> classBeingRedefined, ProtectionDomain protectionDomain, byte[] classfileBuffer) throws IllegalClassFormatException {

            try {
                if (className.equals("com/jetbrains/ls/newLicenses/DecodeCertificates")) {
                    ClassReader cr = new ClassReader(classfileBuffer);
                    ClassNode cn = new ClassNode();
                    cr.accept(cn, 0);
                    List<MethodNode> methodNodes = cn.methods;
                    for (MethodNode methodNode : methodNodes) {
                        if ("decodeLicense".equals(methodNode.name)) {
                            InsnList insns = methodNode.instructions;
                            //æ¸…é™¤æŒ‡ä»¤
                            insns.clear();
                            insns.add(new VarInsnNode(Opcodes.ALOAD, 1)); // å°†æœ¬åœ°æŒ‡å®šçš„å¼•ç”¨å­˜å…¥æ ˆä¸­
                            insns.add(new InsnNode(Opcodes.ARETURN));          // ä»æ–¹æ³•ä¸­è¿”å›å¼•ç”¨ç±»å‹çš„æ•°æ®
                            // è®¿é—®ç»“æŸ
                            methodNode.visitEnd();
                            ClassWriter cw = new ClassWriter(0);
                            cn.accept(cw);
                            byte[] bytes = cw.toByteArray();
                            // è¾“å‡ºå­—èŠ‚ç åˆ°Class
                            this.outputClazz(bytes);
                            // è¿”å›æœ€æ–°å­—èŠ‚ç 
                            return cw.toByteArray();
                        }
                    }
                }
            } catch (Exception e) {
                return classfileBuffer;
            }

            return classfileBuffer;
        }

        private void outputClazz(byte[] bytes) {
            // è¾“å‡ºç±»å­—èŠ‚ç 
            FileOutputStream out = null;
            try {
                out = new FileOutputStream("ASMDecodeCertificates.class");
                logger.info("ASMç±»è¾“å‡ºè·¯å¾„ï¼š{}", (new File("")).getAbsolutePath());
                out.write(bytes);
            } catch (Exception e) {
                e.printStackTrace();
            } finally {
                if (null != out) try {
                    out.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }

    }

}
```

- åœ¨è¿™ä¸ªç±»ä¸­å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª premain æ–¹æ³•ï¼Œè¿™ä¸ªæ˜¯åœ¨è¢« java agent å¤„ç†åçš„ç¨‹åºå…¥å£ï¼Œæ‰€æœ‰ä¿¡æ¯ç±»å’Œæ–¹æ³•éƒ½ä¼šåˆ°è¿™ä¸ªå…¥å£
- ä¹‹åæˆ‘ä»¬ä½¿ç”¨ inst.addTransformer(new MethodEntryTransformer()); æ·»åŠ æˆ‘ä»¬è‡ªå·±çš„å¤„ç†é€»è¾‘ï¼Œè¿™ä¸ªé€»è¾‘ä¹Ÿæ˜¯ç”¨å­—èŠ‚ç ç¼–ç¨‹æŠ€æœ¯ä»£ç†ç±»çš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³æ—¶å¼€å‘ä¸­é‚£äº›ä¸éœ€ç¡¬ç¼–ç å°±å¯ä»¥ç›‘æ§æ–¹æ³•æ‰§è¡Œæ—¶é•¿çš„é€»è¾‘ä¸€æ ·
- MethodEntryTransformer å®ç°äº† ClassFileTransformer çš„ transform æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯çœŸæ­£æ“ä½œå­—èŠ‚ç çš„è¿‡ç¨‹ã€‚
	- åœ¨è¿™ä¸ªç±»æ–¹æ³•ä¸­é¦–å…ˆéœ€è¦æ‰¾åˆ°æˆ‘ä»¬çš„æˆæƒç æ ¡éªŒç±» com/jetbrains/ls/newLicenses/DecodeCertificates ï¼Œæ¯ä¸€ä¸ªç‰ˆæœ¬çš„IDEAä¸ä¸€æ ·ï¼ŒåŒæ—¶æˆæƒé€»è¾‘æ ¡éªŒä¹Ÿä¸ä¸€æ ·
	- ç´§æ¥ç€åœ¨æ‰¾åˆ°æˆæƒæ ¡éªŒç±»é‡Œé¢çš„æ ¡éªŒæ–¹æ³•ï¼Œif ("decodeLicense".equals(methodNode.name))
	- æ¥ä¸‹æ¥å°±éœ€è¦å¯¹å­—èŠ‚ç è¿›è¡Œå¤„ç†äº†ï¼Œè¿™é‡Œé¢çš„å¤„ç†è¿‡ç¨‹æ¯”è¾ƒç²—æš´ï¼Œç›´æ¥å°†åŸæ¥æ–¹æ³•é‡Œçš„æŒ‡ä»¤å†…å®¹æ¸…ç©ºã€‚ç„¶åä½¿ç”¨ new VarInsnNode(Opcodes.ALOAD, 1) å°†æœ¬åœ°æŒ‡å®šçš„å¼•ç”¨å­˜å…¥æ ˆä¸­
	- ä¹‹åå°†æˆ‘ä»¬çš„å…¥å‚å†…å®¹ç›´æ¥è¿”å›ï¼Œnew InsnNode(Opcodes.ARETURN)ï¼Œä»æ–¹æ³•ä¸­è¿”å›å¼•ç”¨ç±»å‹çš„æ•°æ®ã€‚åœ¨ä»¥å¾€æ—§ç‰ˆæœ¬çš„ IDEA ç ´è§£ä¸­æ¯”è¾ƒç®€å•ï¼Œç›´æ¥æŠŠæœ€ç»ˆéœ€è¦çš„ç ´è§£å†…å®¹è¿”å›å³å¯ï¼Œé‡Œé¢æè¿°äº† IDEA å„ä¸ªè½¯ä»¶çš„ä½¿ç”¨æœŸé™
	- æœ€ç»ˆå°†æˆ‘ä»¬å¤„ç†åçš„å­—èŠ‚ç è¿”å›ç»™æ–¹æ³•ï¼Œreturn cw.toByteArray();è¿™ä¸ªæ—¶å€™è™½ç„¶ä½ å¤§çˆ·è¿˜æ˜¯ä½ å¤§çˆ·ï¼Œä½†ä½ å¤§å¨˜å·²ç»ä¸æ˜¯ä½ å¤§å¨˜äº†
- ä¸ºäº†æµ‹è¯•çš„éªŒè¯æˆ‘ä»¬å°†å˜æ›´åçš„å­—èŠ‚ç ä»£ç (å¤§å¨˜)è¾“å‡ºåˆ°å·¥ç¨‹ç›®å½•ä¸‹ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª class æ–‡ä»¶ï¼Œä¸‹æ–‡æµ‹è¯•æ—¶å€™éªŒè¯
	
### 4. DecodeCertificates.java & æ¨¡æ‹Ÿ ideaIU-15.0.1 è½¯ä»¶æˆæƒç æ ¡éªŒç±»	
	
```java
public class DecodeCertificates {

    public String decodeLicense(String usingKey) {
        // æ¨¡æ‹Ÿæ ¡éªŒæˆæƒç 
        return "usingKey is errorï¼š"+ usingKey;
    }

}
```	

- è¿™ä¸ªç±»æ¯”è¾ƒç®€å•åªæ˜¯æ¨¡æ‹Ÿæœ‰è¿™ä¹ˆä¸ªæ–¹æ³•ç”¨äºæ ¡éªŒæˆæƒç 
	
### 5. ApiTest.java & æµ‹è¯•ç±»

```java
/**
 * åšå®¢ï¼šhttp://bugstack.cn
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ | æ›´å¤šåŸå¤„ä¼˜è´¨å¹²è´§
 * æµ‹è¯•ç±»é…ç½® VM å‚æ•°
 * Idea VM optionsï¼š-javaagent:E:\itstack\GIT\itstack.org\itstack-demo-code\itstack-demo-code-idea\target\itstack-demo-code-idea-1.0-SNAPSHOT.jar
 */
public class ApiTest {

    private static Logger logger = LoggerFactory.getLogger(ApiTest.class);

    public static void main(String[] args) throws Exception {
        DecodeCertificates decodeCertificates = new DecodeCertificates();
        // æ¨¡æ‹ŸusingKeyï¼šè®¤è´­æœ‰æ•ˆæœŸè‡³2089å¹´7æœˆ8æ—¥
        String license = decodeCertificates.decodeLicense("Subscription is active until July 8, 2089");
        logger.info("æµ‹è¯•ç»“æœï¼š{}", license);
    }

}
```	
	
### 6. MANIFEST.MF é…ç½®å¼•å¯¼å¯åŠ¨æ—¶åŠ è½½

```java
Manifest-Version: 1.0
Premain-Class: org.itstack.demo.JetbrainsCrack
Can-Redefine-Classes: true

```

### 7. POM é…ç½®æ‰“åŒ…æ—¶åŠ å…¥ASMåŒ…

```java
<!-- å°†javassiståŒ…æ‰“åŒ…åˆ°Agentä¸­ -->
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-shade-plugin</artifactId>
    <executions>
        <execution>
            <phase>package</phase>
            <goals>
                <goal>shade</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <artifactSet>
            <includes>
                <include>asm:asm-all:jar:</include>
            </includes>
        </artifactSet>
    </configuration>
</plugin>
```

## äº”ã€å·¥ç¨‹æµ‹è¯•

1. å…ˆå•çº¯çš„ç›´æ¥è¿è¡ŒApiTest.java ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹(æ¨¡æ‹Ÿè¿”å›æˆæƒä¸å¯ç”¨)ï¼›

	```java
	21:23:46.101 [main] INFO  org.itstack.demo.test.ApiTest - æµ‹è¯•ç»“æœï¼šusingKey is errorï¼šSubscription is active until July 8, 2089
	```

2. ç¬¬äºŒæ­¥æµ‹è¯•å‰å…ˆæ‰“åŒ…ä¸‹å·¥ç¨‹ï¼Œè¿™ä¸ªæ—¶å€™ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹ç»“æœï¼›

	```java
	[INFO] --- maven-install-plugin:2.4:install (default-install) @ itstack-demo-code-idea ---
	[INFO] Installing E:\itstack\GIT\itstack.org\itstack-demo-code\itstack-demo-code-idea\target\itstack-demo-code-idea-1.0-SNAPSHOT.jar to D:\Program Files (x86)\apache-maven-3.6.2\repository\org\itstack\demo\itstack-demo-code-idea\1.0-SNAPSHOT\itstack-demo-code-idea-1.0-SNAPSHOT.jar
	[INFO] Installing E:\itstack\GIT\itstack.org\itstack-demo-code\itstack-demo-code-idea\dependency-reduced-pom.xml to D:\Program Files (x86)\apache-maven-3.6.2\repository\org\itstack\demo\itstack-demo-code-idea\1.0-SNAPSHOT\itstack-demo-code-idea-1.0-SNAPSHOT.pom
	[INFO] Installing E:\itstack\GIT\itstack.org\itstack-demo-code\itstack-demo-code-idea\target\itstack-demo-code-idea-1.0-SNAPSHOT-sources.jar to D:\Program Files (x86)\apache-maven-3.6.2\repository\org\itstack\demo\itstack-demo-code-idea\1.0-SNAPSHOT\itstack-demo-code-idea-1.0-SNAPSHOT-sources.jar
	[INFO] ------------------------------------------------------------------------
	[INFO] BUILD SUCCESS
	[INFO] ------------------------------------------------------------------------
	[INFO] Total time:  3.080 s
	[INFO] Finished at: 2020-01-05T23:25:08+08:00
	[INFO] ------------------------------------------------------------------------
	```

- è¿™é‡Œçš„ itstack-demo-code-idea-1.0-SNAPSHOT.jar å°±æ˜¯æˆ‘ä»¬çš„ Agent åŒ…ï¼ŒæŒ‰å®é™…æƒ…å†µå¤åˆ¶è‡ªå·±çš„è·¯å¾„

3. é…ç½® VM optionsï¼š-javaagent:E:\itstack\GIT\itstack.org\itstack-demo-code\itstack-demo-code-idea\target\itstack-demo-code-idea-1.0-SNAPSHOT.jar

	![å¾®ä¿¡å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ & IDEA VM options](https://bugstack.cn/assets/images/pic-content/2019/11/itstack-demo-code-idea-02.png)

4. è¿è¡Œ ApiTest æµ‹è¯•ï¼Œæ­£ç¡®ç»“æœå¦‚ä¸‹ï¼›

	```java
	23:29:42.803 [main] INFO  org.itstack.demo.test.ApiTest - æµ‹è¯•ç»“æœï¼šusingKey is errorï¼šSubscription is active until July 8, 2089

	Process finished with exit code 0
	```

- è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ä½ ä½¿ç”¨ jar åŒ…ç ´è§£ IDEA çš„è¿‡ç¨‹ï¼Œäº†è§£è¿™ä¸ªæŠ€æœ¯ç‚¹å¯ä»¥ç”¨åœ¨å¾ˆå¤šä¸éœ€è¦ç¡¬ç¼–ç å°±èƒ½åšåˆ°çš„æœåŠ¡ä¸­ï¼Œæ¯”å¦‚ç›‘æ§ï¼Œè°ƒè¯•ç­‰

5. åˆ«å¿˜äº†æˆ‘ä»¬è¿˜åœ¨ Agent ä¸­è¾“å‡ºäº†æ–°çš„å­—èŠ‚ç ï¼Œçœ‹çœ‹è¿™ä¸ªæ—¶å€™çš„ç±»æ˜¯ä»€ä¹ˆæ ·(ä½ å¤§çˆ·è¿˜æ˜¯ä½ å¤§çˆ·ï¼Œä½†ä½ å¤§å¨˜å¯ä¸æ˜¯ä½ å¤§å¨˜äº†)

>è¢«ä»£ç†å‰

```java
public class DecodeCertificates {

	public String decodeLicense(String usingKey) {
		// æ¨¡æ‹Ÿæ ¡éªŒæˆæƒç 
		return "usingKey is errorï¼š"+ usingKey;
	}

}
```


>è¢«ä»£ç†å

```java
package com.jetbrains.ls.newLicenses;

public class DecodeCertificates {
	public DecodeCertificates() {
	}

	public String decodeLicense(String usingKey) {
		return usingKey;
	}
}
```

## å…­ã€ç»¼ä¸Šæ€»ç»“

- å»ºè®®ä¸ªäººä½¿ç”¨ç¤¾åŒºç‰ˆå³å¯ï¼Œä¸è¦å°è¯•ç ´è§£å°Šé‡IDEAï¼Œæœ¬æ–‡åªä¸ºå­¦ä¹  javaagent æŠ€æœ¯
- ASM è¿™ä¸ªä¸œè¥¿ç‰¹åˆ«å¼ºå¤§ï¼Œå…¶å®å­—èŠ‚ç ç¼–ç¨‹è¿˜æœ‰ javassistï¼Œåœ¨ä¸€èµ· RPC æ¡†æ¶ä¸­æœ‰éå¸¸å¤šçš„ä½¿ç”¨
- å…³äº java agent æˆ‘å·²ç»ä¸“é¢˜æ–¹å¼å†™è¿‡æ¡ˆä¾‹æ–‡ç« ï¼Œå¯ä»¥å‚è€ƒï¼›https://bugstack.cn/itstack-demo-agent/itstack-demo-agent.html
