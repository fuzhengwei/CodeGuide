---
layout: post
category: interview
title: é¢ç»æ‰‹å†Œ Â· ç¬¬10ç¯‡ã€Šæ‰«ç›²java.util.Collectionså·¥å…·åŒ…ï¼Œå­¦ä¹ æ’åºã€äºŒåˆ†ã€æ´—ç‰Œã€æ—‹è½¬ç®—æ³•ã€‹
tagline: by å°å‚…å“¥
tag: [java,interview]
excerpt: ğŸ‘¨ä¼ é“æˆä¸šè§£æƒ‘ï¼Œæ„Ÿæ©æ•™å¸ˆèŠ‚ï¼å­¦ä¹ æ•°æ®ç»“æ„ã€ç®—æ³•ã€è®¾è®¡æ¨¡å¼ï¼Œè¿™ä¸‰æ–¹é¢çš„çŸ¥è¯†ï¼Œé‡ç‚¹è¿˜æ˜¯èƒ½è½åœ°åˆ°æ—¥å¸¸çš„ä¸šåŠ¡å¼€å‘ä¸­ï¼Œå¦åˆ™ç©ºã€å‡ã€è™šï¼Œåªèƒ½é€‚åˆå¹å¹ç‰›ï¼Œå¹¶ä¸ä¼šç»™é¡¹ç›®ç ”å‘å¸¦æ¥å®é™…çš„ä»·å€¼ã€‚
lock: need
---

# é¢ç»æ‰‹å†Œ Â· ç¬¬10ç¯‡ã€Šæ‰«ç›²java.util.Collectionså·¥å…·åŒ…ï¼Œå­¦ä¹ æ’åºã€äºŒåˆ†ã€æ´—ç‰Œã€æ—‹è½¬ç®—æ³•ã€‹

ä½œè€…ï¼šå°å‚…å“¥
<br/>åšå®¢ï¼š[https://bugstack.cn](https://bugstack.cn)

>æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„

## ä¸€ã€å‰è¨€

`ç®—æ³•æ˜¯æ•°æ®ç»“æ„çš„çµé­‚ï¼`

å¥½çš„ç®—æ³•æ­é…ä¸Šåˆé€‚çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥è®©ä»£ç åŠŸèƒ½å¤§å¤§çš„æå‡æ•ˆç‡ã€‚å½“ç„¶ï¼Œç®—æ³•å­¦ä¹ ä¸åªæ˜¯åˆ·é¢˜ï¼Œè¿˜éœ€è¦è½åœ°ä¸åº”ç”¨ï¼Œå¦åˆ™åˆ°äº†å†™ä»£ç çš„æ—¶å€™ï¼Œè¿˜æ˜¯ä¼š`forå¾ªç¯`+`ifelse`ã€‚

å½“å¼€å‘ä¸€ä¸ªç¨å¾®å¤æ‚ç‚¹çš„ä¸šåŠ¡æµç¨‹æ—¶ï¼Œå¾€å¾€è¦ç”¨åˆ°ä¸ä¹‹å¥‘åˆçš„æ•°æ®ç»“æ„å’Œç®—æ³•é€»è¾‘ï¼Œåœ¨ä¸è®¾è®¡æ¨¡å¼ç»“åˆï¼Œè¿™æ ·æ—¢èƒ½è®©ä½ çš„å†™å‡ºå…·æœ‰é«˜æ€§èƒ½çš„ä»£ç ï¼Œä¹Ÿèƒ½è®©è¿™äº›ä»£ç å…·å¤‡è‰¯å¥½çš„æ‰©å±•æ€§ã€‚

åœ¨ä»¥å¾€çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬æŠŠJavaå¸¸ç”¨çš„æ•°æ®ç»“æ„åŸºæœ¬ä»‹ç»å®Œäº†ï¼Œéƒ½å·²æ”¶å½•åˆ°ï¼š[è·³è½¬ -> ã€Šé¢ç»æ‰‹å†Œã€‹](https://bugstack.cn/itstack/interview.html)ï¼Œç« èŠ‚å†…å®¹ä¸‹å›¾ï¼›
![](https://bugstack.cn/assets/images/2020/interview/interview-11-01.png)

**é‚£ä¹ˆ**ï¼Œæœ‰äº†è¿™äº›æ•°æ®ç»“æ„çš„åŸºç¡€ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å†å­¦ä¹ ä¸€ä¸‹Javaä¸­æä¾›çš„ç®—æ³•å·¥å…·ç±»ï¼Œ`Collections`ã€‚

## äºŒã€é¢è¯•é¢˜

`è°¢é£æœº`ï¼Œä»Šå¤©æ€ä¹ˆæ— ç²¾æ‰“é‡‡çš„å‘¢ï¼Œè¿˜æœ‰é»‘çœ¼åœˆï¼Ÿ

**ç­”**ï¼šå¥½å¤šçŸ¥è¯†ç›²åŒºå‘€ï¼Œæœ€è¿‘ä¸€ç›´åœ¨åŠªåŠ›è¡¥çŸ­æ¿ï¼Œè¿˜æœ‰[é¢ç»æ‰‹å†Œ](https://bugstack.cn/itstack/interview.html)é‡Œçš„æ•°æ®ç»“æ„ã€‚

**é—®**ï¼šé‚£æ•°æ®ç»“æ„çœ‹çš„å·®ä¸å¤šäº†å§ï¼Œä½ æœ‰è€ƒè™‘ğŸ¤”è¿‡ï¼Œæ•°æ®ç»“æ„é‡Œæ¶‰åŠçš„æ’åºã€äºŒåˆ†æŸ¥æ‰¾å—ï¼Ÿ

**ç­”**ï¼šäºŒåˆ†æŸ¥æ‰¾ä¼šä¸€äº›ï¼Œå·´æ‹‰å·´æ‹‰ã€‚

**é—®**ï¼šè¿˜ä¸é”™ï¼Œé‚£ä½ çŸ¥é“è¿™ä¸ªæ–¹æ³•åœ¨Javaä¸­æœ‰æä¾›å¯¹åº”çš„å·¥å…·ç±»å—ï¼Ÿæ˜¯å“ªä¸ªï¼

**ç­”**ï¼šè¿™ï¼ï¼Ÿå¥½åƒæ²¡æ³¨æ„è¿‡ï¼Œæ²¡ç”¨è¿‡ï¼

**é—®**ï¼šå»å§ï¼Œå›å®¶åœ¨çœ‹çœ‹ä¹¦ï¼Œè¿™ä¸¤å¤©ä¹Ÿä¼‘æ¯ä¸‹ã€‚

é£æœºæ‚„ç„¶çš„å‡ºé—¨äº†ï¼Œä½†è¿™æ¬¡é¢è¯•é¢˜æ•´ä½“å›ç­”çš„è¿˜æ˜¯ä¸é”™çš„ï¼Œé¢è¯•å®˜å†³å®šä¸‹æ¬¡å†ç»™ä»–ä¸€ä¸ªæœºä¼šã€‚

## ä¸‰ã€Collections å·¥å…·ç±»

`java.util.Collections`ï¼Œæ˜¯javaé›†åˆæ¡†æ¶çš„ä¸€ä¸ªå·¥å…·ç±»ï¼Œä¸»è¦ç”¨äº`Collection`æä¾›çš„é€šç”¨ç®—æ³•ï¼›æ’åºã€äºŒåˆ†æŸ¥æ‰¾ã€æ´—ç‰Œç­‰ç®—æ³•æ“ä½œã€‚

**ä»æ•°æ®ç»“æ„åˆ°å…·ä½“å®ç°ï¼Œå†åˆ°ç®—æ³•ï¼Œæ•´ä½“çš„ç»“æ„å¦‚ä¸‹å›¾ï¼›**

![](https://bugstack.cn/assets/images/2020/interview/interview-11-02.png)

### 1. Collections.sort æ’åº

#### 1.1 åˆå§‹åŒ–é›†åˆ

```java
List<String> list = new ArrayList<String>();
list.add("7");
list.add("4");
list.add("8");
list.add("3");
list.add("9");
```

#### 1.2 é»˜è®¤æ’åˆ—[æ­£åº]

```java
Collections.sort(list);

// æµ‹è¯•ç»“æœï¼š[3, 4, 7, 8, 9]
```

#### 1.3 Comparatoræ’åº

```java
Collections.sort(list, new Comparator<String>() {
    @Override
    public int compare(String o1, String o2) {
        return o2.compareTo(o1);
    }
});
```

- æˆ‘ä»¬ä½¿ç”¨ `o2` ä¸ `o1` åšå¯¹æ¯”ï¼Œè¿™æ ·ä¼šå‡ºæ¥ä¸€ä¸ªå€’å™æ’åºã€‚
- åŒæ—¶ï¼Œ`Comparator`è¿˜å¯ä»¥å¯¹å¯¹è±¡ç±»æŒ‰ç…§æŸä¸ªå­—æ®µè¿›è¡Œæ’åºã€‚
- æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼›

```java
[9, 8, 7, 4, 3]
```

#### 1.4 reverseOrderå€’æ’

```java
Collections.sort(list, Collections.<String>reverseOrder());

// æµ‹è¯•ç»“æœï¼š[9, 8, 7, 4, 3]
```

- `Collections.<String>reverseOrder()`çš„æºç éƒ¨åˆ†å°±å’Œæˆ‘ä»¬ä¸Šé¢æŠŠä¸¤ä¸ªå¯¹æ¯”çš„ç±»è°ƒæ¢è¿‡æ¥ä¸€æ ·ã€‚`c2.compareTo(c1);`

#### 1.5 æºç ç®€è¿°

å…³äºæ’åºæ–¹é¢çš„çŸ¥è¯†ç‚¹å¹¶ä¸å°‘ï¼Œè€Œä¸”æœ‰ç‚¹å¤æ‚ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç» `Collections` é›†åˆå·¥å…·ç±»ï¼Œåç»­å†æ·±å…¥æ¯ä¸€ä¸ªæ’åºç®—æ³•è¿›è¡Œè®²è§£ã€‚

**Collections.sort**

é›†åˆæ’åºï¼Œæœ€ç»ˆä½¿ç”¨çš„æ–¹æ³•ï¼š*Arrays.sort((E[]) elementData, 0, size, c);*

```java
public static <T> void sort(T[] a, int fromIndex, int toIndex,
                            Comparator<? super T> c) {
    if (c == null) {
        sort(a, fromIndex, toIndex);
    } else {
        rangeCheck(a.length, fromIndex, toIndex);
        if (LegacyMergeSort.userRequested)
            legacyMergeSort(a, fromIndex, toIndex, c);
        else
            TimSort.sort(a, fromIndex, toIndex, c, null, 0, 0);
    }
}
```

- è¿™ä¸€éƒ¨åˆ†æ’åºé€»è¾‘åŒ…æ‹¬äº†ï¼Œæ—§ç‰ˆçš„å½’å¹¶æ’åº `legacyMergeSort` å’Œ `TimSort` æ’åºã€‚
- ä½†å› ä¸ºå¼€å…³çš„ä½œç”¨ï¼Œ`LegacyMergeSort.userRequested = false`ï¼ŒåŸºæœ¬éƒ½æ˜¯èµ°åˆ° `TimSort` æ’åº ã€‚
- åŒæ—¶åœ¨æ’åºçš„è¿‡ç¨‹ä¸­è¿˜ä¼šå› ä¸ºå…ƒç´ çš„ä¸ªæ•°æ˜¯å¦å¤§äº`32`ï¼Œè€Œé€‰æ‹©`åˆ†æ®µæ’åº`å’Œ`äºŒåˆ†æ’å…¥æ’åº`ã€‚*è¿™ä¸€éƒ¨åˆ†å†…å®¹æˆ‘ä»¬åç»­ä¸“é—¨åœ¨æ’åºå†…å®¹è®²è§£*

### 2. Collections.binarySearch äºŒåˆ†æŸ¥æ‰¾

![å°å‚…å“¥ & Collections.binarySearch](https://bugstack.cn/assets/images/2020/interview/interview-11-03.png)

- çœ‹åˆ°è¿™å¼ å›¾ç†Ÿæ‚‰å—ï¼Œè¿™å°±æ˜¯é›†åˆå…ƒç´ ä¸­é€šè¿‡äºŒåˆ†æŸ¥æ‰¾å®šä½æŒ‡å®šå…ƒç´ 5ã€‚
- äºŒåˆ†æŸ¥æ‰¾çš„å‰ææ˜¯é›†åˆæœ‰åºï¼Œå¦åˆ™ä¸èƒ½æ»¡è¶³äºŒåˆ†ç®—æ³•çš„æŸ¥æ‰¾è¿‡ç¨‹ã€‚
- æŸ¥æ‰¾é›†åˆå…ƒç´ 5ï¼Œåœ¨è¿™ä¸ªé›†åˆä¸­åˆ†äº†ä¸‰éƒ¨ï¼›
	- ç¬¬ä¸€æ­¥ï¼Œ`(0 + 7) >>> 1 = 3`ï¼Œå®šä½ `list.get(3) = 4`ï¼Œåˆ™ç»§ç»­å‘å³ä¾§äºŒåˆ†æŸ¥æ‰¾ã€‚
	- ç¬¬äºŒæ­¥ï¼Œ`(4 + 7) >>> 1 = 5`ï¼Œå®šä½ `list.get(5) = 6`ï¼Œåˆ™ç»§ç»­å‘å·¦ä¾§äºŒåˆ†æŸ¥æ‰¾ã€‚
	- ç¬¬ä¸‰æ­¥ï¼Œ`(4 + 4) >>> 1 = 4`ï¼Œå®šä½  `list.get(4) = 5`ï¼Œæ‰¾åˆ°å…ƒç´ ï¼Œè¿”å›ç»“æœã€‚

#### 2.1 åŠŸèƒ½ä½¿ç”¨

```java
@Test
public void test_binarySearch() {
    List<String> list = new ArrayList<String>();
    list.add("1");
    list.add("2");
    list.add("3");
    list.add("4");
    list.add("5");
    list.add("6");
    list.add("7");
    list.add("8");
    
    int idx = Collections.binarySearch(list, "5");
    System.out.println("äºŒåˆ†æŸ¥æ‰¾ï¼š" + idx);
}
```

- æ­¤åŠŸèƒ½å°±æ˜¯ä¸Šå›¾ä¸­çš„å…·ä½“å®ç°æ•ˆæœï¼Œé€šè¿‡ `Collections.binarySearch` å®šä½å…ƒç´ ã€‚
- æµ‹è¯•ç»“æœï¼š`äºŒåˆ†æŸ¥æ‰¾ï¼š4`

#### 2.2 æºç åˆ†æ

```java
Collections.binarySearch

public static <T> int binarySearch(List<? extends Comparable<? super T>> list, T key) {
    if (list instanceof RandomAccess || list.size()<BINARYSEARCH_THRESHOLD)
        return Collections.indexedBinarySearch(list, key);
    else
        return Collections.iteratorBinarySearch(list, key);
}
```

è¿™æ®µäºŒåˆ†æŸ¥æ‰¾çš„ä»£ç è¿˜æ˜¯è›®æœ‰æ„æ€çš„ï¼Œ`list instanceof RandomAccess` è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸º ArrayList æœ‰å®ç° RandomAccessï¼Œä½†æ˜¯ LinkedList å¹¶æ²¡æœ‰å®ç°è¿™ä¸ªæ¥å£ã€‚åŒæ—¶è¿˜æœ‰å…ƒç´ æ•°é‡é˜ˆå€¼çš„æ ¡éªŒ `BINARYSEARCH_THRESHOLD = 5000`ï¼Œå°äºè¿™ä¸ªèŒƒå›´çš„éƒ½é‡‡ç”¨ `indexedBinarySearch` è¿›è¡ŒæŸ¥æ‰¾ã€‚é‚£ä¹ˆè¿™é‡Œå…¶å®ä½¿ç”¨ LinkedList å­˜å‚¨æ•°æ®ï¼Œåœ¨å…ƒç´ å®šä½çš„æ—¶å€™ï¼Œéœ€è¦getå¾ªç¯è·å–å…ƒç´ ï¼Œå°±ä¼šæ¯” ArrayList æ›´è€—æ—¶ã€‚

**Collections.indexedBinarySearch(list, key)**ï¼š

```java
 private static <T> int indexedBinarySearch(List<? extends Comparable<? super T>> list, T key) {
     int low = 0;
     int high = list.size()-1;
     while (low <= high) {
         int mid = (low + high) >>> 1;
         Comparable<? super T> midVal = list.get(mid);
         int cmp = midVal.compareTo(key);
         if (cmp < 0)
             low = mid + 1;
         else if (cmp > 0)
             high = mid - 1;
         else
             return mid; // key found
     }
     return -(low + 1);  // key not found
 }
```

ä»¥ä¸Šè¿™æ®µä»£ç å°±æ˜¯é€šè¿‡æ¯æ¬¡æŠ˜åŠäºŒåˆ†å®šä½å…ƒç´ ï¼Œè€Œä¸Šé¢æ‰€è¯´çš„è€—æ—¶ç‚¹å°±æ˜¯`list.get(mid)`ï¼Œè¿™åœ¨æˆ‘ä»¬åˆ†ææ•°æ®ç»“æ„æ—¶å·²ç»è®²è¿‡ã€‚[ã€ŠLinkedListæ’å…¥é€Ÿåº¦æ¯”ArrayListå¿«ï¼Ÿä½ ç¡®å®šå—ï¼Ÿã€‹](https://bugstack.cn/interview/2020/08/30/%E9%9D%A2%E7%BB%8F%E6%89%8B%E5%86%8C-%E7%AC%AC8%E7%AF%87-LinkedList%E6%8F%92%E5%85%A5%E9%80%9F%E5%BA%A6%E6%AF%94ArrayList%E5%BF%AB-%E4%BD%A0%E7%A1%AE%E5%AE%9A%E5%90%97.html)

**Collections.iteratorBinarySearch(list, key)**ï¼š

```java
private static <T> int iteratorBinarySearch(List<? extends Comparable<? super T>> list, T key)
{
    int low = 0;
    int high = list.size()-1;
    ListIterator<? extends Comparable<? super T>> i = list.listIterator();
    while (low <= high) {
        int mid = (low + high) >>> 1;
        Comparable<? super T> midVal = get(i, mid);
        int cmp = midVal.compareTo(key);
        if (cmp < 0)
            low = mid + 1;
        else if (cmp > 0)
            high = mid - 1;
        else
            return mid; // key found
    }
    return -(low + 1);  // key not found
}
```

ä¸Šé¢è¿™æ®µä»£ç æ˜¯å…ƒç´ æ•°é‡å¤§äº5000ä¸ªï¼ŒåŒæ—¶æ˜¯ LinkedList æ—¶ä¼šä½¿ç”¨è¿­ä»£å™¨ `list.listIterator` çš„æ–¹å¼è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾æ“ä½œã€‚ä¹Ÿç®—æ˜¯ä¸€ä¸ªä¼˜åŒ–ï¼Œä½†æ˜¯å¯¹äºé“¾è¡¨çš„æ•°æ®ç»“æ„ï¼Œä»ç„¶æ²¡æœ‰æ•°ç»„æ•°æ®ç»“æ„ï¼ŒäºŒåˆ†å¤„ç†çš„é€Ÿåº¦å¿«ï¼Œä¸»è¦åœ¨è·å–å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸ŠO(1) å’Œ O(n)ã€‚

### 3. Collections.shuffle æ´—ç‰Œç®—æ³•

**æ´—ç‰Œç®—æ³•**ï¼Œå…¶å®å°±æ˜¯å°† List é›†åˆä¸­çš„å…ƒç´ è¿›è¡Œæ‰“ä¹±ï¼Œä¸€èˆ¬å¯ä»¥ç”¨åœ¨æŠ½å¥–ã€æ‘‡å·ã€æ´—ç‰Œç­‰å„ä¸ªåœºæ™¯ä¸­ã€‚

#### 3.1 åŠŸèƒ½ä½¿ç”¨

```java
Collections.shuffle(list);

Collections.shuffle(list, new Random(100));
```

å®ƒçš„ä½¿ç”¨æ–¹å¼éå¸¸ç®€å•ï¼Œä¸»è¦æœ‰è¿™ä¹ˆä¸¤ç§æ–¹å¼ï¼Œä¸€ç§ç›´æ¥ä¼ å…¥é›†åˆã€å¦å¤–ä¸€ç§è¿˜å¯ä»¥ä¼ å…¥å›ºå®šçš„éšæœºç§å­*è¿™ç§æ–¹å¼å¯ä»¥æ§åˆ¶æ´—ç‰ŒèŒƒå›´èŒƒå›´*

#### 3.2 æºç åˆ†æ

æŒ‰ç…§æ´—ç‰Œçš„é€»è¾‘ï¼Œæˆ‘ä»¬æ¥å®ç°ä¸‹å…·ä½“çš„æ ¸å¿ƒé€»è¾‘ä»£ç ï¼Œå¦‚ä¸‹ï¼›

```java
@Test
public void test_shuffle() {
    List<String> list = new ArrayList<String>();
    list.add("1");
    list.add("2");
    list.add("3");
    list.add("4");
    list.add("5");
    list.add("6");
    list.add("7");
    list.add("8");
    
    Random random = new Random();
    for (int i = list.size(); i > 1; i--) {
        int ri = random.nextInt(i);  // éšæœºä½ç½®
        int ji = i - 1;              // é¡ºå»¶
        System.out.println("riï¼š" + ri + " jiï¼š" + ji);
        list.set(ji, list.set(ri, list.get(ji)));        // å…ƒç´ ç½®æ¢
    }
    System.out.println(list);
}
```

**è¿è¡Œç»“æœï¼š**

```java
riï¼š6 jiï¼š7
riï¼š4 jiï¼š6
riï¼š1 jiï¼š5
riï¼š2 jiï¼š4
riï¼š0 jiï¼š3
riï¼š0 jiï¼š2
riï¼š1 jiï¼š1
[8, 6, 4, 1, 3, 2, 5, 7]
```

è¿™éƒ¨åˆ†ä»£ç é€»è¾‘ä¸»è¦æ˜¯é€šè¿‡éšæœºæ•°ä»é€æ­¥ç¼©å°èŒƒå›´çš„é›†åˆä¸­æ‰¾åˆ°å¯¹åº”çš„å…ƒç´ ï¼Œä¸é€’å‡çš„ä¸‹æ ‡ä½ç½®è¿›è¡Œå…ƒç´ æ›¿æ¢ï¼Œæ•´ä½“çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼›

![å°å‚…å“¥ & æ´—ç‰Œç®—æ³•è¿‡ç¨‹](https://bugstack.cn/assets/images/2020/interview/interview-11-04.png)

### 4. Collections.rotate æ—‹è½¬ç®—æ³•

**æ—‹è½¬ç®—æ³•**ï¼Œå¯ä»¥æŠŠArrayListæˆ–è€…Linkedlistï¼Œä»æŒ‡å®šçš„æŸä¸ªä½ç½®å¼€å§‹ï¼Œè¿›è¡Œæ­£æ—‹æˆ–è€…é€†æ—‹æ“ä½œã€‚æœ‰ç‚¹åƒæŠŠé›†åˆç†è§£æˆåœ†ç›˜ï¼ŒæŠŠè¦çš„å…ƒç´ è½¬åˆ°è‡ªå·±è¿™ï¼Œå…¶ä»–çš„å…ƒç´ é¡ºåºè·Ÿéšã€‚

#### 4.1 åŠŸèƒ½åº”ç”¨

```java
List<String> list = new ArrayList<String>();
list.add("7");
list.add("4");
list.add("8");
list.add("3");
list.add("9");
Collections.rotate(list, 2);
System.out.println(list);
```

è¿™é‡Œæˆ‘ä»¬å°†é›†åˆé¡ºåºï¼›`7ã€4ã€8ã€3ã€9`ï¼Œé¡ºæ—¶é’ˆæ—‹è½¬2ä½ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹ï¼›*é€†æ—¶é’ˆæ—‹è½¬ä¸ºè´Ÿæ•°*

**æµ‹è¯•ç»“æœ**

```java
[3, 9, 7, 4, 8]
```

é€šè¿‡æµ‹è¯•ç»“æœæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä»å…ƒç´ `7`å¼€å§‹ï¼Œæ­£å‘æ—‹è½¬äº†ä¸¤ä½ï¼Œæ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾ï¼›

![](https://bugstack.cn/assets/images/2020/interview/interview-11-05.png)

#### 4.2 æºç åˆ†æ

```java
public static void rotate(List<?> list, int distance) {
    if (list instanceof RandomAccess || list.size() < ROTATE_THRESHOLD)
        rotate1(list, distance);
    else
        rotate2(list, distance);
}
```

å…³äºæ—‹è½¬ç®—æ³•çš„å®ç°ç±»åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼›
1. Arraylist æˆ–è€…å…ƒç´ æ•°é‡ä¸å¤šæ—¶ï¼Œ`ROTATE_THRESHOLD = 100`ï¼Œåˆ™é€šè¿‡ç®—æ³•`rotate1`å®ç°ã€‚
2. å¦‚æœæ˜¯ LinkedList å…ƒç´ æ•°é‡åˆè¶…è¿‡äº† ROTATE_THRESHOLDï¼Œåˆ™éœ€è¦ä½¿ç”¨ç®—æ³•`rotate2`å®ç°ã€‚

**é‚£ä¹ˆ**ï¼Œè¿™ä¸¤ä¸ªç®—æ³•æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ

##### 4.2.1 æ—‹è½¬ç®—æ³•ï¼Œrotate1

```java
private static <T> void rotate1(List<T> list, int distance) {
    int size = list.size();
    if (size == 0)
        return;
    distance = distance % size;
    if (distance < 0)
        distance += size;
    if (distance == 0)
        return;
    for (int cycleStart = 0, nMoved = 0; nMoved != size; cycleStart++) {
        T displaced = list.get(cycleStart);
        int i = cycleStart;
        do {
            i += distance;
            if (i >= size)
                i -= size;
            displaced = list.set(i, displaced);
            nMoved ++;
        } while (i != cycleStart);
    }
}
```

è¿™éƒ¨åˆ†ä»£ç çœ‹ç€ç¨å¾®å¤šä¸€ç‚¹ï¼Œä½†æ˜¯æ•°ç»„ç»“æ„çš„æ“ä½œèµ·æ¥å¹¶ä¸å¤æ‚ï¼ŒåŸºæœ¬å¦‚ä¸Šé¢åœ†åœˆå›¾æ“ä½œï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼›
1. `distance = distance % size;`ï¼Œè·å–æ—‹è½¬çš„ä½ç½®ã€‚
2. forå¾ªç¯å’Œdowhileï¼Œé…åˆæ¯æ¬¡çš„æ—‹è½¬æ“ä½œï¼Œæ¯”å¦‚è¿™é‡Œç¬¬ä¸€æ¬¡ä¼šæŠŠ0ä½ç½®å…ƒç´ æ›¿æ¢åˆ°2ä½ç½®ï¼Œæ¥ç€åœ¨dowhileä¸­ä¼šåˆ¤æ–­`i != cycleStart`ï¼Œæ»¡è¶³æ¡ä»¶ç»§ç»­æŠŠæ›¿æ¢äº†2ä½ç½®çš„å…ƒç´ ç»§ç»­å¾€ä¸‹æ›¿æ¢ã€‚ç›´åˆ°ä¸€è½®å¾ªç¯æŠŠæ‰€æœ‰å…ƒç´ éƒ½æ”¾ç½®åˆ°æ­£ç¡®ä½ç½®ã€‚
3. æœ€ç»ˆlistå…ƒç´ è¢«å¾ªç¯æ›¿æ¢å®Œæˆï¼Œä¹Ÿå°±ç›¸å½“ä»æŸä¸ªä½ç½®å¼€å§‹ï¼Œæ­£åºæ—‹è½¬2ä¸ªä½ç½®çš„æ“ä½œã€‚

##### 4.2.2 æ—‹è½¬ç®—æ³•ï¼Œrotate2

```java
private static void rotate2(List<?> list, int distance) {
    int size = list.size();
    if (size == 0)
        return;
    int mid =  -distance % size;
    if (mid < 0)
        mid += size;
    if (mid == 0)
        return;
    reverse(list.subList(0, mid));
    reverse(list.subList(mid, size));
    reverse(list);
}
```

æ¥ä¸‹æ¥è¿™éƒ¨åˆ†æºç ä¸»è¦æ˜¯é’ˆå¯¹å¤§äº`100`ä¸ªå…ƒç´ çš„LinkedListè¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥æ•´ä¸ªç®—æ³•ä¹Ÿæ›´åŠ æœ‰æ„æ€ï¼Œå®ƒçš„ä¸»è¦æ“ä½œåŒ…æ‹¬ï¼›
1. å®šä½æ‹†é“¾ä½ç½®ï¼Œ-distance % size + sizeï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦æ—‹è½¬åæ‰¾åˆ°çš„å…ƒç´ ä½ç½®
2. ç¬¬ä¸€æ¬¡ç¿»è½¬ï¼ŒæŠŠä»ä½ç½®0åˆ°æ‹†é“¾ä½ç½®
3. ç¬¬äºŒæ¬¡ç¿»è½¬ï¼ŒæŠŠæ‹†é“¾ä½ç½®åˆ°ç»“å°¾
4. ç¬¬ä¸‰æ¬¡ç¿»è½¬ï¼Œç¿»è½¬æ•´ä¸ªé“¾è¡¨

æ•´ä½“æ‰§è¡Œè¿‡ç¨‹ï¼Œå¯ä»¥å‚è€ƒä¸‹å›¾ï¼Œæ›´æ–¹ä¾¿ç†è§£ï¼›

![å°å‚…å“¥ & æ—‹è½¬ç®—æ³•](https://bugstack.cn/assets/images/2020/interview/interview-11-06.png)

### 5. å…¶ä»–APIä»‹ç»

è¿™éƒ¨åˆ†APIå†…å®¹ï¼Œä½¿ç”¨å’Œè®¾è®¡ä¸Šç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œå¹³æ—¶å¯èƒ½ç”¨çš„æ—¶å€™ä¸å¤šï¼Œä½†æœ‰çš„å°ä¼™ä¼´è¿˜æ²¡ç”¨è¿‡ï¼Œå°±å½“ä¸ºä½ æ‰«ç›²äº†ã€‚

#### 5.1 æœ€å¤§æœ€å°å€¼

```java
String min = Collections.min(Arrays.asList("1", "2", "3"));
String max = Collections.max(Arrays.asList("1", "2", "3"));
```

- `Collections` å·¥å…·åŒ…å¯ä»¥è¿›è¡Œæœ€å€¼çš„è·å–ã€‚

#### 5.2 å…ƒç´ æ›¿æ¢

```java
 List<String> list = new ArrayList<String>();
 list.add("7");
 list.add("4");
 list.add("8");
 list.add("8");
 Collections.replaceAll(list, "8", "9");
 
 // æµ‹è¯•ç»“æœï¼š [7, 4, 9, 9]
```

- å¯ä»¥æŠŠé›†åˆä¸­æŸä¸ªå…ƒç´ å…¨éƒ¨æ›¿æ¢æˆæ–°çš„å…ƒç´ ã€‚

#### 5.3 è¿ç»­é›†åˆä½ç½®åˆ¤æ–­

```java
@Test
public void test_indexOfSubList() {
    List<String> list = new ArrayList<String>();
    list.add("7");
    list.add("4");
    list.add("8");
    list.add("3");
    list.add("9");
    int idx = Collections.indexOfSubList(list, Arrays.asList("8", "3"));
    System.out.println(idx);
    
    // æµ‹è¯•ç»“æœï¼š2
}
```

åœ¨ä½¿ç”¨Stringæ“ä½œä¸­ï¼Œæˆ‘ä»¬çŸ¥é“`"74839".indexOf("8");`ï¼Œå¯ä»¥è·å–æŸä¸ªå…ƒç´ åœ¨ä»€ä¹ˆä½ç½®ã€‚è€Œåœ¨`ArrayList`é›†åˆæ“ä½œä¸­ï¼Œå¯ä»¥è·å–è¿ç»­çš„å…ƒç´ ï¼Œåœ¨é›†åˆä¸­çš„ä½ç½®ã€‚


#### 5.4 synchronized

```java
List<String> list = Collections.synchronizedList(new ArrayList<String>());
Map<String, String> map = Collections.synchronizedMap(new HashMap<String, String>());
```

- è¿™ä¸ªå¾ˆç†Ÿæ‚‰å§ï¼Œç”šè‡³ç»å¸¸ä½¿ç”¨ï¼Œä½†å¯èƒ½ä¼šå¿½ç•¥è¿™äº›çº¿ç¨‹å®‰å…¨çš„æ–¹æ³•æ¥è‡ªäº `Collections` é›†åˆå·¥å…·åŒ…ã€‚

## å››ã€æ€»ç»“

- æœ¬ç« èŠ‚åŸºæœ¬å°†`java.util.Collections`å·¥å…·åŒ…ä¸­çš„å¸¸ç”¨æ–¹æ³•ä»‹ç»å®Œäº†ï¼Œä»¥åŠä¸€äº›ç®—æ³•çš„è®²è§£ã€‚è¿™æ ·åœ¨åç»­éœ€è¦ä½¿ç”¨åˆ°è¿™äº›ç®—æ³•é€»è¾‘æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨å¹¶ä¸éœ€è¦é‡å¤é€ è½®å­ã€‚
- å­¦ä¹ æ•°æ®ç»“æ„ã€ç®—æ³•ã€è®¾è®¡æ¨¡å¼ï¼Œè¿™ä¸‰æ–¹é¢çš„çŸ¥è¯†ï¼Œé‡ç‚¹è¿˜æ˜¯èƒ½è½åœ°åˆ°æ—¥å¸¸çš„ä¸šåŠ¡å¼€å‘ä¸­ï¼Œå¦åˆ™ç©ºã€å‡ã€è™šï¼Œåªèƒ½é€‚åˆå¹å¹ç‰›ï¼Œå¹¶ä¸ä¼šç»™é¡¹ç›®ç ”å‘å¸¦æ¥å®é™…çš„ä»·å€¼ã€‚
- æ‡‚äº†å°±æ˜¯çœŸçš„æ‡‚ï¼Œåˆ«è®©è‡ªå·±å¤ªéš¾å—ã€‚æ­»è®°ç¡¬èƒŒè°ä¹Ÿå—ä¸äº†ï¼Œè€—è´¹äº†å¤§é‡çš„æ—¶é—´ï¼ŒçŸ¥è¯†ä¹Ÿæ²¡æœ‰å¸æ”¶ï¼Œå­¦ä¹ ä¸€ä¸ªçŸ¥è¯†ç‚¹æœ€å¥½å°±ä»æ ¹æœ¬å­¦ä¹ ï¼Œä¸è¦å¿ƒæµ®æ°”èºã€‚

## äº”ã€ç³»åˆ—æ¨è

- [DDDé¢†åŸŸé©±åŠ¨è®¾è®¡è½åœ°æ–¹æ¡ˆ](https://bugstack.cn/itstack-demo-ddd/itstack-demo-ddd.html)
- [é‡å­¦Javaè®¾è®¡æ¨¡å¼(22ä¸ªçœŸå®å¼€å‘åœºæ™¯)](https://bugstack.cn/itstack/itstack-demo-design.html)
- [é¢ç»æ‰‹å†Œ(ä¸Šæœ€å¿«çš„è½¦ï¼Œæ‹¿æœ€è´µçš„offer)](https://bugstack.cn/itstack/interview.html) x
- [å­—èŠ‚ç ç¼–ç¨‹(éå…¥ä¾µå¼å…¨é“¾è·¯ç›‘æ§å®è·µ)](https://bugstack.cn/itstack/itstack-demo-bytecode.html)