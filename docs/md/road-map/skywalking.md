---
title: skywalking å…¨é“¾è·¯ç›‘æ§
lock: no
---

# skywalking å…¨é“¾è·¯ç›‘æ§

ä½œè€…ï¼šå°å‚…å“¥
<br/>åšå®¢ï¼š[https://bugstack.cn](https://bugstack.cn)

> æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼ğŸ˜„

è¿™ä½åŒå­¦ï¼Œä½ æ¯”ä¸Šä¸€ä½é¢è¯•è€…å¥½å¤šäº†ï¼Œä½ çš„ç®€å†ä¸­åšçš„å‡ ä¸ªé¡¹ç›®éƒ½ä¸é”™ã€‚æ—¢æœ‰ä¸šåŠ¡é¡¹ç›®ï¼Œä¹Ÿæœ‰æŠ€æœ¯é¡¹ç›®ï¼Œçœ‹å¾—å‡ºä½ å¯¹ç¼–ç¨‹å¼€å‘æ˜¯æœ‰ä¸€å®šçš„ç»éªŒç§¯ç´¯çš„ã€‚é‚£ä¹ˆæˆ‘è¿˜æƒ³äº†è§£ä¸‹ï¼Œè¿™äº›é¡¹ç›®åœ¨è¿è¡Œä¸­çš„ä¸€ä¸ªæ•°æ®æ•ˆæœæ˜¯æ€ä¹ˆæ ·çš„ã€‚æ¯”å¦‚ï¼›tpsã€qpsã€å“åº”æ—¶é—´ã€æ•°æ®åº“è´Ÿè½½ç­‰ï¼Œéƒ½æ˜¯ä»€ä¹ˆæƒ…å†µï¼Œä½ ç”¨çš„ä»€ä¹ˆç›‘æ§å·¥å…·ã€‚å¦å¤–ä½ è¿™é‡Œè¿˜äº›äº†å¾®æœåŠ¡çš„æ¶æ„ï¼Œé‚£ä¹ˆå¾®æœåŠ¡é—´çš„é“¾è·¯è°ƒç”¨æ˜¯æ€ä¹ˆç›‘æ§çš„ã€‚

å’‹æ ·ï¼Œæ˜¯ä¸ä¸€ä¸‹å°±æ…Œäº†ã€‚å¼ å£å°±å–Šï¼šâ€œjava å´©ç›˜ï¼â€ ä»¥å‰é èƒŒé¢˜å¹ç‰›é€¼å°±èƒ½å…¥èŒï¼Œç°åœ¨å¾—æŠŠå¹çš„ç‰›é€¼è½åœ°äº†ã€‚è€Œè¶Šæ¥è¶Šå¤šçš„é¢è¯•å®˜ä¹Ÿæ›´å–œæ¬¢ç”¨ç»“æœæ¨è¿‡ç¨‹ï¼Œä»è¿‡ç¨‹ä¸­å†è€ƒå¯Ÿç»†èŠ‚ã€‚ä¸€ä¸Šæ¥å°±é—®å…«è‚¡æ–‡çš„è¶Šæ¥è¶Šå°‘äº†ã€‚

**æ‰€ä»¥**ï¼Œåšå®Œé¡¹ç›®ï¼Œæœ€å¥½åœ¨é…ä¸Šå¯¹åº”çš„æ•°æ®ï¼Œè¿™æ ·æ‰æ›´æœ‰è¯´æœåŠ›ã€‚â€”â€” æ‰€ä»¥æœ¬æ–‡å°å‚…å“¥ä¼šæ•™ä¼šä½ ï¼Œå¦‚ä½•é…ç½®ä¸€å¥—å…¨é“¾è·¯ç›‘æ§ç³»ç»Ÿï¼Œå¹¶å®Œæˆæµ‹è¯•è·å–ç³»ç»Ÿè¿è¡Œçš„æ•°æ®ã€‚æ­¤å¤–è¿™æ˜¯æ•´å¥—[ã€Š@å°å‚…å“¥ Java ç®€æ˜æ•™ç¨‹ã€‹](https://bugstack.cn/md/road-map/road-map.html)å…¶ä¸­çš„ä¸€èŠ‚ï¼Œæ›´å¤šå†…å®¹å¯ä»¥è¿›å…¥è¿™é‡Œå­¦ä¹ ï¼›[https://bugstack.cn/md/road-map/road-map.html](https://bugstack.cn/md/road-map/road-map.html)

## ä¸€ã€ç« èŠ‚ç›®çš„

![](https://bugstack.cn/images/roadmap/tutorial/road-map-230617-01.png)

æœ¬ç« èŠ‚é€šè¿‡ Docker æ–¹å¼éƒ¨ç½²ä¸€å¥— skywalking éå…¥ä¾µçš„å…¨é“¾è·¯ç›‘æ§ç³»ç»Ÿï¼Œå¹¶åœ¨å¯¹åº”çš„æµ‹è¯•å·¥ç¨‹ä¸­é€šè¿‡ skywalking-agent å­—èŠ‚ç å¢å¼ºç»„ä»¶ï¼Œé‡‡é›†ç³»ç»Ÿè¿è¡Œæ—¶çš„å„é¡¹ä¿¡æ¯åˆ° skywalking-ui ç›‘æ§å¹³å°è§‚å¯Ÿæ•°æ®ã€‚

- **å®˜ç½‘**ï¼š[https://skywalking.apache.org/](https://skywalking.apache.org/) - å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºæ­¤ç±»ç³»ç»Ÿçš„è®¾è®¡å’Œå®ç°ï¼Œå¯ä»¥é˜…è¯»å°å‚…å“¥çš„[ã€Šå­—èŠ‚ç ç¼–ç¨‹ã€‹](https://bugstack.cn/md/bytecode/asm/2020-03-25-%5BASM%E5%AD%97%E8%8A%82%E7%A0%81%E7%BC%96%E7%A8%8B%5D%E5%A6%82%E6%9E%9C%E4%BD%A0%E5%8F%AA%E5%86%99CRUD%EF%BC%8C%E9%82%A3%E8%BF%99%E7%A7%8D%E6%8A%80%E6%9C%AF%E4%BD%A0%E6%B0%B8%E8%BF%9C%E7%A2%B0%E4%B8%8D%E5%88%B0.html)
- **æºç **ï¼š[https://gitcode.net/KnowledgePlanet/road-map/skywalking](https://gitcode.net/KnowledgePlanet/road-map/skywalking) - è¿™æ˜¯å°å‚…å“¥æ•´ç†å¥½çš„ä¸€å¥—å¯è¿è¡Œçš„ç›‘æ§å’Œç³»ç»Ÿï¼Œè¯»è€…å¯ä»¥ä¸‹è½½åå¯¹ç…§æœ¬æ–‡è¿›è¡ŒéªŒè¯ä½¿ç”¨ã€‚

## äºŒã€åŸºæœ¬ç¯å¢ƒ

- Docker version 1.13.1
- Docker compose - ç”¨äºåœ¨äº‘æœåŠ¡å™¨ç¯å¢ƒä¸­æ‰§è¡Œçš„ docker-compose æ–‡ä»¶
- Portainer Docker å®¹å™¨ç®¡ç†é¢æ¿

ä»¥ä¸Šå†…å®¹å®‰è£…ï¼Œå‚è€ƒ[ã€Javaç®€æ˜æ•™ç¨‹/å‘å¸ƒéƒ¨ç½²ã€‘](https://bugstack.cn/md/road-map/road-map.html)ï¼š[https://bugstack.cn/md/road-map/road-map.html](https://bugstack.cn/md/road-map/road-map.html) - å‘å¸ƒéƒ¨ç½²

## ä¸‰ã€ç›‘æ§é…ç½®

skywalking çš„å®‰è£…ï¼Œéœ€è¦ elasticsearch - å­˜æ”¾æ•°æ®ã€skywalking-oap æ¥æ”¶æ•°æ®ã€skywalking-ui ç•Œé¢å±•ç¤ºã€‚ä»¥åŠè¿˜éœ€è¦ä¸€ä¸ª skywalking-agent ç”¨äºé…ç½®åˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œé‡‡é›†ç›‘æ§æ•°æ®ã€‚æ³¨æ„è¿™äº›å†…å®¹åœ¨å®˜ç½‘ä¸­ï¼Œéƒ½å·²æä¾›ï¼Œåœ°å€ï¼š[https://skywalking.apache.org/downloads/](https://skywalking.apache.org/downloads/) 

å› ä¸ºå°å‚…å“¥è¿™é‡Œæä¾›äº†Dockerçš„è‡ªåŠ¨éƒ¨ç½²ä»¥åŠä¸‹è½½å¥½äº† skywalking-agent æ‰€ä»¥ä½ å°±ä¸éœ€è¦ä¸€ä¸ªä¸ªå»ä¸‹è½½å®‰è£…äº†ã€‚æ¥ä¸‹æ¥å°å‚…å“¥ä¼šåˆ†åˆ«ä»‹ç»åœ¨`æœ¬åœ°ç¯å¢ƒ`å’Œ`äº‘æœåŠ¡å™¨`ä¸¤å¥—ç¯å¢ƒå®‰è£…ï¼Œè¿™æ ·å¯ä»¥æ›´åŠ æ–¹ä¾¿å°ä¼™ä¼´åšæµ‹è¯•éªŒè¯ã€‚

åœ¨è¿›è¡Œä¸‹é¢çš„æ­¥éª¤å‰ï¼Œè¯·å…ˆä¸‹è½½ skywalking ç›‘æ§å·¥ç¨‹ï¼›[https://gitcode.net/KnowledgePlanet/road-map/skywalking](https://gitcode.net/KnowledgePlanet/road-map/skywalking)

<div align="center">
	<img src="https://bugstack.cn/images/roadmap/tutorial/road-map-230617-02.png?raw=true" width="650px"/>
</div>

### 1. æœ¬åœ°ç¯å¢ƒ

**è„šæœ¬**ï¼š`/road-map/skywalking/docs/dev-ops/skywalking` - ä½ å¯ä»¥æ‰“å¼€å·¥ç¨‹æ‰¾åˆ°è¿™ä¸ªä½ç½®ï¼ŒæŸ¥çœ‹æœ€æ–°è„šæœ¬ã€‚

```java
version: '3.8'
services:
  elasticsearch:
    image: elasticsearch:7.16.2
    container_name: elasticsearch
    ports:
      - "9200:9200"
    healthcheck:
      test: [ "CMD-SHELL", "curl --silent --fail localhost:9200/_cluster/health || exit 1" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    environment:
      - discovery.type=single-node
      - bootstrap.memory_lock=true
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    ulimits:
      memlock:
        soft: -1
        hard: -1
    volumes:
      - ./data/es_data:/usr/share/elasticsearch/data

  oap:
    image: apache/skywalking-oap-server:8.9.0
    container_name: oap
    depends_on:
      elasticsearch:
        condition: service_healthy
    links:
      - elasticsearch
    ports:
      - "11800:11800"
      - "12800:12800"
    healthcheck:
      test: [ "CMD-SHELL", "/skywalking/bin/swctl ch" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    environment:
      SW_STORAGE: elasticsearch
      SW_STORAGE_ES_CLUSTER_NODES: elasticsearch:9200
      SW_HEALTH_CHECKER: default
      SW_TELEMETRY: prometheus
      JAVA_OPTS: "-Xms1024m -Xmx1024m"

  skywalking-ui:
    image: apache/skywalking-ui:8.9.0
    container_name: skywalking-ui
    depends_on:
      oap:
        condition: service_healthy
    links:
      - oap
    ports:
      - "9090:8080"
    environment:
      SW_OAP_ADDRESS: http://oap:12800
```

<div align="center">
	<img src="https://bugstack.cn/images/roadmap/tutorial/road-map-230617-03.png?raw=true" width="650px"/>
</div>

- åœ¨ Docker å®‰è£…å¹¶æ­£ç¡®âœ…å¯åŠ¨åï¼Œä½ å°±å¯ä»¥ç‚¹å‡»è¿™ä¸ªæŒ‰é’®äº†ã€‚å®ƒä¼šå¸®ä½ è‡ªåŠ¨è¿è¡Œå®‰è£…å‡ºæ•´å¥—çš„ skywalking ç›‘æ§ç³»ç»Ÿã€‚éå¸¸æ–¹ä¾¿ã€‚
- å¦‚æœä½ ç‚¹å‡»çº¢åœˆä¸‹é¢çš„å•ä¸ªæŒ‰é’®ï¼Œé‚£ä¹ˆä»£è¡¨çš„æ˜¯åªå®‰è£…å½“å‰ä¸€ä¸ªåº”ç”¨ã€‚
- ä½ å¯ä»¥é€šè¿‡å‘½ä»¤æ‰§è¡Œ `skywalking-docker-compose.yml` çš„å®‰è£…ï¼š`/usr/local/bin/docker-compose -f /docs/dev-ops/skywalking/skywalking-docker-compose.yml up -d` - åœ¨äº‘æœåŠ¡å™¨ç«¯ä¹Ÿæ˜¯ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å®‰è£…ã€‚

è®¿é—®éªŒè¯ï¼š[http://localhost:9090/](http://localhost:9090/) - æˆ‘è®¾ç½®çš„ç«¯å£æ˜¯9090ï¼Œå¦‚æœä½ æ˜¯å…¶ä»–çš„åˆ™éœ€è¦ä¿®æ”¹ã€‚

### 2. äº‘æœåŠ¡å™¨

- å‡†å¤‡ä¸€å°2æ ¸4Gçš„äº‘æœåŠ¡å™¨ï¼Œæ•´ä¸ªæœåŠ¡å¯åŠ¨åä¼šå ç”¨2-3Gå·¦å³
- ä¸‹è½½ ssh å·¥å…·ï¼Œç”¨äºè¿æ¥äº‘æœåŠ¡ã€‚è¿™é‡Œå°å‚…å“¥æ¨èä½¿ç”¨ Termius éå¸¸å¥½ç”¨ï¼
- docker-compose å®‰è£…ï¼Œå‚è€ƒï¼š[https://bugstack.cn/md/road-map/road-map.html](https://bugstack.cn/md/road-map/road-map.html) - å‘å¸ƒéƒ¨ç½²ï¼ŒDocker#7

#### 2.1 æ–‡ä»¶ä¸Šä¼ 

é€šè¿‡ ssh çš„ sftp å·¥å…·ï¼ŒæŠŠ skywalking/docs å…¨éƒ¨ä¸Šä¼ åˆ°äº‘æœåŠ¡å™¨ã€‚

<div align="center">
	<img src="https://bugstack.cn/images/roadmap/tutorial/road-map-230617-04.png?raw=true" width="750px"/>
</div>

#### 2.2 æ‰§è¡Œè„šæœ¬

<div align="center">
	<img src="https://bugstack.cn/images/roadmap/tutorial/road-map-230617-05.png?raw=true" width="750px"/>
</div>

```shell script
[root@dev-ops ~]# cd /docs/
[root@dev-ops docs]# ls
dev-ops  skywalking-agent  sql
[root@dev-ops docs]# cd dev-ops/
[root@dev-ops dev-ops]# ls
environment  skywalking
[root@dev-ops dev-ops]# cd skywalking/
[root@dev-ops skywalking]# ls
skywalking-docker-compose.yml
[root@dev-ops skywalking]# /usr/local/bin/docker-compose -f /docs/dev-ops/skywalking/skywalking-docker-compose.yml up -d
[+] Building 0.0s (0/0)                                                                          
[+] Running 3/3
 âœ” Container elasticsearch  Healthy                                                         0.5s 
 âœ” Container oap            Healthy                                                         1.0s 
 âœ” Container skywalking-ui  Running                                                         0.0s
```

å®‰è£…å®Œæˆè®°å¾—å¼€æ”¾ç«¯å£ï¼›
- 9090 ç«¯å£ï¼›skywalking-ui ç•Œé¢ç«¯å£
- 11800 ç«¯å£ï¼›ç›‘æ§æ•°æ®ä¸ŠæŠ¥ç«¯å£

å®‰è£…å®Œæˆåå°±å¯ä»¥è®¿é—®ç›‘æ§ç•Œé¢äº†ï¼›[http://180.76.138.**:9090/](http://180.76.138.**:9090/)  - æ›¿æ¢ä¸ºä½ çš„IPåœ°å€

## å››ã€æ•°æ®ä¸ŠæŠ¥

ç›‘æ§æ•°æ®çš„ä¸ŠæŠ¥ä½¿ç”¨çš„æ˜¯ Javaagent æŠ€æœ¯ï¼Œåœ¨ç¨‹åºåŠ è½½æ—¶å€™é€šè¿‡å­—èŠ‚ç å¢å¼ºæŠ€æœ¯ï¼Œåœ¨éœ€è¦ç›‘æ§çš„ä½ç½®è‡ªåŠ¨åŠ ä¸Šé¢å¤–çš„ç›‘æ§ä»£ç ï¼Œæ¥é‡‡é›†ç³»ç»Ÿçš„è¿è¡Œæ•°æ®ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå¯ä»¥æŠŠ Javaagent é…ç½®åˆ°ç¨‹åºå¯åŠ¨ä¸Šï¼Œä¹Ÿå¯ä»¥é…ç½®åˆ° Docker é•œåƒæ‰“åŒ…ä¸Šã€‚

### 1. ç¨‹åºå¯åŠ¨ - åŠ å…¥æ¢é’ˆ

é…ç½®åˆ° IDEA ç¨‹åºå¯åŠ¨ä¸­ï¼ŒVM Options å‚æ•°ï¼š`-javaagent:/Users/fuzhengwei/1024/KnowledgePlanet/road-map/skywalking/docs/skywalking-agent/skywalking-agent.jar
-Dskywalking.agent.service_name=skywalking-app-dev
-Dskywalking.collector.backend_service=127.0.0.1:11800`

<div align="center">
	<img src="https://bugstack.cn/images/roadmap/tutorial/road-map-230617-06.png?raw=true" width="750px"/>
</div>

- æ³¨æ„ä¿®æ”¹ï¼›`åœ°å€`ã€`åº”ç”¨å`ã€`IP`ã€å¦‚æœæ˜¯äº‘æœåŠ¡ï¼Œå°±é…ç½®äº‘æœåŠ¡çš„IPåœ°å€ã€‘

### 2. é•œåƒæ‰“åŒ… - åŠ å…¥æ¢é’ˆ

å½“ç¨‹åºéœ€è¦è¿è¡Œåœ¨äº‘æœåŠ¡çš„ Docker å®¹å™¨äº†ï¼Œå°±ä¸èƒ½è¿™æ ·é…ç½®äº†ï¼Œéœ€è¦æŠŠé…ç½®æ‰“åŒ…åˆ°é•œåƒé‡Œï¼Œæ›´åŠ æ–¹ä¾¿æ‰§è¡Œã€‚

```java
# åŸºç¡€é•œåƒ
FROM openjdk:8-jre-slim
# ä½œè€…
MAINTAINER xiaofuge
# é…ç½®
ENV PARAMS=""
# æ—¶åŒº
ENV TZ=PRC
RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone
# æ·»åŠ åº”ç”¨
ADD /target/skywalking-app.jar /skywalking-app.jar
## åœ¨é•œåƒè¿è¡Œä¸ºå®¹å™¨åæ‰§è¡Œçš„å‘½ä»¤
ENTRYPOINT ["java", "-Xmx512m", "-javaagent:/docs/skywalking-agent/skywalking-agent.jar", "-Dskywalking.agent.service_name=skywalking-app", "-Dskywalking.collector.backend_service=180.76.138.41:11800", "-jar", "/skywalking-app.jar"]
```

- æ³¨æ„ï¼›`/docs/skywalking-agent/skywalking-agent.jar` è¿™ä¸ªæ˜¯é€šè¿‡ SFTP å·¥å…·ä¸Šä¼ åˆ°äº‘æœåŠ¡å™¨ç«¯çš„ã€‚ä½†ä¸åœ¨ Docker å®¹å™¨é‡Œï¼Œç­‰éƒ¨ç½²ç¨‹åºçš„æ—¶å€™è¿˜éœ€è¦åšä¸€æ¬¡æ–‡ä»¶æ˜ å°„ã€‚

## äº”ã€å¯åŠ¨æœåŠ¡

å¦‚æœä½ å¸Œæœ›åœ¨æŠŠåº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°äº‘æœåŠ¡ç«¯ï¼Œä¸€ç§æ˜¯é€šè¿‡ IDEA è¿æ¥ Docker æœåŠ¡ï¼Œå¦å¤–ä¸€ç§æ˜¯æŠŠåº”ç”¨ç¨‹åºçš„é•œåƒå‘å¸ƒåˆ°Docker Hubã€‚è¿™é‡Œæˆ‘ä»¬é€šè¿‡ IDEA è¿æ¥ Docker æœåŠ¡ã€‚å‚è€ƒï¼š[https://bugstack.cn/md/road-map/road-map.html](https://bugstack.cn/md/road-map/road-map.html) - å¼€é€š 2375 ç«¯å£ï¼Œç”¨å®Œè®°å¾—å…³é—­ã€‚

**è„šæœ¬**ï¼š`skywalking/src/bin/main/start.sh`

```java
CONTAINER_NAME=skywalking-app
IMAGE_NAME=fuzhengwei/skywalking-app:1.0
PORT=9091

echo "å®¹å™¨éƒ¨ç½²å¼€å§‹ ${CONTAINER_NAME}"

# åœæ­¢å®¹å™¨
docker stop ${CONTAINER_NAME}

# åˆ é™¤å®¹å™¨
docker rm ${CONTAINER_NAME}

# å¯åŠ¨å®¹å™¨ skywalking-agent ä¸‹è½½ï¼šhttps://archive.apache.org/dist/skywalking/java-agent/8.9.0/apache-skywalking-java-agent-8.9.0.tgz
docker run --name ${CONTAINER_NAME} \
-p ${PORT}:${PORT} \
-v /docs/skywalking-agent/:/docs/skywalking-agent/ \
-d ${IMAGE_NAME}

#docker run --name skywalking-app \
#-p 9091:9091 \
#-v /docs/skywalking-agent/:/docs/skywalking-agent/ \
#-d fuzhengwei/skywalking-app:1.2

echo "å®¹å™¨éƒ¨ç½²æˆåŠŸ ${CONTAINER_NAME}"

docker logs -f ${CONTAINER_NAME}
```

- ä½ å¯ä»¥åœ¨äº‘æœåŠ¡æ‰§è¡Œ start.sh è„šæœ¬ï¼Œæˆ–è€…ç›´æ¥å¤åˆ¶ docker run å‘½ä»¤ï¼Œå»æ‰§è¡Œå¯åŠ¨ã€‚
- æ³¨æ„ï¼›`-v /docs/skywalking-agent/:/docs/skywalking-agent/ \` æ˜¯ä½ çš„æ˜ å°„åœ°å€ï¼Œåªæœ‰è¿™æ ·æ‰èƒ½æ‹¿åˆ° skywalking-agent
- å¦å¤–è®°å¾—æŒ‰ç…§ MySQLã€environment-docker-compose.ymlã€‘ åˆ°äº‘æœåŠ¡ä»¥åŠæ‰§è¡Œ road-map.sql æ–‡ä»¶ã€‚
